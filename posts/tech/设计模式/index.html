<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>è®¾è®¡æ¨¡å¼ | ç–¯å­çˆ±æ·¡å®š</title>
<meta name="keywords" content="è®¾è®¡æ¨¡å¼, æ€»ç»“">
<meta name="description" content="è®¾è®¡æ¨¡å¼å­¦ä¹ è®°å½•">
<meta name="author" content="becool">
<link rel="canonical" href="http://heketong.github.io/posts/tech/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="http://heketong.github.io/img/heketong_profile_photo.JPG">
<link rel="icon" type="image/png" sizes="16x16" href="http://heketong.github.io/img/heketong_profile_photo.JPG">
<link rel="icon" type="image/png" sizes="32x32" href="http://heketong.github.io/img/heketong_profile_photo.JPG">
<link rel="apple-touch-icon" href="http://heketong.github.io/img/heketong_profile_photo.JPG">
<link rel="mask-icon" href="http://heketong.github.io/img/heketong_profile_photo.JPG">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://heketong.github.io/posts/tech/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script defer src="https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js"></script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = ""; 
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

  

<meta property="og:title" content="è®¾è®¡æ¨¡å¼" />
<meta property="og:description" content="è®¾è®¡æ¨¡å¼å­¦ä¹ è®°å½•" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://heketong.github.io/posts/tech/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-18T22:45:46+08:00" />
<meta property="article:modified_time" content="2020-05-18T22:45:46+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="è®¾è®¡æ¨¡å¼"/>
<meta name="twitter:description" content="è®¾è®¡æ¨¡å¼å­¦ä¹ è®°å½•"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [

        {
          "@type": "ListItem",
          "position":  1 ,
          "name": "ğŸ“šæ–‡ç« ",
          "item": "http://heketong.github.io/posts/"
        },

        {
          "@type": "ListItem",
          "position":  2 ,
          "name": "ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯",
          "item": "http://heketong.github.io/posts/tech/"
        }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "è®¾è®¡æ¨¡å¼",
      "item": "http://heketong.github.io/posts/tech/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "è®¾è®¡æ¨¡å¼",
  "name": "è®¾è®¡æ¨¡å¼",
  "description": "è®¾è®¡æ¨¡å¼å­¦ä¹ è®°å½•",
  "keywords": [
    "è®¾è®¡æ¨¡å¼", "æ€»ç»“"
  ],
  "articleBody": "è®¾è®¡æ¨¡å¼ä»‹ç» è®¾è®¡æ¨¡å¼æœ€å…³é”®çš„ä½œç”¨æ˜¯ä¸ºäº†å¯å¤ç”¨ï¼Œå‡å°‘å¼€å‘å·¥ä½œé‡ã€‚\næ¨¡å¼å°±æ˜¯é’ˆå¯¹ç°å®ä¸–ç•Œé‡å¤å‡ºç°çš„é—®é¢˜ï¼Œç»™å‡ºæ ¸å¿ƒè§£å†³æ–¹æ¡ˆï¼Œå¿½ç•¥æ‰ä¸€äº›ä¸é‡è¦çš„ç»†èŠ‚ã€‚\nåˆ†è§£å’ŒæŠ½è±¡æ˜¯2ç§è§£å†³ç°å®é—®é¢˜çš„é€šç”¨æ–¹æ³•ã€‚\nåº•å±‚æ€ç»´æ˜¯å‘ä¸‹çš„ï¼Œå¤šæ•°æ˜¯ç†è§£è®¡ç®—æœºçš„ï¼ŒæŠ½è±¡æ˜¯å‘ä¸Šæ€ç»´ï¼Œå¤šæ•°æ˜¯ç†è§£ç°å®ä¸–ç•Œçš„ã€‚\nåœ¨ç°å®å·¥ç¨‹å¼€å‘ä¸­ï¼Œè¦å¯»æ‰¾éœ€æ±‚é¢‘ç¹å˜åŒ–ç‚¹ï¼Œåº”ç”¨å¯¹åº”çš„è®¾è®¡æ¨¡å¼ï¼Œä»è€Œæé«˜ä»£ç å¤ç”¨æ€§ï¼Œé™ä½å¼€å‘æˆæœ¬ï¼Œæµ‹è¯•æˆæœ¬ã€‚\nè®¾è®¡æ¨¡å¼çš„åº”ç”¨ä¸å®œå…ˆå…¥ä¸ºä¸»ï¼Œæœ€å¥½æ˜¯Refactoring to Patterns ä¹Ÿå°±æ˜¯é’ˆå¯¹ç°å®çš„ç—›ç‚¹(å˜åŒ–ç‚¹)ï¼Œé‡æ„åˆ°è®¾è®¡æ¨¡å¼\né‡æ„çš„å…³é”®æŠ€å·§ é™æ€â€”-åŠ¨æ€ æ—©ç»‘å®šâ€”-æ™šç»‘å®š ç»§æ‰¿â€”â€“ç»„åˆ ç¼–è¯‘æ—¶ä¾èµ–â€”-è¿è¡Œæ—¶ä¾èµ– ç´§è€¦åˆâ€”-æ¾è€¦åˆ é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ é‡æ–°è®¤è¯†é¢å‘å¯¹è±¡ ç†è§£éš”ç¦»å˜åŒ–\nå®è§‚å±‚é¢æ¥çœ‹ é¢å‘å¯¹è±¡çš„æ„å»ºæ–¹å¼èƒ½å¤Ÿé€‚åº”è½¯ä»¶çš„å˜åŒ–ï¼Œèƒ½å°†å˜åŒ–å¸¦æ¥çš„å½±å“å‡ä¸ºæœ€å°\nå„å¸å…¶èŒ\nå¾®è§‚å±‚é¢æ¥è¯´ï¼Œé¢å‘å¯¹è±¡æ›´å¼ºè°ƒç‹¬ç«‹çš„å„ä¸ªç±»\néœ€æ±‚å˜åŒ–å¸¦æ¥çš„æ–°å¢ç±» ä¸åº”è¯¥æ”¹å˜åŸæ¥ç±»çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªç±»å„å¸å…¶èŒ\nå¯¹è±¡åˆ°åº•æ˜¯ä»€ä¹ˆ\nä»è¯­è¨€çš„è§’åº¦æ¥è¯´ï¼Œå¯¹è±¡å°è£…äº†ä»£ç å’Œæ•°æ®\nä»è§„æ ¼å±‚é¢æ¥è¯´ï¼Œå¯¹è±¡æ˜¯ä¸€äº›åˆ—å¯ä»¥ä½¿ç”¨çš„å…¬å…±æ¥å£\nä»æ¦‚å¿µå±‚é¢æ¥è¯´ï¼Œå¯¹è±¡æ˜¯æ‹¥æœ‰æŸç§è´£ä»»çš„æŠ½è±¡\n1 ä¾èµ–å€’ç½®åŸåˆ™(DIP) é«˜å±‚æ¨¡å—(å¾€å¾€æ˜¯ç¨³å®šçš„)ä¸åº”è¯¥ä¾èµ–åº•å±‚æ¨¡å—(å¾€å¾€æ˜¯ä¸åœçš„å˜åŒ–çš„)ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚\næŠ½è±¡(ç¨³å®š)ä¸åº”è¯¥ä¾èµ–äºå®ç°ç»†èŠ‚(å˜åŒ–)ï¼Œå®ç°ç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡(ç¨³å®š)\n2 å¼€æ”¾å°é—­åŸåˆ™(OCP) å¯¹äºæ‰©å±•æ˜¯å¼€æ”¾çš„ï¼Œå¯¹äºä¿®æ”¹æ˜¯å°é—­çš„ ç±»æ¨¡å—åº”è¯¥æ˜¯æ˜¯å¯ä»¥æ‰©å±•çš„ï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹ã€‚ åœ¨è®¾è®¡ä¹‹åˆåº”è¯¥è€ƒè™‘å…¶æ‰©å±•æ€§ï¼Œä¸åº”è¯¥å› ä¸ºæ–°å¢ä¸€ä¸ªåŠŸèƒ½ï¼Œåè€Œè¦æ›´æ”¹åŸå…ˆçš„åŠŸèƒ½ï¼Œåº”è¯¥è®©æ–°å¢åŠŸèƒ½ä¸ºæ‰©å±•ï¼Œä¸åº”è¯¥ä¿®æ”¹åŸå…ˆçš„ä»£ç ã€‚\n3 å•ä¸€èŒè´£åŸåˆ™(SRP) ä¸€ä¸ªç±»åº”è¯¥ä»…æœ‰ä¸€ä¸ªå¼•èµ·å…¶å˜åŒ–çš„åŸå›  å…¶å˜åŒ–çš„åŸå›  å¾€å¾€å°±æ˜¯å…¶è¯¥æ‰¿æ‹…çš„è´£ä»»ã€‚ 4 Liskovæ›¿æ¢åŸåˆ™(LSP) å­ç±»å¿…é¡»èƒ½å¤Ÿæ›¿æ¢å®ƒçš„çˆ¶ç±»(IS-A) ç»§æ‰¿è¡¨è¾¾ç±»å‹æŠ½è±¡ 5 æ¥å£éš”ç¦»åŸåˆ™(ISP) ä¸åº”è¯¥å¼ºè¿«å®¢æˆ·ç¨‹åºä¾èµ–ä»–ä»¬ä¸ä½¿ç”¨çš„æ–¹æ³• æ¥å£åº”è¯¥å°è€Œå®Œå¤‡ 6 ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆ è€Œä¸æ˜¯ç±»ç»§æ‰¿ ç±»ç»§æ‰¿é€šå¸¸æ˜¯ç™½ç®±å¤ç”¨ å¯¹è±¡ç»„åˆé€šå¸¸ä¸ºé»‘ç®±å¤ç”¨ ç»§æ‰¿åœ¨æŸç§ç¨‹åº¦ä¸Šç ´åäº†å°è£…æ€§ï¼Œå­ç±»çˆ¶ç±»è€¦åˆåº¦è¾ƒé«˜ å¯¹è±¡ç»„åˆåªè¦æ±‚è¢«ç»„åˆçš„å¯¹è±¡æœ‰è‰¯å¥½çš„æ¥å£å®šä¹‰ï¼Œè€¦åˆåº¦ä½ 7 å°è£…å˜åŒ–ç‚¹ ä½¿ç”¨å°è£…æ¥åˆ›å»ºå¯¹è±¡ä¹‹é—´çš„åˆ†ç•Œå±‚ï¼Œè®©è®¾è®¡è€…å¯ä»¥åœ¨åˆ†ç•Œå±‚ä¸€ä¾§ä¿®æ”¹ï¼Œä¸å½±å“å¦å¤–ä¸€ä¾§ï¼Œå®ç°åˆ†å±‚é—´çš„æ¾è€¦åˆã€‚\nå°è£…å…¶å®æ˜¯å°è£…å˜åŒ–ç‚¹ã€‚\n8 é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œä¸è¦é’ˆå¯¹å®ç°ç¼–ç¨‹ ä¸å°†å˜é‡å£°æ˜ä¸ºç‰¹å®šçš„ç±»ï¼Œè€Œæ˜¯å£°æ˜ä¸ºæ¥å£ã€‚ å®¢æˆ·ç¨‹åºä¸éœ€è¦çŸ¥é“å¯¹è±¡å…·ä½“ç±»å‹ï¼Œåªéœ€è¦çŸ¥é“å…¶å¼€æ”¾çš„æ¥å£ å‡å°‘å„éƒ¨åˆ†ä¾èµ–å…³ç³»ï¼Œå®ç°é«˜å†…èš æ¾è€¦åˆ äº§ä¸šå¼ºç›› æœ€å¥½æ˜¯æ¥å£ç›¸å½“æ ‡å‡†åŒ–ã€‚ æ¨¡ç‰ˆæ–¹æ³•Template methodâ€”ç»„ä»¶åä½œ éœ€æ±‚èƒŒæ™¯ï¼š éœ€è¦å®ç°å¤šä¸ªappï¼Œéƒ½éœ€è¦5ä¸ªæ“ä½œæ­¥éª¤(5ä¸ªæ­¥éª¤æ“ä½œé¡ºåºä¹Ÿéƒ½æ˜¯å›ºå®šçš„),æœ‰3ä¸ªå·²ç»æœ‰æ¡†æ¶æˆ–è€…libraryåº“å®ç°äº†ï¼Œå®ç°è¿™ä¸ªapp\nä¼ ç»Ÿç»“æ„åŒ–æ€æƒ³å®ç° #include using namespace std; class Library{//è¿™é‡Œå¾€å¾€æ˜¯åº“å‡½æ•°æˆ–è€…åˆ«äººçš„å®ç° å®ç°äº†3ä¸ªæ–¹æ³• public: bool Step1(){ //... cout\u003c\u003c\"Library::Step1()\"\u003c\u003cendl; return true; } void Step3(){ cout\u003c\u003c\"Library::Step3()\"\u003c\u003cendl; //... } void Step5(){ cout\u003c\u003c\"Library::Step5()\"\u003c\u003cendl; //... } }; class App{//åº”ç”¨ç¨‹åº å®ç°Step2 Step4æ–¹æ³• è¿™2ä¸ªæ–¹æ³•ç»å¸¸å˜åŒ– ä¸åŒçš„åº”ç”¨ä¸ä¸€æ ·çš„å®ç° public: void Step2(){ cout\u003c\u003c\"App::Step2()\"\u003c\u003cendl; //... } void Step4(){ cout\u003c\u003c\"App::Step4()\"\u003c\u003cendl; } }; int main(){//å¦‚æœè¦å®ç°å¦å¤–ä¸€ä¸ªç¨‹åº åˆ™éœ€è¦é‡æ–°å†å†™ä¸€ä¸ªmain é‡æ–°å†™ä¸€ä¸ªAppç±» å®ç°Step2å’ŒStep4æ–¹æ³• App app; Library lib; //ä»¥ä¸‹ä¸ºç¨‹åºå®ç°é€»è¾‘ ä¹Ÿå°±æ˜¯ç®—æ³•æ¡†æ¶ç»“æ„ if(lib.Step1()){ app.Step2(); } lib.Step3(); for (int i=1;i\u003c4;++i) { app.Step4(); } lib.Step5(); } //å¦‚æœ34--41çš„ç®—æ³•æ­¥éª¤æ•´ä½“æ˜¯ç¨³å®šçš„ åªæœ‰Step2å’ŒStep4æ˜¯ç»å¸¸å˜åŒ–çš„ å¯ä»¥è€ƒè™‘ç”¨TempalteMethodè®¾è®¡æ¨¡å¼æ¥å®ç° åŠ¨æœº æŸé¡¹ä»»åŠ¡ å¸¸å¸¸æœ‰ç¨³å®šçš„æ•´ä½“æ“ä½œç»“æ„ï¼Œä½†æ˜¯å„ä¸ªå­æ­¥éª¤éœ€è¦ç»å¸¸å˜åŒ–ï¼Œæˆ–è€…ç”±äºå›ºæœ‰çš„åŸå› (æ¡†æ¶å’Œåº”ç”¨çš„å…³ç³»)ï¼Œæ— æ³•å’Œä»»åŠ¡çš„æ•´ä½“ç»“æ„åŒæ—¶å®ç° è¿™å°±è¦æ€è€ƒå¦‚ä½•ç¡®å®šç¨³å®šçš„æ“ä½œç»“æ„çš„å‰æä¸‹ï¼Œæ¥çµæ´»åº”å¯¹å„ä¸ªå­æ­¥éª¤çš„å˜åŒ–æˆ–è€…æ™šæœŸå®ç°éœ€æ±‚ æ¨¡å¼å®šä¹‰ å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•éª¨æ¶(å¾€å¾€æ˜¯ç¨³å®šçš„)ï¼Œå°†ä¸€äº›æ­¥éª¤(å¾€å¾€æ˜¯å˜åŒ–äº†ï¼Œå‰æœŸç¡®å®šä¸ä¸‹æ¥)å»¶è¿Ÿåˆ°å­ç±»ä¸­å®ç°ï¼ŒTemplate Methodä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜(å¤ç”¨)ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰(Overrideé‡å†™)è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šå­æ­¥éª¤ã€‚ è¦ç‚¹æ€»ç»“ tempalte methodæ˜¯ä¸€ç§éå¸¸åŸºç¡€æ€§çš„è®¾è®¡æ¨¡å¼ åœ¨é¢å‘å¯¹è±¡ç³»ç»Ÿä¸­æœ‰å¤§é‡çš„åº”ç”¨ï¼Œæœºåˆ¶éå¸¸ç®€æ´(è™šå‡½æ•°çš„å¤šæ€)ï¼Œä¸ºå¾ˆå¤šåº”ç”¨ç¨‹åºçš„æ¡†æ¶æä¾›äº†çµæ´»çš„æ‰©å±•ç‚¹(ç»§æ‰¿+è™šå‡½æ•°å¤šæ€åº¦)ï¼Œæ˜¯ä»£ç å¤ç”¨çš„åŸºæœ¬å®ç°ç»“æ„ ä¸è¦è°ƒç”¨æˆ‘ï¼Œè®©æˆ‘æ¥è°ƒç”¨ä½  å…·ä½“å®ç°æ–¹é¢ï¼Œè¢«template methodè°ƒç”¨çš„è™šæ–¹æ³•å¯ä»¥æœ‰å®ç°ä¹Ÿå¯ä»¥æ²¡æœ‰å®ç°ï¼Œä¸€èˆ¬å°†è¢«è°ƒç”¨çš„æ–¹æ³•è®¾ç½®ä¸ºprotectrdã€‚å› ä¸ºè¿™äº›è¢«template methodè°ƒç”¨çš„è™šæ–¹æ³•ç¦»å¼€äº†ä¸»æµç¨‹å¾€å¾€æ²¡æœ‰æ„ä¹‰ï¼Œä¹Ÿä¸åº”è¯¥è®¾ç½®ä¸ºpublicæš´æ¼ç»™å¤–éƒ¨ã€‚ å‡ å¼ å›¾è§£ æ¨¡ç‰ˆæ–¹æ³•ä»£ç å®ç° #include using namespace std; class Library{ public: void run(){//template method //è¿™é‡Œçš„runæ–¹æ³•ä¹Ÿå°±æ˜¯æ‰€è¯´çš„ç›¸å¯¹ç¨³å®šçš„æ•´ä½“å¤„ç†ç»“æ„ Step2å’ŒStep4ä¼šæ ¹æ®ä¸åŒçš„åº”ç”¨å®ç°ä¸ºä¸åŒçš„é€»è¾‘ï¼Œæ‰€ä»¥å£°æ˜ä¸ºçº¯è™šå‡½æ•° if(Step1()){ Step2(); } Step3(); for (int i=1;i\u003c4;++i) { Step4(); } Step5(); } virtual ~Library(){} protected: bool Step1(){ //... cout\u003c\u003c\"Library::Step1()\"\u003c\u003cendl; return true; } void Step3(){ cout\u003c\u003c\"Library::Step3()\"\u003c\u003cendl; //... } void Step5(){ cout\u003c\u003c\"Library::Step5()\"\u003c\u003cendl; //... } virtual void Step2()=0;//è¿™é‡Œå£°æ˜ä¸ºçº¯è™šå‡½æ•° è®©å­ç±»å»å®ç° virtual void Step4()=0; }; class App :public Library{//ç»§æ‰¿æ¡†æ¶ç±» å®ç°å®¹æ˜“å˜åŒ–çš„2ä¸ªå‡½æ•° protected: void Step2(){ cout\u003c\u003c\"App::Step2()\"\u003c\u003cendl; //... } void Step4(){ cout\u003c\u003c\"App::Step4()\"\u003c\u003cendl; } }; int main(){ Library* pLib=new App(); pLib-\u003erun(); delete pLib; return 0; } ç­–ç•¥æ¨¡å¼ strategyâ€”ç»„ä»¶åä½œ éœ€æ±‚èƒŒæ™¯ éœ€è¦å®ç°ä¸€ä¸ªç±»ï¼Œè®¡ç®—å„ä¸ªå›½å®¶çš„ç¨ï¼Œæ¯ä¸ªå›½å®¶çš„è®¡ç¨ç®—æ³•ä¸ä¸€æ ·ï¼ŒåæœŸå¯èƒ½ä¿®æ”¹æˆ–è€…å¢åŠ ä¸€äº›å›½å®¶çš„è®¡ç¨ç®—æ³•\nä¼ ç»Ÿå®ç° //ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ traditional solution enum TaxBase { CN_Tax, US_Tax, DE_Tax, FR_Tax //å¦‚æœè¦å¢åŠ æ”¯æŒæ³•å›½ç¨æ³•å°±è¦ä¿®æ”¹ }; class SalesOrder{ TaxBase tax; public: double CalculateTax(){ //ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ ç›´æ¥ifelse åˆ†è€Œæ²»ä¹‹ éœ€è¦ç»å¸¸ä¿®æ”¹è¿™ä¸ªå‡½æ•° å¾ˆå¯èƒ½å‡ºç°å¼•å…¥æ–°çš„éœ€æ±‚ å¯¼è‡´åŸå…ˆçš„å®ç°æ–¹æ¡ˆå¼•å…¥bug if (tax == CN_Tax){ //CN*********** } else if (tax == US_Tax){ //US*********** } else if (tax == DE_Tax){ //DE*********** } else if (tax == FR_Tax){ //å¦‚æœè¦å¢åŠ æ”¯æŒæ³•å›½ç¨æ³•å°±è¦ä¿®æ”¹ è¿™ä¸ªåœ°æ–¹è¿èƒŒäº†å¼€é—­åŸåˆ™(ç”¨æ‰©å±•çš„æ–¹å¼æ”¯æŒä¿®æ”¹ è€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹) //ç»éªŒå‘Šè¯‰æˆ‘ä»¬ï¼Œç›´æ¥ä¿®æ”¹çš„æ–¹å¼ ä¹Ÿæ¯”è¾ƒå®¹æ˜“å¼•å…¥bug } } }; åŠ¨æœº å¦‚æœç°å®è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒæŸä¸€ä¸ªå¯¹è±¡ä½¿ç”¨äº†å¤šç§ç®—æ³•ï¼Œè€Œä¸”è¿™äº›ç®—æ³•å¯èƒ½ç»å¸¸æ”¹å˜ï¼Œæˆ–è€…ç»å¸¸éœ€è¦æ–°å¢ç±»ä¼¼ç®—æ³•(æ¯”å¦‚è®¡ç®—ä¸åŒå›½å®¶çš„ç¨)ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœå°†è¿™äº›ç®—æ³•å…¨éƒ¨ç¼–ç åˆ°å¯¹è±¡ä¸­ï¼Œè¿™ä¸ªå¯¹è±¡å°±ä¼šå˜çš„éå¸¸å¤æ‚ï¼Œå®¹æ˜“å‡ºé”™ï¼Œç­–ç•¥æ¨¡å¼å¯ä»¥è§£å†³é—®é¢˜ æ›´ç›´è§‚ç‚¹ å¦‚æœä½¿ç”¨äº†å¤§é‡if elseæˆ–è€…switch caseï¼Œè€Œä¸”ä¸ç¨³å®šï¼Œç»å¸¸å˜åŒ–ï¼Œå°±å¯ä»¥è€ƒè™‘ç”¨strategyæ¨¡å¼æ”¹é€  è¦è€ƒè™‘ä½¿ç”¨å¤šæ€æœºåˆ¶åœ¨è¿è¡Œæ—¶åŠ¨æ€çš„ä½¿ç”¨ç›¸åº”çš„ç®—æ³•è§£å†³é—®é¢˜ æ¨¡å¼çš„å®šä¹‰ å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•(åŠ¨æœºç« èŠ‚æåˆ°çš„ç»å¸¸å˜åŒ–çš„ç®—æ³•)ï¼ŒæŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥(ä¸åŒçš„å­ç±»)ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯äº’ç›¸æ›¿æ¢(å˜åŒ–)â€“(ä½¿ç”¨å¤šæ€è¿è¡Œæ—¶å†³å®šä½¿ç”¨å“ªç§ç®—æ³•)ã€‚è¯¥æ¨¡å¼ä½¿å¾—ç®—æ³•å¯ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·ç¨‹åº(ç¨³å®š)è€Œå˜åŒ–(æ‰©å±•ï¼Œå­ç±»åŒ–)ã€‚â€”â€”ã€Šè®¾è®¡æ¨¡å¼ã€‹GoF è¦ç‚¹æ€»ç»“ StrategyåŠå…¶å­ç±»ä¸ºç»„ä»¶æä¾›äº†ä¸€ç³»åˆ—å¯é‡ç”¨çš„ç®—æ³•ï¼Œä»è€Œå¯ä»¥ä½¿å¾—ç±»å‹åœ¨è¿è¡Œæ—¶æ–¹ä¾¿åœ°æ ¹æ®éœ€è¦åœ¨å„ä¸ªç®—æ³•ä¹‹é—´è¿›è¡Œåˆ‡æ¢(å¤šæ€)ã€‚\nStrategyæ¨¡å¼æä¾›äº†ç”¨æ¡ä»¶åˆ¤æ–­è¯­å¥ä»¥å¤–çš„å¦ä¸€ç§é€‰æ‹©ï¼Œæ¶ˆé™¤æ¡ä»¶åˆ¤æ–­è¯­å¥ï¼Œå°±æ˜¯åœ¨è§£è€¦åˆã€‚å«æœ‰è®¸å¤šæ¡ä»¶åˆ¤æ–­è¯­å¥çš„ä»£ç é€šå¸¸éƒ½éœ€ è¦Strategyæ¨¡å¼ã€‚\nå¦‚æœStrategyå¯¹è±¡æ²¡æœ‰å®ä¾‹å˜é‡ï¼Œé‚£ä¹ˆå„ä¸ªä¸Šä¸‹æ–‡å¯ä»¥å…±äº«åŒä¸€ä¸ª Strategyå¯¹è±¡ï¼Œä»è€ŒèŠ‚çœå¯¹è±¡å¼€é”€\nå›¾è§£ ç­–ç•¥æ¨¡å¼ä»£ç å®ç° //ç­–ç•¥æ¨¡å¼ class Context{}; class TaxStrategy{//ç­–ç•¥ç±»åŸºç±» public: virtual double Calculate(const Context\u0026 context)=0;//çº¯è™šå‡½æ•° ä¸åŒçš„ç®—æ³•æŠ½è±¡ è¿è¡Œæ—¶è°ƒç”¨ç›¸åº”çš„ç®—æ³• virtual ~TaxStrategy(){} }; class StrategyFactory{//å·¥å‚ç±» æ ¹æ®ç°å®æƒ…å†µç”Ÿæˆä¸åŒçš„å­ç±»ï¼Œè§£å†³æƒ³è¦çš„é—®é¢˜ public: TaxStrategy* NewStrategy(){ return nullptr;} }; class CNTax : public TaxStrategy{//å­ç±» ç»§æ‰¿ç­–ç•¥åŸºç±» å®ç°è™šæ–¹æ³• ç”¨äºå¤šæ€ public: virtual double Calculate(const Context\u0026 context){ //*********** } }; class USTax : public TaxStrategy{ public: virtual double Calculate(const Context\u0026 context){ //*********** } }; class DETax : public TaxStrategy{ public: virtual double Calculate(const Context\u0026 context){ //*********** } }; //è¿™é‡Œå¦‚æœæ–°å¢ä¸€ä¸ªæ³•å›½çš„ï¼Œå°±æ˜¯æ‰©å±•çš„æ–¹å¼æ”¯æŒ class FRTax : public TaxStrategy{ public: virtual double Calculate(const Context\u0026 context){ //......... } }; class SalesOrder{ private: TaxStrategy* strategy; public: SalesOrder(StrategyFactory* strategyFactory){ this-\u003estrategy = strategyFactory-\u003eNewStrategy(); } ~SalesOrder(){ delete this-\u003estrategy; } double CalculateTax(){ //... Context context; double val = strategy-\u003eCalculate(context); //å¤šæ€è°ƒç”¨ //... } }; è§‚å¯Ÿè€…æ¨¡å¼Observerâ€”ç»„ä»¶åä½œ éœ€æ±‚èƒŒæ™¯ éœ€è¦å®ç°ä¸€ä¸ªæ–‡ä»¶åˆ†å‰²ä¸šåŠ¡ï¼ŒåŒæ—¶éœ€è¦æ˜¾ç¤ºè¿›åº¦æ¡ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶åˆ†å‰²æ—¶å€™è¾¾åˆ°ä¸€å®šçŠ¶æ€éœ€è¦é€šçŸ¥æŸä¸ªç±»ï¼Œåç»­å¾ˆæœ‰å¯èƒ½è¿˜æœ‰é€šçŸ¥å¤šä¸ªç±»\nä¼ ç»Ÿå®ç° //traditional solutionä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ //åˆ†å‰²å¤§æ–‡ä»¶ï¼Œæ˜¾ç¤ºæˆ–è€…æ‰“å°å¤„ç†è¿›åº¦ #include #include #include \"common.h\" using namespace std; class FileSplitter//è¯¥ç±»æ˜¯è¢«ä¾èµ–çš„å¯¹è±¡ï¼ŒçŠ¶æ€å‘ç”Ÿå˜åŒ–éœ€è¦é€šçŸ¥ProgressBar { string m_filePath; int m_fileNumber; ProgressBar* m_progressBar;//è¯¥ç±»è´Ÿè´£æ”¶åˆ°é€šçŸ¥æ›´æ–°è¿›åº¦æ¡ //å¦‚æœè¦æ–°å¢å…¶å®ƒè§‚å¯Ÿè€…ï¼Œè¿™é‡Œéœ€è¦æ–°å¢å…·ä½“çš„å®ç°ç±»æŒ‡é’ˆ ProgressBar1* æ¯”è¾ƒéº»çƒ¦ï¼Œè¿™ä¸ªä¸šåŠ¡ç±»ä¹Ÿè¦é¢‘ç¹æ”¹å˜ public: FileSplitter(const string\u0026 filePath, int fileNumber, ProgressBar* progressBar) : m_filePath(filePath), m_fileNumber(fileNumber), m_progressBar(progressBar){ } void split(){ //1.è¯»å–å¤§æ–‡ä»¶ //2.åˆ†æ‰¹æ¬¡å‘å°æ–‡ä»¶ä¸­å†™å…¥ for (int i = 0; i \u003c m_fileNumber; i++){ //... float progressValue = m_fileNumber; progressValue = (i + 1) / progressValue; m_progressBar-\u003esetValue(progressValue); //ä»ç¼–è¯‘å±‚é¢å¦‚æœProgressBarå‘ç”Ÿå˜åŒ– ä¹Ÿå°±æ˜¯è§‚å¯Ÿè€…å‘ç”Ÿå˜åŒ–ï¼ŒFileSplitterç±»ä¹Ÿéœ€è¦å˜åŒ– é‡æ–°ç¼–è¯‘ //ä»ä¸šåŠ¡å‘å±•æ¥çœ‹ï¼Œå¦‚æœéœ€è¦æ–°å¢è§‚å¯Ÿè€…ä¹Ÿæ˜¯æ¯”è¾ƒéº»çƒ¦çš„ //è¿™ä¸ªè¿èƒŒäº†ä¾èµ–å€’ç½®åŸåˆ™ï¼Œé«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–æ­¤å±‚æ¨¡å—å˜åŒ–ï¼ŒFileSplitterä¸åº”è¯¥ä¾èµ–ProgressBar //ä¸ªäººè§‰å¾—ä¹Ÿè¿èƒŒäº†å¼€é—­åŸåˆ™ï¼Œè¦ç”¨æ‰©å±•çš„æ–¹å¼æ”¯æŒæ–°å¢ï¼Œä¸åº”è¯¥ç›´æ¥ä¿®æ”¹ } } }; //traditional solutionä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ //åˆ†å‰²å¤§æ–‡ä»¶ï¼Œæ˜¾ç¤ºæˆ–è€…æ‰“å°å¤„ç†è¿›åº¦ #include \"common.h\" class MainForm : public Form { TextBox* txtFilePath; TextBox* txtFileNumber; ProgressBar* progressBar; public: void Button1_Click(){ string filePath = txtFilePath-\u003egetText(); int number = atoi(txtFileNumber-\u003egetText().c_str()); FileSplitter splitter(filePath, number, progressBar); //ä»ä¸šåŠ¡å‘å±•æ¥çœ‹ï¼Œå¦‚æœéœ€è¦æ–°å¢è§‚å¯Ÿè€…ä¹Ÿæ˜¯æ¯”è¾ƒéº»çƒ¦çš„ éœ€è¦ä¿®æ”¹FileSplitter æ„é€ æ–¹æ³•ï¼Œä¼ å…¥æ–°å¢çš„è§‚å¯Ÿè€…ç±»æŒ‡é’ˆ //ä¹Ÿéœ€è¦ä¿®æ”¹FileSplitteré€šçŸ¥é€»è¾‘ å¢åŠ å¯¹æ–°å¢è§‚å¯Ÿè€…çš„å¤„ç† splitter.split(); } }; åŠ¨æœº æˆ‘ä»¬è¦ä¸ºæŸäº›å¯¹è±¡ä¹‹é—´å»ºç«‹\"é€šçŸ¥ä¾èµ–å…³ç³»\"ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå¯¹è±¡çŠ¶æ€å‘ç”Ÿå˜æ›´ï¼Œéœ€è¦è‡ªåŠ¨é€šçŸ¥å…¶å®ƒä¾èµ–ä¸å®ƒçš„å¯¹è±¡ã€‚å¦‚æœè¿™ç§ä¾èµ–å…³ç³»è¿‡äºç´§å¯†ï¼Œå°†ä½¿è½¯ä»¶ä¸èƒ½å¾ˆå¥½çš„æŠµå¾¡å˜åŒ–ã€‚\nå¯ä»¥ä½¿ç”¨é¢å‘å¯¹è±¡æŠ€æœ¯ï¼Œå°†è¿™ç§ä¾èµ–å…³ç³»å¼±åŒ–ï¼Œå½¢æˆä¸€ç§è¾ƒä¸ºç¨³å®šçš„ä¾èµ–å…³ç³»ï¼Œä»è€Œå®ç°æ¾è€¦åˆã€‚\nå¤§è‡´å®ç°ï¼Œè¢«ä¾èµ–çš„å¯¹è±¡éœ€è¦åŒ…å«ä¸€ä¸ªé›†åˆ(é“¾è¡¨æˆ–è€…æ•°ç»„éƒ½å¯ä»¥),é›†åˆä¿å­˜çš„æ˜¯æŠ½è±¡æ¥å£åŸºç±»(è§‚å¯Ÿè€…çš„åŸºç±»æŒ‡é’ˆ)ï¼Œå½“è‡ªå·±çŠ¶æ€å˜åŒ–çš„æ—¶å€™éå†é›†åˆï¼Œè°ƒç”¨æŠ½è±¡æ¥å£åŸºç±»çš„é€šçŸ¥å‡½æ•°(å¤šæ€å®ç°è¿è¡Œæ—¶è°ƒç”¨å¤šä¸ªè§‚å¯Ÿè€…çš„ç›¸åº”å¤„ç†å‡½æ•°)ã€‚\næ¨¡å¼çš„å®šä¹‰ å®šä¹‰å¯¹è±¡è§çš„ä¸€å¯¹å¤š(å˜åŒ–ä¹Ÿå°±æ˜¯è§‚å¯Ÿè€…)çš„ä¾èµ–å…³ç³»ï¼Œä»¥ä¾¿å½“è¢«ä¾èµ–å¯¹è±¡(Subject)çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰€æœ‰ä¾èµ–ä¸å®ƒçš„å¯¹è±¡(è§‚å¯Ÿè€…)éƒ½èƒ½å¾—åˆ°é€šçŸ¥å¹¶ä¸”è‡ªåŠ¨æ›´æ–° ç»“æ„å›¾è§£ è¦ç‚¹æ€»ç»“ ä½¿ç”¨Observerè§‚å¯Ÿè€…æ¨¡å¼å¯ä»¥ç‹¬ç«‹çš„æ”¹å˜ç›®æ ‡å’Œè§‚å¯Ÿè€…ï¼Œå®ç°æ¾è€¦åˆ ç›®æ ‡å‘é€é€šçŸ¥çš„æ—¶å€™ï¼Œæ— éœ€æŒ‡å®šå…·ä½“çš„è§‚å¯Ÿè€…ï¼Œé€šçŸ¥(ä¹Ÿå¯ä»¥å†™æ€é€šçŸ¥ä¿¡æ¯ä½œä¸ºå‚æ•°)ä¼šè‡ªåŠ¨ä¼ æ’­ è§‚å¯Ÿè€…è‡ªå·±å†³å®šæ˜¯å¦éœ€è¦è®¢é˜…é€šçŸ¥ï¼Œå¦‚æœéœ€è¦è¯·è°ƒç”¨Subjectçš„æ·»åŠ è§‚å¯Ÿè€…APIï¼Œç›®æ ‡å¯¹è±¡å¯¹æ­¤å¯ä»¥æ˜¯é€æ˜çš„ å½“å¬åˆ°çŠ¶æ€å˜æ›´éœ€è¦é€šçŸ¥å¤šä¸ªå¯¹è±¡çš„åœºæ™¯å°±å¾€å¾€å¯ä»¥è€ƒè™‘Observerè§‚å¯Ÿè€…æ¨¡å¼äº† Observeræ¨¡å¼æ˜¯åŸºäºäº‹ä»¶çš„UIæ¡†æ¶ä¸­éå¸¸å¸¸ç”¨çš„æ¨¡å¼ï¼Œä¹Ÿæ˜¯MVCæ¨¡å¼çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ† è§‚å¯Ÿè€…æ¨¡å¼ä»£ç å®ç° #include #include #include using namespace std; class IProgress{//è§‚å¯Ÿè€…æŠ½è±¡åŸºç±» public: virtual void DoProgress(float value)=0;//è§‚å¯Ÿè€…éœ€è¦å®ç°çš„å‡½æ•°(æ”¶åˆ°é€šçŸ¥åè¢«è°ƒç”¨) virtual ~IProgress(){} }; class FileSplitter { string m_filePath; int m_fileNumber; list\u003cIProgress*\u003e m_iprogressList; // æŠ½è±¡é€šçŸ¥æœºåˆ¶ï¼Œæ”¯æŒå¤šä¸ªè§‚å¯Ÿè€… //è¿™ç§æœºåˆ¶å°±ä¸å†ä¾èµ–å…·ä½“çš„è§‚å¯Ÿè€… ä¿è¯FileSplitterç±»å¤„ç†é€»è¾‘ç›¸å¯¹ç¨³å®š public: FileSplitter(const string\u0026 filePath, int fileNumber) : m_filePath(filePath), m_fileNumber(fileNumber){ } void split(){ //1.è¯»å–å¤§æ–‡ä»¶ //2.åˆ†æ‰¹æ¬¡å‘å°æ–‡ä»¶ä¸­å†™å…¥ for (int i = 0; i \u003c m_fileNumber; i++){ //... float progressValue = m_fileNumber; progressValue = (i + 1) / progressValue; onProgress(progressValue);//å‘é€é€šçŸ¥ } } void addIProgress(IProgress* iprogress){//å¢åŠ è§‚å¯Ÿè€…API m_iprogressList.push_back(iprogress); } void removeIProgress(IProgress* iprogress){//ç§»é™¤è§‚å¯Ÿè€…API m_iprogressList.remove(iprogress); } protected: virtual void onProgress(float value){//é€šçŸ¥å‡½æ•° list\u003cIProgress*\u003e::iterator itor=m_iprogressList.begin(); while (itor != m_iprogressList.end() ){ (*itor)-\u003eDoProgress(value); //æ›´æ–°è¿›åº¦æ¡ è™šå‡½æ•°å¤šæ€è°ƒç”¨å¤šä¸ªè§‚å¯Ÿè€…çš„å¤„ç†å‡½æ•° itor++; } } }; #include \"common.h\" #include using namespace std; class MainForm : public Form, public IProgress { TextBox* txtFilePath; TextBox* txtFileNumber; ProgressBar* progressBar; public: void Button1_Click(){ string filePath = txtFilePath-\u003egetText(); int number = atoi(txtFileNumber-\u003egetText().c_str()); ConsoleNotifier cn; FileSplitter splitter(filePath, number); splitter.addIProgress(this); //è®¢é˜…é€šçŸ¥ splitter.addIProgress(\u0026cn)ï¼› //è®¢é˜…é€šçŸ¥ splitter.split(); splitter.removeIProgress(this); } virtual void DoProgress(float value){ progressBar-\u003esetValue(value); } }; class ConsoleNotifier : public IProgress { public: virtual void DoProgress(float value){ cout \u003c\u003c \".\"; } }; è£…é¥°æ¨¡å¼Decoratorâ€”å•ä¸€èŒè´£ éœ€æ±‚èƒŒæ™¯ éœ€è¦å®ç°æ–‡ä»¶æµæ“ä½œç®€æ˜“ç³»ç»Ÿï¼Œæ”¯æŒçš„æ“ä½œå¤§æ¦‚å°±å¤šäº› read seek writeï¼Œå­˜åœ¨æ™®é€šæ–‡ä»¶æµï¼Œç½‘ç»œæµï¼Œå†…å­˜æµç­‰ç­‰\néšç€ç³»ç»Ÿçš„å‘å±•ï¼Œéœ€è¦å¢åŠ å„ç§æµçš„åŠ å¯†åŠŸèƒ½\néšç€ç³»ç»Ÿçš„å‘å±•ï¼Œéœ€è¦å¢åŠ å„ç§æµçš„ç¼“å­˜åŠŸèƒ½\néšç€ç³»ç»Ÿçš„å‘å±•ï¼Œéœ€è¦å¢åŠ å„ç§æµçš„åŠ å¯†åŒæ—¶ç¼“å­˜åŠŸèƒ½\nä¼ ç»Ÿå®ç° //ä¸šåŠ¡æ“ä½œ class Stream{//æµæ“ä½œåŸºç±»ï¼Œå®šä¹‰ç›¸å…³æ¥å£è™šå‡½æ•° public: virtual char Read(int number)=0; virtual void Seek(int position)=0; virtual void Write(char data)=0; virtual ~Stream(){} }; //æ–‡ä»¶æµæ“ä½œä¸»ä½“ç±» åº”è¯¥ç»§æ‰¿StreamåŸºç±» class FileStream: public Stream{ public: virtual char Read(int number){ //è¯»æ–‡ä»¶æµ } virtual void Seek(int position){ //å®šä½æ–‡ä»¶æµ } virtual void Write(char data){ //å†™æ–‡ä»¶æµ } }; //ç½‘ç»œæµæ“ä½œç±» åº”è¯¥ç»§æ‰¿StreamåŸºç±» class NetworkStream :public Stream{ public: virtual char Read(int number){ //è¯»ç½‘ç»œæµ } virtual void Seek(int position){ //å®šä½ç½‘ç»œæµ } virtual void Write(char data){ //å†™ç½‘ç»œæµ } }; //å†…å­˜æµæ“ä½œç±» åº”è¯¥ç»§æ‰¿StreamåŸºç±» class MemoryStream :public Stream{ public: virtual char Read(int number){ //è¯»å†…å­˜æµ } virtual void Seek(int position){ //å®šä½å†…å­˜æµ } virtual void Write(char data){ //å†™å†…å­˜æµ } }; //æ‰©å±•åŠ å¯†çš„åŠŸèƒ½ ä¼ ç»Ÿæ–¹æ¡ˆæ–°å¢å¤šä¸ªç±» åˆ†åˆ«ç»§æ‰¿æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµæ“ä½œç±» å¤§é‡å­ç±»ç”Ÿæˆ class CryptoFileStream :public FileStream{ public: virtual char Read(int number){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... è·Ÿç½‘ç»œæµã€å†…å­˜æµä»£ç å­˜åœ¨å¤§é‡é‡å¤ FileStream::Read(number);//è¯»æ–‡ä»¶æµ } virtual void Seek(int position){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... è·Ÿç½‘ç»œæµã€å†…å­˜æµä»£ç å­˜åœ¨å¤§é‡é‡å¤ FileStream::Seek(position);//å®šä½æ–‡ä»¶æµ //é¢å¤–çš„åŠ å¯†æ“ä½œ... } virtual void Write(byte data){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... FileStream::Write(data);//å†™æ–‡ä»¶æµ //é¢å¤–çš„åŠ å¯†æ“ä½œ... } }; //æ‰©å±•åŠ å¯†çš„åŠŸèƒ½ ä¼ ç»Ÿæ–¹æ¡ˆæ–°å¢å¤šä¸ªç±» åˆ†åˆ«ç»§æ‰¿æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµæ“ä½œç±» class CryptoNetworkStream :public NetworkStream{ public: virtual char Read(int number){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... NetworkStream::Read(number);//è¯»ç½‘ç»œæµ } virtual void Seek(int position){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... NetworkStream::Seek(position);//å®šä½ç½‘ç»œæµ //é¢å¤–çš„åŠ å¯†æ“ä½œ... } virtual void Write(byte data){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... NetworkStream::Write(data);//å†™ç½‘ç»œæµ //é¢å¤–çš„åŠ å¯†æ“ä½œ... } }; //æ‰©å±•åŠ å¯†çš„åŠŸèƒ½ ä¼ ç»Ÿæ–¹æ¡ˆæ–°å¢å¤šä¸ªç±» åˆ†åˆ«ç»§æ‰¿æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµæ“ä½œç±» class CryptoMemoryStream : public MemoryStream{ public: virtual char Read(int number){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... MemoryStream::Read(number);//è¯»å†…å­˜æµ } virtual void Seek(int position){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... MemoryStream::Seek(position);//å®šä½å†…å­˜æµ //é¢å¤–çš„åŠ å¯†æ“ä½œ... } virtual void Write(byte data){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... MemoryStream::Write(data);//å†™å†…å­˜æµ //é¢å¤–çš„åŠ å¯†æ“ä½œ... } }; //æ‰©å±•ç¼“å­˜çš„åŠŸèƒ½ ä¼ ç»Ÿæ–¹æ¡ˆæ–°å¢å¤šä¸ªç±» åˆ†åˆ«ç»§æ‰¿æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµæ“ä½œç±» class BufferedFileStream : public FileStream{ //é¢å¤–çš„ç¼“å­˜æ“ä½œ... è·Ÿç½‘ç»œæµã€å†…å­˜æµä»£ç å­˜åœ¨å¤§é‡é‡å¤ }; class BufferedNetworkStream : public NetworkStream{ //... }; class BufferedMemoryStream : public MemoryStream{ //... } //æ‰©å±•åŠ å¯†+ç¼“å­˜ç»„åˆçš„çš„åŠŸèƒ½ ä¼ ç»Ÿæ–¹æ¡ˆæ–°å¢å¤šä¸ªç±» åˆ†åˆ«ç»§æ‰¿æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµæ“ä½œç±» class CryptoBufferedFileStream :public FileStream{ public: virtual char Read(int number){ //ä»£ç å¤§é‡é‡å¤ ç”Ÿæˆå¤§é‡å­ç±» æ‰©å±•ä¸€ä¸ªåŠŸèƒ½éå¸¸ä¸çµæ´»ï¼Œå¢åŠ ç»´æŠ¤æˆæœ¬ FileStream::Read(number);//è¯»æ–‡ä»¶æµ } virtual void Seek(int position){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... //é¢å¤–çš„ç¼“å†²æ“ä½œ... FileStream::Seek(position);//å®šä½æ–‡ä»¶æµ //é¢å¤–çš„åŠ å¯†æ“ä½œ... //é¢å¤–çš„ç¼“å†²æ“ä½œ... } virtual void Write(byte data){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... //é¢å¤–çš„ç¼“å†²æ“ä½œ... FileStream::Write(data);//å†™æ–‡ä»¶æµ //é¢å¤–çš„åŠ å¯†æ“ä½œ... //é¢å¤–çš„ç¼“å†²æ“ä½œ... } }; void Process(){ //ç¼–è¯‘æ—¶è£…é… ä¹Ÿå°±æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™å·²ç»å†³å®šäº†è¦ä½¿ç”¨å“ªç§æ‰©å±•åŠŸèƒ½å¯¹åº”çš„å­ç±» CryptoFileStream *fs1 = new CryptoFileStream(); BufferedFileStream *fs2 = new BufferedFileStream(); CryptoBufferedFileStream *fs3 =new CryptoBufferedFileStream(); } åŠ¨æœº æ»¥ç”¨ç»§æ‰¿æ¥æ‰©å±•å¯¹è±¡çš„åŠŸèƒ½ï¼Œç”±äºç»§æ‰¿ä¸ºç±»å‹å¼•å…¥çš„é™æ€ç‰¹è´¨ï¼Œå¯¼è‡´è¿™ç§æ‰©å±•æ–¹å¼å˜å¾—éå¸¸ä¸çµæ´»ï¼Œè€Œä¸”å¦‚æœæ‰©å±•çš„åŠŸèƒ½å¾ˆå¤šæˆ–è€…éœ€è¦ç»„åˆï¼Œå°†ä¼šäº§ç”Ÿå¤§é‡çš„å­ç±»ï¼Œå¯¹é¡¹ç›®çš„ç»´æŠ¤æˆæœ¬å¤§å¹…åº¦å¢åŠ ã€‚ æ¨¡å¼çš„å®šä¹‰ ä¸ä½¿ç”¨ç»§æ‰¿ï¼Œæ”¹ç”¨ç»„åˆçš„æ–¹å¼åŠ¨æ€çš„ç»™å¯¹è±¡å¢åŠ ä¸€äº›æ‰©å±•åŠŸèƒ½ã€‚å¯¹äºæ–°å¢æ‰©å±•åŠŸèƒ½è€Œè¨€ï¼ŒDecoratorè£…é¥°æ¨¡å¼æ¯”æ»¥ç”¨ç»§æ‰¿çš„æ–¹å¼æ›´åŠ çµæ´»(å› ä¸ºå¯ä»¥æ¶ˆé™¤å¤§é‡çš„é‡å¤ä»£ç åŒæ—¶å‡å°‘å­ç±»çš„æ•°é‡ï¼Œå‡å°‘ç»´æŠ¤çš„æˆæœ¬) ç»“æ„å›¾è§£ è¦ç‚¹æ€»ç»“ é‡‡ç”¨ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿çš„æ–¹å¼ï¼ŒDecoratorè£…é¥°æ¨¡å¼å®ç°äº†åœ¨è¿è¡Œæ—¶åŠ¨æ€æ‰©å±•å¯¹è±¡åŠŸèƒ½çš„èƒ½åŠ›ï¼Œè€Œä¸”å¯ä»¥æ ¹æ®éœ€è¦æ‰©å±•å¤šä¸ªåŠŸèƒ½ï¼Œé¿å…äº†å¤§é‡çš„é‡å¤ä»£ç ï¼ŒåŒæ—¶å¤§é‡çš„å­ç±»äº§ç”Ÿçš„é—®é¢˜ è£…é¥°ç±»åœ¨æ¥å£ä¸Šå˜ç°ä¸ºis-aå…³ç³»ï¼Œä¹Ÿå°±æ˜¯ç»§æ‰¿ä¸šåŠ¡æ“ä½œç»„ä»¶åŸºç±»ï¼Œä½†åœ¨å®ç°ä¸Šåˆæ˜¯has-aç»„åˆçš„å…³ç³»ï¼Œæˆå‘˜æ‹¥æœ‰ä¸šåŠ¡æ“ä½œç»„ä»¶åŸºç±»æŒ‡é’ˆï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€çš„ä¼ å…¥ä¸åŒç±»åˆ«çš„ä¸šåŠ¡æ“ä½œå­ç±»ï¼Œæ¥å®ç°ç›¸åº”æ“ä½œï¼ŒåŒæ—¶æ‰©å±•åŠŸèƒ½ Decoratorè£…é¥°æ¨¡å¼çš„ç›®çš„å¹¶ä¸æ˜¯è§£å†³â€œå¤šå­ç±»è¡ç”Ÿçš„å¤šç»§æ‰¿é—®é¢˜â€ï¼Œé‡è¦æ˜¯åœ¨è§£å†³â€œä¸»ä½“ç±»åœ¨å¤šä¸ªæ–¹å‘ä¸Šçš„æ‰©å±•é—®é¢˜â€ ç®€æ˜“ä»£ç  //ä¸šåŠ¡æ“ä½œ class Stream{//æµæ“ä½œåŸºç±»ï¼Œå®šä¹‰ç›¸å…³æ¥å£è™šå‡½æ•° publicï¼š virtual char Read(int number)=0; virtual void Seek(int position)=0; virtual void Write(char data)=0; virtual ~Stream(){} }; //æ–‡ä»¶æµæ“ä½œä¸»ä½“ç±» åº”è¯¥ç»§æ‰¿StreamåŸºç±» class FileStream: public Stream{ public: virtual char Read(int number){ //è¯»æ–‡ä»¶æµ } virtual void Seek(int position){ //å®šä½æ–‡ä»¶æµ } virtual void Write(char data){ //å†™æ–‡ä»¶æµ } }; //ç½‘ç»œæµæ“ä½œç±» åº”è¯¥ç»§æ‰¿StreamåŸºç±» class NetworkStream :public Stream{ public: virtual char Read(int number){ //è¯»ç½‘ç»œæµ } virtual void Seek(int position){ //å®šä½ç½‘ç»œæµ } virtual void Write(char data){ //å†™ç½‘ç»œæµ } }; //å†…å­˜æµæ“ä½œç±» åº”è¯¥ç»§æ‰¿StreamåŸºç±» class MemoryStream :public Stream{ public: virtual char Read(int number){ //è¯»å†…å­˜æµ } virtual void Seek(int position){ //å®šä½å†…å­˜æµ } virtual void Write(char data){ //å†™å†…å­˜æµ } }; //æ‰©å±•åŠŸèƒ½è£…é¥°åŸºç±» DecoratorStream: public Stream{//ç»§æ‰¿ä¸šåŠ¡ç»„ä»¶æ“ä½œåŸºç±» ä¸»è¦æ˜¯ç”¨äºå®ç°ç›¸å…³æ¥å£ protected: Stream* stream;//ä¿å­˜ä¸šåŠ¡ç»„ä»¶æ“ä½œåŸºç±»æŒ‡é’ˆï¼Œè¿è¡Œæ—¶åŠ¨æ€çš„ä¼ å…¥ç›¸åº”çš„ä¸šåŠ¡æ“ä½œä¸»ä½“å­ç±»å®ç°ç›¸å…³æ“ä½œå¹¶æ‰©å±•åŠŸèƒ½ DecoratorStream(Stream * stm):stream(stm){ } }; //åŠ å¯†æ‰©å±•åŠŸèƒ½ class CryptoStream: public DecoratorStream {//ç»§æ‰¿è£…é¥°åŸºç±» public: CryptoStream(Stream* stm):DecoratorStream(stm){ } virtual char Read(int number){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... stream-\u003eRead(number);//è¿™é‡Œä¼šå¤šæ€çš„è°ƒç”¨ä¸åŒçš„æµæ“ä½œ(æ–‡ä»¶ã€ç½‘ç»œã€å†…å­˜) æ²¡æœ‰é‡å¤ä»£ç  } virtual void Seek(int position){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... stream::Seek(position);//è¿™é‡Œä¼šå¤šæ€çš„è°ƒç”¨ä¸åŒçš„æµæ“ä½œ(æ–‡ä»¶ã€ç½‘ç»œã€å†…å­˜)æ²¡æœ‰é‡å¤ä»£ç  //é¢å¤–çš„åŠ å¯†æ“ä½œ... } virtual void Write(byte data){ //é¢å¤–çš„åŠ å¯†æ“ä½œ... stream::Write(data);//è¿™é‡Œä¼šå¤šæ€çš„è°ƒç”¨ä¸åŒçš„æµæ“ä½œ(æ–‡ä»¶ã€ç½‘ç»œã€å†…å­˜)æ²¡æœ‰é‡å¤ä»£ç  //é¢å¤–çš„åŠ å¯†æ“ä½œ... } }; //ä¸åŒæµæ“ä½œå¢åŠ ç¼“å­˜åŠŸèƒ½ è·Ÿå¢åŠ åŠ å¯†åŠŸèƒ½ä¸€æ · åªç”Ÿæˆäº†ä¸€ä¸ªç±» åŒæ—¶åœ¨è¿è¡Œæ—¶å¤šæ€çš„è°ƒç”¨ä¸åŒçš„æµæ“ä½œ(æ–‡ä»¶ã€ç½‘ç»œã€å†…å­˜)æ²¡æœ‰é‡å¤ä»£ç  class BufferedStream : public DecoratorStream{ Stream* stream;//... public: BufferedStream(Stream* stm):DecoratorStream(stm){ } //... }; void Process(){ //è¿è¡Œæ—¶è£…é… FileStream* s1=new FileStream(); //è¿™é‡Œs1å¯ä»¥åŠ¨æ€çš„ä¼ å…¥æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµï¼Œæ¥å®ç°ä¸åŒç±»åˆ«æµæ“ä½œçš„åŠ å¯†æ‰©å±• CryptoStream* s2=new CryptoStream(s1); //è¿™é‡Œs1å¯ä»¥åŠ¨æ€çš„ä¼ å…¥æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµï¼Œæ¥å®ç°ä¸åŒç±»åˆ«æµæ“ä½œçš„ç¼“å­˜æ‰©å±• BufferedStream* s3=new BufferedStream(s1); //è¿™é‡Œs2å¯ä»¥åŠ¨æ€çš„ä¼ å…¥æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµï¼Œæ¥å®ç°ä¸åŒç±»åˆ«æµæ“ä½œçš„åŠ å¯†ç¼“å­˜æ‰©å±• BufferedStream* s4=new BufferedStream(s2); } æ¡¥æ¨¡å¼Bridgeâ€”å•ä¸€èŒè´£ éœ€æ±‚èƒŒæ™¯ éœ€è¦å®ç°å¤šå¹³å°(pcã€mobileã€padï¼Œtv)ç­‰ç­‰ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªçº¬åº¦ï¼ŒåŒæ—¶ä¹Ÿè¦å‘å¸ƒä¸€ä¸ªç»å…¸è½»é‡ç‰ˆæœ¬å’Œå®Œç¾å¤æ‚ç‰ˆæœ¬(æ¯”å¦‚å‘æ–‡å­—æ¶ˆæ¯çš„æ—¶å€™ä¹Ÿæ’­æ”¾å£°éŸ³)ï¼Œè¿™åˆæ˜¯ä¸€ä¸ªçº¬åº¦çš„å˜åŒ– ä¸‹é¢çœ‹çœ‹ç»å…¸çš„å®ç°\nä¼ ç»Ÿå®ç° class Messager{ public: //ä¸‹é¢æ˜¯ä¸‰ä¸ªé€šç”¨æ¥å£æ–¹æ³• virtual void Login(string username, string password)=0; virtual void SendMessage(string message)=0; virtual void SendPicture(Image image)=0; //ä¸‹é¢æ˜¯æ¶‰åŠä¸åŒçš„å¹³å°éœ€è¦å®ç°ä¸åŒçš„æ–¹æ³• PlaySoundæ–¹æ³•åªæœ‰å®Œç¾ç‰ˆç”¨åˆ° virtual void PlaySound()=0; virtual void DrawShape()=0; virtual void WriteText()=0; virtual void Connect()=0; virtual ~Messager(){} }; //PCå¹³å°å®ç° class PCMessagerBase : public Messager{ public: virtual void PlaySound(){ //********** } virtual void DrawShape(){ //********** } virtual void WriteText(){ //********** } virtual void Connect(){ //********** } }; //æ‰‹æœºå¹³å°å®ç° class MobileMessagerBase : public Messager{ public: virtual void PlaySound(){ //========== } virtual void DrawShape(){ //========== } virtual void WriteText(){ //========== } virtual void Connect(){ //========== } }; //ä¸šåŠ¡æŠ½è±¡ ç»å…¸è½»é‡å‘å¸ƒç‰ˆæœ¬ æœ¬èº«æ˜¯ä¸šåŠ¡æŠ½è±¡çº¬åº¦ï¼Œä½†å› ä¸ºå¦å¤–ä¸€ä¸ªçº¬åº¦ä¹Ÿè¦å˜åŒ–(å¹³å°çº¬åº¦) æ‰€ä»¥ç»å…¸å‘å¸ƒç‰ˆæœ¬ä¹Ÿè¦æœ‰å¤šä¸ªå¹³å°ç±»çš„å®ç° class PCMessagerLite : public PCMessagerBase { public: virtual void Login(string username, string password){ PCMessagerBase::Connect(); //........ } virtual void SendMessage(string message){ PCMessagerBase::WriteText(); //........ } virtual void SendPicture(Image image){ PCMessagerBase::DrawShape(); //........ } }; //ä¸šåŠ¡æŠ½è±¡ å®Œç¾å¤æ‚ç‰ˆæœ¬ æœ¬èº«æ˜¯ä¸šåŠ¡æŠ½è±¡çº¬åº¦ï¼Œä½†å› ä¸ºå¦å¤–ä¸€ä¸ªçº¬åº¦ä¹Ÿè¦å˜åŒ–(å¹³å°çº¬åº¦) æ‰€ä»¥å®Œç¾å¤æ‚ç‰ˆæœ¬ä¹Ÿè¦æœ‰å¤šä¸ªå¹³å°ç±»çš„å®ç° class PCMessagerPerfect : public PCMessagerBase { public: virtual void Login(string username, string password){ PCMessagerBase::PlaySound(); //******** PCMessagerBase::Connect(); //........ } virtual void SendMessage(string message){ PCMessagerBase::PlaySound(); //******** PCMessagerBase::WriteText(); //........ } virtual void SendPicture(Image image){ PCMessagerBase::PlaySound(); //******** PCMessagerBase::DrawShape(); //........ } }; // class MobileMessagerLite : public MobileMessagerBase { public: virtual void Login(string username, string password){ MobileMessagerBase::Connect(); //........ } virtual void SendMessage(string message){ MobileMessagerBase::WriteText(); //........ } virtual void SendPicture(Image image){ MobileMessagerBase::DrawShape(); //........ } }; //ä¸šåŠ¡æŠ½è±¡ ç»å…¸è½»é‡å‘å¸ƒç‰ˆæœ¬ æœ¬èº«æ˜¯ä¸šåŠ¡æŠ½è±¡çº¬åº¦ï¼Œä½†å› ä¸ºå¦å¤–ä¸€ä¸ªçº¬åº¦ä¹Ÿè¦å˜åŒ–(å¹³å°çº¬åº¦) æ‰€ä»¥ç»å…¸å‘å¸ƒç‰ˆæœ¬ä¹Ÿè¦æœ‰å¤šä¸ªå¹³å°ç±»çš„å®ç° //è¿™é‡Œæ˜¯æ‰‹æœºå¹³å°å®ç° è·Ÿpcå¹³å°å­˜åœ¨å¤§é‡ç±»ä¼¼é‡å¤ä»£ç  class MobileMessagerPerfect : public MobileMessagerBase { public: virtual void Login(string username, string password){ MobileMessagerBase::PlaySound(); //******** MobileMessagerBase::Connect(); //........ } virtual void SendMessage(string message){ MobileMessagerBase::PlaySound(); //******** MobileMessagerBase::WriteText(); //........ } virtual void SendPicture(Image image){ MobileMessagerBase::PlaySound(); //******** MobileMessagerBase::DrawShape(); //........ } }; //å®é™…è°ƒç”¨ void Process(){ //ç¼–è¯‘æ—¶è£…é… éœ€è¦æŒ‡å®šä¸åŒå¹³å°çš„ä¸ç”¨ä¸šåŠ¡æŠ½è±¡ æ¯”å¦‚æ‰‹æœºå¹³å°ç»å…¸ç‰ˆæœ¬ æ‰‹æœºå¹³å°å®Œç¾ç‰ˆæœ¬ç­‰ç­‰ //æ‰€ä»¥è¿™é‡Œå¦‚æœ‰ä¸€ä¸ªçº¬åº¦å˜åŒ–--ä¸šåŠ¡æŠ½è±¡æœ‰Mä¸ª(ç»å…¸ç‰ˆæœ¬ã€å®Œç¾ç‰ˆæœ¬...),å¦å¤–ä¸€ä¸ªçº¬åº¦å˜åŒ–å¹³å°å®ç°æœ‰Nä¸ª(pcã€mobileã€padã€tv...) //é‚£ä¹ˆç±»è‡³å°‘éœ€è¦1(messager)+N(å¹³å°å®ç°åŸºç±»)+M*N(æœ€ç»ˆç”¨äºç”¨äºå‘å¸ƒçš„ç±» æ¯”å¦‚ä¸‹é¢çš„æ‰‹æœºå¹³å°å®Œç¾ç‰ˆæœ¬ç±») Messager *m =new MobileMessagerPerfect(); } åŠ¨æœº æŸäº›ç±»å‹çš„å›ºæœ‰å®ç°é€»è¾‘ï¼Œä½¿å¾—å®ƒä»¬æœ‰2ä¸ªçº¬åº¦çš„å˜åŒ–ï¼Œæˆ–è€…å¤šä¸ªçº¬åº¦çš„å˜åŒ–\næ‰€ä»¥è¦åˆ©ç”¨é¢å‘å¯¹è±¡æŠ€æœ¯ä½¿å¾—ç±»å‹å¯ä»¥è½»æ¾çš„æ²¿ç€2ä¸ªæˆ–è€…å¤šä¸ªæ–¹å‘å˜åŒ–\nå‡è®¾éœ€è¦å®ç°ä¸€ä¸ªå‘æ¶ˆæ¯çš„ä¸šåŠ¡ï¼Œå¤§è‡´æœ‰ä¸‰ä¸ªæ–¹æ³•loginç™»å½•ï¼ŒsendMessageå‘æ–‡å­—æ¶ˆæ¯ sendPictureå‘å›¾ç‰‡\næ¨¡å¼å®šä¹‰ å°†æŠ½è±¡éƒ¨åˆ†(ä¸šåŠ¡åŠŸèƒ½)ä¸å®ç°éƒ¨åˆ†(å¹³å°å®ç°)åˆ†ç¦»ï¼Œä½¿å®ƒä»¬ éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ– ç»“æ„å›¾è§£ è¦ç‚¹æ€»ç»“ Bridgeæ¨¡å¼ä½¿ç”¨â€œå¯¹è±¡é—´çš„ç»„åˆå…³ç³»â€è§£è€¦äº†æŠ½è±¡å’Œå®ç°ä¹‹é—´å›ºæœ‰çš„ç»‘å®šå…³ç³»ï¼Œä½¿å¾—æŠ½è±¡å’Œå®ç°å¯ä»¥æ²¿ç€å„è‡ªçš„ç»´åº¦æ¥å˜åŒ–ã€‚æ‰€è°“ æŠ½è±¡å’Œå®ç°æ²¿ç€å„è‡ªçº¬åº¦çš„å˜åŒ–ï¼Œå³â€œå­ç±»åŒ–â€å®ƒä»¬ã€‚\nBridgeæ¨¡å¼æœ‰æ—¶å€™ç±»ä¼¼äºå¤šç»§æ‰¿æ–¹æ¡ˆï¼Œä½†æ˜¯å¤šç»§æ‰¿æ–¹æ¡ˆå¾€å¾€è¿èƒŒ å•ä¸€èŒè´£åŸåˆ™(å³ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå˜åŒ–çš„åŸå› )ï¼Œå¤ç”¨æ€§æ¯”è¾ƒå·®ã€‚ Bridgeæ¨¡å¼æ˜¯æ¯”å¤šç»§æ‰¿æ–¹æ¡ˆæ›´å¥½çš„è§£å†³æ–¹æ³•ã€‚\nBridgeæ¨¡å¼çš„åº”ç”¨ä¸€èˆ¬åœ¨â€œä¸¤ä¸ªéå¸¸å¼ºçš„å˜åŒ–ç»´åº¦â€ï¼Œæœ‰æ—¶ä¸€ä¸ª ç±»ä¹Ÿæœ‰å¤šäºä¸¤ä¸ªçš„å˜åŒ–ç»´åº¦ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨Bridgeçš„æ‰©å±•æ¨¡å¼\nä»£ç å®ç° //ä¸šåŠ¡æŠ½è±¡åŸºç±» å®šä¹‰ç›¸å…³æ¥å£æ–¹æ³• class Messager{ protected: MessagerImp* messagerImp;//ç”¨äºå¹³å°å®ç°åŸºç±»æŒ‡é’ˆ åœ¨å¹³å°åˆ‡æ¢æ–¹é¢å¯ä»¥è¿è¡Œæ—¶çµæ´»å˜åŒ– public: virtual void Login(string username, string password)=0; virtual void SendMessage(string message)=0; virtual void SendPicture(Image image)=0; virtual ~Messager(){} }; //å¹³å°å®ç°åŸºç±» å®šä¹‰ç›¸å…³æ¥å£æ–¹æ³• class MessagerImp{ public: virtual void PlaySound()=0; virtual void DrawShape()=0; virtual void WriteText()=0; virtual void Connect()=0; virtual MessagerImp(){} }; //ä¸åŒå¹³å°å®ç°å­ç±» è¿™é‡Œæ˜¯pc class PCMessagerImp : public MessagerImp{ public: virtual void PlaySound(){ //********** } virtual void DrawShape(){ //********** } virtual void WriteText(){ //********** } virtual void Connect(){ //********** } }; //ä¸åŒå¹³å°å®ç°å­ç±» è¿™é‡Œæ˜¯mobile class MobileMessagerImp : public MessagerImp{ public: virtual void PlaySound(){ //========== } virtual void DrawShape(){ //========== } virtual void WriteText(){ //========== } virtual void Connect(){ //========== } }; //ä¸šåŠ¡æŠ½è±¡å­ç±»å®ç° è¿™é‡Œæ˜¯ç»å…¸ç‰ˆæœ¬ class MessagerLite :public Messager { public: virtual void Login(string username, string password){ messagerImp-\u003eConnect();//é€šè¿‡åŸºç±»æ‹¥æœ‰çš„å¹³å°å®ç°åŸºç±»æŒ‡é’ˆ åœ¨ä¸åŒå¹³å°é—´çµæ´»åˆ‡æ¢ //........ } virtual void SendMessage(string message){ messagerImp-\u003eWriteText(); //........ } virtual void SendPicture(Image image){ messagerImp-\u003eDrawShape(); //........ } }; //ä¸šåŠ¡æŠ½è±¡å­ç±»å®ç° è¿™é‡Œæ˜¯å®Œç¾ç‰ˆæœ¬ class MessagerPerfect :public Messager { public: virtual void Login(string username, string password){ messagerImp-\u003ePlaySound();//é€šè¿‡åŸºç±»æ‹¥æœ‰çš„å¹³å°å®ç°åŸºç±»æŒ‡é’ˆ åœ¨ä¸åŒå¹³å°é—´çµæ´»åˆ‡æ¢ //******** messagerImp-\u003eConnect(); //........ } virtual void SendMessage(string message){ messagerImp-\u003ePlaySound(); //******** messagerImp-\u003eWriteText(); //........ } virtual void SendPicture(Image image){ messagerImp-\u003ePlaySound(); //******** messagerImp-\u003eDrawShape(); //........ } }; void Process(){ //è¿è¡Œæ—¶è£…é… ç±»çš„æ•°é‡å¤§å¹…å‡å°‘ ä½†æ˜¯å®ç°å¹¶æ²¡æœ‰æ‰“æŠ˜æ‰£ï¼Œè¿™é‡Œåœ¨è¿è¡Œæ˜¯åˆå§‹åŒ–æƒ³è¦çš„å¹³å°å®ç°å­ç±»å°±å¯ä»¥åŠ¨æ€çµæ´»å˜åŒ– MessagerImp* mImp=new PCMessagerImp(); Messager *m =new MessagerPerfect(mImp);//ä¼ å…¥pcå¹³å°å­ç±» å®ç°pcå®Œç¾ç‰ˆæœ¬ } å·¥å‚æ¨¡å¼factoryâ€”å¯¹è±¡åˆ›å»º éœ€æ±‚èƒŒæ™¯ æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªæ–‡ä»¶åˆ†å‰²å™¨ï¼Œæ”¯æŒåˆ†å‰²å¤šç§ç±»å‹æ–‡ä»¶(æ–‡æœ¬æ–‡ä»¶ã€æ™®é€šäºŒè¿›åˆ¶æ–‡ä»¶ã€å›¾ç‰‡ã€è§†é¢‘ç­‰ç­‰)ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦æ ¹æ®éœ€æ±‚åˆ›å»ºå¯¹è±¡\nä¼ ç»Ÿå®ç° //æ–‡ä»¶åˆ†å‰²åŸºç±» æ–‡ä»¶åˆ†å‰²å®ç° class ISplitter{ public: virtual void split()=0; virtual ~ISplitter(){} }; //æ–‡ä»¶åˆ†å‰²å­ç±» äºŒè¿›åˆ¶æ–‡ä»¶ã€æ–‡æœ¬æ–‡ä»¶ã€å›¾ç‰‡ã€è§†é¢‘ class BinarySplitter : public ISplitter{ }; class TxtSplitter: public ISplitter{ }; class PictureSplitter: public ISplitter{ }; class VideoSplitter: public ISplitter{ }; // --------------- //é«˜å±‚è°ƒç”¨æ¨¡å— class MainForm : public Form { public: void Button1_Click(){ ISplitter * splitter=new BinarySplitter(); //ä¾èµ–å…·ä½“ç±» è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™ é«˜å±‚ç¨³å®šæ¨¡å—åº”è¯¥ä¾èµ–æŠ½è±¡è€Œä¸åº”è¯¥ä¾èµ–å…·ä½“çš„å®ç°ç±» //è¿™é‡Œçš„ä¾èµ–ä¸ºç¼–è¯‘æ—¶ä¾èµ– å…·ä½“çš„å®ç°ç±»å¯èƒ½åå¤å˜åŒ–å°±ä¼šå¯¼è‡´é«˜å±‚æ¨¡å—ä¹Ÿéœ€è¦è·Ÿç€ç¼–è¯‘ç”šè‡³ä¿®æ”¹ splitter-\u003esplit(); } }; åŠ¨æœº åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œç»å¸¸é¢ä¸´ç€åˆ›å»ºå¯¹è±¡çš„å·¥ä½œ;ç”±äºéœ€æ±‚çš„å˜åŒ–ï¼Œ éœ€è¦åˆ›å»ºçš„å¯¹è±¡çš„å…·ä½“ç±»å‹ç»å¸¸å˜åŒ– å› ä¸ºç›´æ¥newä¼šä¾èµ–å…·ä½“çš„å®ç°ç±» æ‰€ä»¥è¦æƒ³åŠæ³•ç»•è¿‡new è¿è¡Œæ—¶åŠ¨æ€çš„newå‡ºç›¸åº”çš„ç±» ä¸€èˆ¬æ˜¯æ¥å£æŠ½è±¡ä¹‹åçš„ç¬¬ä¸€æ­¥å·¥ä½œ æ¨¡å¼å®šä¹‰ å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚ Factory Methodä½¿å¾—ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿ(ç›®çš„:è§£è€¦ï¼Œ æ‰‹æ®µ:è™šå‡½æ•°)åˆ°å­ç±» å·¥å‚æ¨¡å¼ä»£ç å®ç° //ä¸šåŠ¡æŠ½è±¡åŸºç±» ä¸å·¥å‚æŠ½è±¡åŸºç±»å¯ä»¥æ”¾åœ¨ä¸€èµ· class ISplitter{ public: virtual void split()=0; virtual ~ISplitter(){} }; //å·¥å‚æŠ½è±¡åŸºç±» class SplitterFactory{ public: virtual ISplitter* CreateSplitter()=0; virtual ~SplitterFactory(){} }; //------------------------------ //é«˜å±‚è°ƒç”¨æ¨¡å— class MainForm : public Form { SplitterFactory* factory;//å·¥å‚æŠ½è±¡åŸºç±» public: MainForm(SplitterFactory* factory){//é€šè¿‡æ„é€ æ–¹æ³• è®©æ›´é«˜å±‚å®é™…ä½¿ç”¨è€… ä¼ å…¥å…·ä½“çš„å·¥å‚å­ç±» this-\u003efactory=factory; } void Button1_Click(){ ISplitter * splitter= factory-\u003eCreateSplitter(); //å¤šæ€new é€šè¿‡å…·ä½“çš„å·¥å‚å­ç±»å®ä¾‹åŒ–å…·ä½“çš„ä¸šåŠ¡å­ç±» è¿™é‡Œä¸å†ä¾èµ–å…·ä½“çš„ä¸šåŠ¡å­ç±» ä¾èµ–çš„æ˜¯å·¥å‚åŸºç±» å…·ä½“çš„å·¥å‚å­ç±»å˜åŒ–æˆ–è€…ä¸šåŠ¡å¤„ç†å­ç±»å˜åŒ–å¯¹è¿™ä¸ªç±»æ²¡æœ‰ç¼–è¯‘æ—¶çš„å½±å“ï¼Œç›¸å¯¹ç¨³å®šï¼Œå˜åŒ–å°‘ä¸€èˆ¬é—®é¢˜ä¹Ÿå°‘ï¼Œæœ‰å˜åŒ–å°±å¸¦æ¥äº†æµ‹è¯•å·¥ä½œé‡ splitter-\u003esplit(); } }; //------------------------------------- //å…·ä½“å®ç°ç±»å’Œå·¥å‚å­ç±»æ”¾åˆ°åŒä¸€ä¸ªæ–‡ä»¶ class BinarySplitter : public ISplitter{ }; class TxtSplitter: public ISplitter{ }; class PictureSplitter: public ISplitter{ }; class VideoSplitter: public ISplitter{ }; //å…·ä½“å·¥å‚å­ç±» è´Ÿè´£åˆ›å»ºå…·ä½“çš„ä¸šåŠ¡å¤„ç†å­ç±» class BinarySplitterFactory: public SplitterFactory{ public: virtual ISplitter* CreateSplitter(){ return new BinarySplitter(); } }; class TxtSplitterFactory: public SplitterFactory{ public: virtual ISplitter* CreateSplitter(){ return new TxtSplitter(); } }; class PictureSplitterFactory: public SplitterFactory{ public: virtual ISplitter* CreateSplitter(){ return new PictureSplitter(); } }; class VideoSplitterFactory: public SplitterFactory{ public: virtual ISplitter* CreateSplitter(){ return new VideoSplitter(); } }; ç»“æ„å›¾è§£ è¦ç‚¹æ€»ç»“ Factory Methodæ¨¡å¼ç”¨äºéš”ç¦»ç±»å¯¹è±¡çš„ä½¿ç”¨è€…å’Œå…·ä½“ç±»å‹ä¹‹é—´çš„ è€¦åˆå…³ç³»ã€‚é¢å¯¹ä¸€ä¸ªç»å¸¸å˜åŒ–çš„å…·ä½“ç±»å‹ï¼Œç´§è€¦åˆå…³ç³»(new)ä¼šå¯¼ è‡´è½¯ä»¶çš„è„†å¼±ã€‚\nFactory Methodæ¨¡å¼é€šè¿‡é¢å‘å¯¹è±¡çš„æ‰‹æ³•ï¼Œå°†æ‰€è¦åˆ›å»ºçš„å…·ä½“å¯¹ è±¡å·¥ä½œå»¶è¿Ÿåˆ°å­ç±»ï¼Œä»è€Œå®ç°ä¸€ç§æ‰©å±•(è€Œéæ›´æ”¹)çš„ç­–ç•¥ï¼Œè¾ƒå¥½ åœ°è§£å†³äº†è¿™ç§ç´§è€¦åˆå…³ç³»ï¼Œåªéœ€è¦å¢åŠ ç›¸åº”çš„ä¸šåŠ¡å­ç±»å’Œå¯¹åº”çš„å·¥å‚å­ç±» ä½¿ç”¨è€…MainFromæ— éœ€æ›´æ”¹\nFactory Methodæ¨¡å¼è§£å†³â€œå•ä¸ªå¯¹è±¡â€çš„éœ€æ±‚å˜åŒ–ã€‚ç¼ºç‚¹åœ¨äºè¦ æ±‚åˆ›å»ºæ–¹æ³•/å‚æ•°ç›¸åŒã€‚\næŠ½è±¡å·¥å‚AbstractFactoryâ€”å¯¹è±¡åˆ›å»º éœ€æ±‚èƒŒæ™¯ éœ€è¦å†™ä¸€ä¸ªDaoæ•°æ®è®¿é—®å±‚ï¼Œåˆšå¼€å§‹åªæœ‰oracleï¼Œåé¢è¦æ”¯æŒmysqlï¼Œsqlserver db2ç­‰ç­‰,æ¯ä¸ªæ•°æ®åº“ç³»åˆ—éƒ½æœ‰ç›¸å…³çš„å¤šä¸ªå¯¹è±¡(connectionã€commandã€dataReaderâ€¦)ï¼Œè¿™äº›å¯¹è±¡æ—¶ç›¸å…³çš„ï¼Œæœ‰ä¾èµ–çš„ï¼Œä¸èƒ½ä¼ ä¸€ä¸ªoracleçš„connectionç»™mysqlçš„command\nä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ class EmployeeDAO{ public: vector\u003cEmployeeDO\u003e GetEmployees(){ //åˆšå¼€å§‹åªæœ‰ä¸€ç§æ•°æ®åº“ åé¢å¯èƒ½è¦æ–°å¢å…¶å®ƒæ•°æ®åº“ æ‰€ä»¥è¿™é‡Œå¯èƒ½ä¼šå†™æˆif elseæ¥åˆ›å»ºå¯¹è±¡ ç»™ä¸ªå…¥å‚æ¥åˆ¤æ–­ä¸åŒçš„ç±»å‹ //è¿™å°±æ˜¯ä¾èµ–äº†åº•å±‚å…·ä½“çš„å¯¹è±¡ è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™DIP åº”è¯¥ä¾èµ–æŠ½è±¡ SqlConnection* connection = new SqlConnection(); connection-\u003eConnectionString = \"...\"; SqlCommand* command = new SqlCommand(); command-\u003eCommandText=\"...\"; command-\u003eSetConnection(connection); SqlDataReader* reader = command-\u003eExecuteReader(); while (reader-\u003eRead()){ } } }; ç”¨åŸå§‹å·¥å‚æ–¹æ³•æ¨¡å¼æ”¹é€  //æ•°æ®åº“è®¿é—®æœ‰å…³çš„åŸºç±» class IDBConnection{ }; class IDBConnectionFactory{ public: virtual IDBConnection* CreateDBConnection()=0; }; class IDBCommand{ }; class IDBCommandFactory{ public: virtual IDBCommand* CreateDBCommand()=0; }; class IDataReader{ }; class IDataReaderFactory{ public: virtual IDataReader* CreateDataReader()=0; }; //æ”¯æŒSQL Server class SqlConnection: public IDBConnection{ }; class SqlConnectionFactory:public IDBConnectionFactory{ }; class SqlCommand: public IDBCommand{ }; class SqlCommandFactory:public IDBCommandFactory{ }; class SqlDataReader: public IDataReader{ }; class SqlDataReaderFactory:public IDataReaderFactory{ }; //æ”¯æŒOracle class OracleConnection: public IDBConnection{ }; class OracleCommand: public IDBCommand{ }; class OracleDataReader: public IDataReader{ }; //å¦‚æœç³»åˆ—å¯¹è±¡(æœ‰ç›¸å…³æ€§çš„å¤šä¸ªå¯¹è±¡)æœ‰3ä¸ª ä½¿ç”¨è€…å°±æ‹¥æœ‰3ä¸ªå¯¹åº”çš„å·¥å‚åŸºç±»å¯¹è±¡æŒ‡é’ˆ class EmployeeDAO{ IDBConnectionFactory* dbConnectionFactory; IDBCommandFactory* dbCommandFactory; IDataReaderFactory* dataReaderFactory; public: vector\u003cEmployeeDO\u003e GetEmployees(){ IDBConnection* connection = dbConnectionFactory-\u003eCreateDBConnection(); connection-\u003eConnectionString(\"...\"); IDBCommand* command = dbCommandFactory-\u003eCreateDBCommand(); command-\u003eCommandText(\"...\"); command-\u003eSetConnection(connection); //å…³è”æ€§ //è¿™é‡Œæ²¡æ³•ä¿è¯ä¼ ç»™oracleçš„commandçš„connectionæ˜¯mysqlç±»å‹çš„å·¥å‚åˆå§‹åŒ–çš„ è¿™ä¸ªæ—¶å€™å°±ä¼šå‡ºç°é”™è¯¯ IDBDataReader* reader = command-\u003eExecuteReader(); //å…³è”æ€§ while (reader-\u003eRead()){ } } }; å› ä¸ºç³»åˆ—å¯¹è±¡å½¼æ­¤é—´æœ‰ç›¸å…³æ€§ï¼Œä¼šäº§ç”Ÿä¾èµ–ï¼Œæ‰€ä»¥ç›´æ¥å¤šä¸ªå·¥å‚åŸºç±»çš„æ–¹æ³•ï¼Œæ— æ³•å»ºç«‹å…¶ç›¸å…³æ€§ï¼Œæ‹¿è¿™é‡Œçš„ä¾‹å­æ¥è¯´ï¼Œæ³•ä¿è¯ä¼ ç»™oracleçš„commandçš„connectionæ˜¯mysqlç±»å‹çš„å·¥å‚åˆå§‹åŒ–çš„ è¿™ä¸ªæ—¶å€™å°±ä¼šå‡ºç°é”™è¯¯ã€‚\nåŠ¨æœº åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œç»å¸¸é¢ä¸´ç€â€œä¸€ç³»åˆ—ç›¸äº’ä¾èµ–çš„å¯¹è±¡â€çš„åˆ›å»ºå·¥ ä½œ;åŒæ—¶ï¼Œç”±äºéœ€æ±‚çš„å˜åŒ–ï¼Œå¾€å¾€å­˜åœ¨æ›´å¤šç³»åˆ—å¯¹è±¡çš„åˆ›å»ºå·¥ä½œ æ¨¡å¼å®šä¹‰ ä¾›ä¸€ä¸ªæ¥å£ï¼Œè®©è¯¥æ¥å£è´Ÿè´£åˆ›å»ºä¸€ç³»åˆ—â€œç›¸å…³æˆ–è€…ç›¸äº’ä¾ èµ–çš„å¯¹è±¡â€ï¼Œæ— éœ€æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±» ç»“æ„å›¾è§£ è¦ç‚¹æ€»ç»“ å¦‚æœæ²¡æœ‰åº”å¯¹â€œå¤šç³»åˆ—å¯¹è±¡æ„å»ºâ€çš„éœ€æ±‚å˜åŒ–ï¼Œåˆ™æ²¡æœ‰å¿…è¦ä½¿ç”¨ Abstract Factoryæ¨¡å¼ï¼Œè¿™æ—¶å€™ä½¿ç”¨ç®€å•çš„å·¥å‚å®Œå…¨å¯ä»¥ã€‚\nâ€œç³»åˆ—å¯¹è±¡â€æŒ‡çš„æ˜¯åœ¨æŸä¸€ç‰¹å®šç³»åˆ—ä¸‹çš„å¯¹è±¡ä¹‹é—´æœ‰ç›¸äº’ä¾èµ–ã€ æˆ–ä½œç”¨çš„å…³ç³»ã€‚ä¸åŒç³»åˆ—çš„å¯¹è±¡ä¹‹é—´ä¸èƒ½ç›¸äº’ä¾èµ–ã€‚\nAbstract Factoryæ¨¡å¼ä¸»è¦åœ¨äºåº”å¯¹â€œæ–°ç³»åˆ—â€çš„éœ€æ±‚å˜åŠ¨ã€‚å…¶ç¼º ç‚¹åœ¨äºéš¾ä»¥åº”å¯¹â€œæ–°å¯¹è±¡â€çš„éœ€æ±‚å˜åŠ¨\nä»£ç å®ç° //æ•°æ®åº“è®¿é—®æœ‰å…³çš„åŸºç±» class IDBConnection{ }; class IDBCommand{ }; class IDataReader{ }; //æ”¯æŒSQL Server class SqlConnection: public IDBConnection{ }; class SqlCommand: public IDBCommand{ }; class SqlDataReader: public IDataReader{ }; class SqlDBFactory:public IDBFactory{ public: virtual IDBConnection* CreateDBConnection()=0; virtual IDBCommand* CreateDBCommand()=0; virtual IDataReader* CreateDataReader()=0; }; class IDBFactory{ public: virtual IDBConnection* CreateDBConnection()=0; virtual IDBCommand* CreateDBCommand()=0; virtual IDataReader* CreateDataReader()=0; }; //æ”¯æŒOracle ç±»ä¼¼æ“ä½œ å¢åŠ ç›¸å…³ç±»å³å¯ class OracleConnection: public IDBConnection{ }; class OracleCommand: public IDBCommand{ }; class OracleDataReader: public IDataReader{ }; class EmployeeDAO{ IDBFactory* dbFactory; public: vector\u003cEmployeeDO\u003e GetEmployees(){ IDBConnection* connection = dbFactory-\u003eCreateDBConnection(); connection-\u003eConnectionString(\"...\"); IDBCommand* command = dbFactory-\u003eCreateDBCommand(); command-\u003eCommandText(\"...\"); command-\u003eSetConnection(connection); //å…³è”æ€§è§£å†³äº†å¤šå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³» å› ä¸ºæ˜¯åŒä¸€ä¸ªå·¥å‚åˆ›å»ºçš„ IDBDataReader* reader = command-\u003eExecuteReader(); //å…³è”æ€§ while (reader-\u003eRead()){ } } }; åŸå‹æ¨¡å¼ prototypeâ€”å¯¹è±¡åˆ›å»º éœ€æ±‚èƒŒæ™¯åŠåŠ¨æœº â€‹\tå¦‚æœéœ€è¦åˆå§‹åŒ–ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åˆšå¼€å§‹åˆå§‹åŒ–çš„çŠ¶æ€ä¸æ˜¯ä½ æƒ³è¦çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™ç”¨åŸå§‹å·¥å‚æ¨¡å¼åˆå§‹åŒ–å°±æ¯”è¾ƒå°´å°¬äº†ï¼Œæˆ–è€…æ›´ç›´ç™½çš„è¯´å°±æ˜¯éœ€è¦ä¸€ä¸ªå¯¹è±¡è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œè¾¾åˆ°äº†æŸç§çŠ¶æ€åï¼Œæˆ‘æ‰è¦è¿™ä¸ªå¯¹è±¡å»åšä¸€äº›å¤„ç†ï¼Œå°±å¯ä»¥ç”¨åŸå‹æ¨¡å¼ï¼Œç”¨æ‹·è´å¯¹è±¡çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚\nâ€‹\tå¦‚æœåˆ›å»ºå¯¹è±¡åªæ˜¯éå¸¸ç®€å•åŸå§‹çš„newå³å¯ï¼Œé‚£åŸå§‹å·¥å‚æ¨¡å¼è¶³å¤Ÿäº†ï¼Œå¦‚æœåœ¨æœ€å¼€å§‹å¾ˆéš¾åˆ›å»ºå‡ºæ¥æˆ–è€…ä½ å¸Œæœ›å¯¹è±¡è¿è¡Œåˆ°ä¸€å®šçŠ¶æ€åè¦ä¿ç•™è¿™ä¸ªçŠ¶æ€å°±å¯ä»¥è€ƒè™‘åŸå‹æ¨¡å¼\næ¨¡å¼å®šä¹‰ ä½¿ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œç„¶åé€šè¿‡æ‹·è´è¿™äº›åŸå‹æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œè¾¾åˆ°ä¿å­˜æŸç§çŠ¶æ€çš„ç›®çš„ã€‚\næ˜¯ä¸“é—¨ç”¨æ¥åˆå§‹åŒ–ç›¸å¯¹å¾ˆå¤æ‚çš„å¯¹è±¡çš„æ—¶å€™ç”¨çš„ï¼Œæ˜¯å·¥å‚æ¨¡å¼çš„å˜å½¢ã€‚\nç°å®é¡¹ç›®ç”¨çš„ä¸å¤š\nç»“æ„å›¾è§£ è¦ç‚¹æ€»ç»“ åŒæ ·ç”¨äºéš”ç¦»ç±»å¯¹è±¡çš„ä½¿ç”¨è€…å’Œå…·ä½“ç±»å‹(æ˜“å˜ç±»)ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼ŒåŒæ ·è¦æ±‚è¿™äº›â€œæ˜“å˜ç±»â€æ‹¥æœ‰â€œç¨³å®šçš„æ¥å£â€ ä½¿ç”¨åŸå‹å…‹éš†çš„æ–¹æ³•æ¥å®ç°åˆ›å»ºä¸€ä¸ªåŒ…å«æœ‰ä¸­é—´çŠ¶æ€çš„å¯¹è±¡ Cloneæ–¹æ³•è¦æ˜¯æ·±æ‹·è´ c++å¯ä»¥ç”¨æ‹·è´æ„é€ å‡½æ•°å®ç° ä»£ç å®ç° å¯¹æ¯”å·¥å‚æ¨¡å¼çœ‹ //åŸå‹åŸºç±»åŒ…å«å…‹éš†å…·ä½“å­ç±»çš„è™šå‡½æ•° ä¹ŸåŒ…æ‹¬å…¶å®ƒä¸€äº›ä¸šåŠ¡å‡½æ•° class ISplitter{ public: virtual void split()=0;//å®é™…ä¸šåŠ¡è™šå‡½æ•° virtual ISplitter* clone()=0; //é€šè¿‡å…‹éš†è‡ªå·±æ¥åˆ›å»ºå¯¹è±¡ virtual ~ISplitter(){} }; //å…·ä½“çš„ä¸šåŠ¡å­ç±» ç»§æ‰¿åŸå‹åŸºç±» è¦å®ç°cloneè‡ªå·±çš„è™šå‡½æ•° class BinarySplitter : public ISplitter{ public: virtual ISplitter* clone(){ return new BinarySplitter(*this); } }; class TxtSplitter: public ISplitter{ public: virtual ISplitter* clone(){ return new TxtSplitter(*this); } }; class PictureSplitter: public ISplitter{ public: virtual ISplitter* clone(){ return new PictureSplitter(*this); } }; class VideoSplitter: public ISplitter{ public: virtual ISplitter* clone(){ return new VideoSplitter(*this); } }; //ä½¿ç”¨è€…----------------- class MainForm : public Form{ ISplitter* prototype;//åŸå‹åŸºç±»æŒ‡é’ˆ public: MainForm(ISplitter* prototype){ this-\u003eprototype=prototype;//ä¼ å…¥å«æœ‰ä¸­é—´çŠ¶æ€çš„å­ç±»å¯¹è±¡(æˆ–è€…æœ¬èº«å¾ˆéš¾åˆå§‹åŒ–å®Œå…¨) } void Button1_Click(){ ISplitter * splitter= prototype-\u003eclone(); //å…‹éš†åŸå‹ æ·±æ‹·è´ä¸€ä¸ªå·²ç»è¿è¡Œäº†ä¸€æ®µæ—¶é—´çš„å¯¹è±¡ ä¿å­˜å…¶ä¸­é—´çŠ¶æ€ splitter-\u003esplit(); } }; æ„å»ºå™¨æ¨¡å¼Builderâ€”å¯¹è±¡åˆ›å»º éœ€æ±‚èƒŒæ™¯ //æ”¯æŒå»ºä¸åŒæˆ¿å­ éƒ½éœ€è¦å‡ ä¸ªå…±åŒçš„æ­¥éª¤ï¼Œä½†æ˜¯ä¸åŒæˆ¿å­æ¯ä¸ªæ­¥éª¤å®ç°ä¸ä¸€æ ·\n//æˆ‘ä»¬å¯ä»¥å°†è¿™äº›ç¨³å®šçš„æ­¥éª¤æŠ½è±¡å‡ºæ¥ï¼Œä¸‹é¢çš„initå‡½æ•°å°±æ˜¯è¿™æ ·\nä¼ ç»Ÿå®ç° //æ”¯æŒå»ºä¸åŒæˆ¿å­ éƒ½éœ€è¦å‡ ä¸ªå…±åŒçš„æ­¥éª¤ï¼Œä½†æ˜¯ä¸åŒæˆ¿å­æ¯ä¸ªæ­¥éª¤å®ç°ä¸ä¸€æ · //æˆ‘ä»¬å¯ä»¥å°†è¿™äº›ç¨³å®šçš„æ­¥éª¤æŠ½è±¡å‡ºæ¥ï¼Œä¸‹é¢çš„initå‡½æ•°å°±æ˜¯è¿™æ · class House{ public: void init(){ this-\u003eBuildPart1(); for (int i = 0; i \u003c 4; i++){ this-\u003eBuildPart2(); } bool flag=this-\u003eBuildPart3(); if(flag){ this-\u003eBuildPart4(); } this-\u003eBuildPart5(); } virtual ~House(){} protected: virtual void BuildPart1()=0; virtual void BuildPart2()=0; virtual bool BuildPart3()=0; virtual void BuildPart4()=0; virtual void BuildPart5()=0; //.... }; // å»ºé€ çŸ³å¤´æˆ¿å­ override5ä¸ªå»ºé€ æˆ¿å­çš„æ­¥éª¤ class StoneHouse: public House{ protected: virtual void BuildPart1(){} virtual void BuildPart2(){} virtual bool BuildPart3(){} virtual void BuildPart4(){} virtual void BuildPart5(){} }; int main(){ House *p=new StoneHouse(); p-\u003einit(); //pçš„å…¶å®ƒæ“ä½œ } ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆï¼Œå°†æ„å»ºæˆ¿å­çš„æ–¹æ³•éƒ½å†™åˆ°æˆ¿å­ç±»æœ¬èº«ä¸­ï¼Œå¦‚æœæ„å»ºæˆ¿å­çš„æ–¹æ³•ç»å¸¸æ”¹å˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥å°†æ„å»ºéƒ¨åˆ†æ‹†åˆ†å‡ºå»ï¼Œå¦åˆ™ä¿®æ”¹åŸå…ˆçš„ä»£ç å¾ˆæœ‰å¯èƒ½å¯¼è‡´æˆ¿å­æœ¬èº«é™¤äº†æ„å»ºçš„å…¶å®ƒé€»è¾‘å‡ºç°bugã€‚\næœ‰æ—¶å€™æ„å»ºä¸€ä¸ªå¯¹è±¡éœ€è¦çš„ä¼ å…¥å¤§é‡çš„å‚æ•°ï¼Œç„¶ååˆè¦æ‰§è¡Œå¾ˆå¤æ‚çš„å¤šä¸ªæ–¹æ³•è°ƒç”¨ï¼Œè€Œä¸”è¿˜ç»å¸¸å˜åŒ–ï¼Œè¿™ä¸ªæ—¶å€™åº”è¯¥æ”¹è€ƒè™‘å°†æ„å»ºå¯¹è±¡çš„å·¥ä½œå•ç‹¬æ‹†åˆ†å‡ºå»ã€‚\nåŠ¨æœº è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œæœ‰æ—¶å€™é¢ä¸´ç€â€œä¸€ä¸ªå¤æ‚å¯¹è±¡â€çš„åˆ›å»ºå·¥ä½œï¼Œå…¶ é€šå¸¸ç”±å„ä¸ªéƒ¨åˆ†çš„å­å¯¹è±¡ç”¨ä¸€å®šçš„ç®—æ³•æ„æˆ;ç”±äºéœ€æ±‚çš„å˜åŒ–ï¼Œè¿™ ä¸ªå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨åˆ†ç»å¸¸é¢ä¸´ç€å‰§çƒˆçš„å˜åŒ–ï¼Œä½†æ˜¯å°†å®ƒä»¬ç»„åˆåœ¨ ä¸€èµ·çš„ç®—æ³•å´ç›¸å¯¹ç¨³å®š\næ¯”å¦‚ç›–æˆ¿å­çš„å¤§è‡´æµç¨‹å›ºå®šï¼Œä½†æ˜¯ç›–ä¸åŒçš„æˆ¿å­æ¯ä¸ªå­æµç¨‹çš„å®ç°å„ä¸ç›¸åŒï¼Œè¿˜å¯èƒ½ç»å¸¸å˜åŒ–ã€‚\næ¨¡å¼å®šä¹‰ å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å…¶è¡¨ç¤ºç›¸åˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ ç¨‹(ç¨³å®š)å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤º(å˜åŒ–)\nç»“æ„å›¾è§£ ä»£ç å®ç° //äº§å“åŸºç±» å®šä¹‰æˆ¿å­é™¤äº†æ„å»ºæœ¬èº«çš„å…¶å®ƒæ¥å£ class House{ //.... }; //äº§å“æ„å»ºå™¨åŸºç±» è´Ÿè´£å®šä¹‰ç›¸å…³å…±æœ‰å­æ¥å£ ä¸å®ç° class HouseBuilder { public: House* GetResult(){ return pHouse; } virtual ~HouseBuilder(){} protected: House* pHouse; virtual void BuildPart1()=0; virtual void BuildPart2()=0; virtual void BuildPart3()=0; virtual void BuildPart4()=0; virtual void BuildPart5()=0; }; //çŸ³å¤´æˆ¿å­ ç»§æ‰¿æˆ¿å­ï¼Œå®ç°é™¤äº†æ„å»ºå·¥ä½œå¤–çš„çš„å…¶å®ƒæ–¹æ³• class StoneHouse: public House{ }; //çŸ³å¤´æˆ¿å­æ„å»ºå™¨ å®ç°æ„å»ºæˆ¿å­å¯¹è±¡éœ€è¦çš„å‡ ä¸ªå…±æœ‰çš„æŠ½è±¡æ¥å£ï¼Œå±Šæ—¶ä¼šç»„åˆè¿™äº›æ¥å£ç”ŸæˆçŸ³å¤´æˆ¿å­ class StoneHouseBuilder: public HouseBuilder{ protected: virtual void BuildPart1(){ //pHouse-\u003ePart1 = ...; } virtual void BuildPart2(){ } virtual void BuildPart3(){ } virtual void BuildPart4(){ } virtual void BuildPart5(){ } }; //ç›‘å·¥ å«æœ‰äº§å“builderåŸºç±»æŒ‡é’ˆ ä¼ å…¥ä¸åŒäº§å“çš„builderå­ç±»ï¼Œå°±ä¼šæ„å»ºå‡ºæ¥ä¸åŒçš„äº§å“ //å½“ç„¶è¿™é‡Œä¹Ÿè¦å®šä¹‰å®ç°å…±ç”¨çš„æ„å»ºç®—æ³•(ä¸åŒæˆ¿å­çš„å»ºé€ æµç¨‹æ˜¯ä¸€ç›´çš„ éƒ½è¦å…ˆæ‰“åœ°åŸº ç„¶å....) //å¦‚æœé¡¹ç›®å‘å±•åæœŸéœ€è¦å»ºé€ ä¸€ä¸ªæ›´æ–°å¥‡çš„æˆ¿å­ ä¸éœ€è¦å…ˆæ‰“åœ°åŸºï¼Œè€Œæ˜¯å…ˆç­‘åœ°æ¢ é‚£å°±æä¸€ä¸ªæ–°çš„ç›‘å·¥å®ç°ä¸åŒçš„æ„å»ºç®—æ³• class HouseDirector{ public: HouseBuilder* pHouseBuilder;//åŸºç±»builderæŒ‡é’ˆ HouseDirector(HouseBuilder* pHouseBuilder){ this-\u003epHouseBuilder=pHouseBuilder; } //ç»Ÿä¸€çš„æ„å»ºæ–¹æ³• House* Construct(){ pHouseBuilder-\u003eBuildPart1(); for (int i = 0; i \u003c 4; i++){ pHouseBuilder-\u003eBuildPart2(); } bool flag=pHouseBuilder-\u003eBuildPart3(); if(flag){ pHouseBuilder-\u003eBuildPart4(); } pHouseBuilder-\u003eBuildPart5(); return pHouseBuilder-\u003eGetResult(); } }; è¦ç‚¹æ€»ç»“ builder æ¨¡å¼ä¸»è¦ç”¨äºâ€œåˆ†æ­¥éª¤æ„å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡â€ã€‚åœ¨è¿™å…¶ä¸­ â€œåˆ†æ­¥éª¤â€æ˜¯ä¸€ä¸ªç¨³å®šçš„ç®—æ³•ï¼Œè€Œå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨åˆ†åˆ™ç»å¸¸å˜åŒ– å˜åŒ–ç‚¹åœ¨å“ªé‡Œï¼Œå°è£…å“ªé‡Œâ€”â€” Builderæ¨¡å¼ä¸»è¦åœ¨äºåº”å¯¹â€œå¤æ‚å¯¹ è±¡å„ä¸ªéƒ¨åˆ†â€çš„é¢‘ç¹éœ€æ±‚å˜åŠ¨ã€‚å…¶ç¼ºç‚¹åœ¨äºéš¾ä»¥åº”å¯¹â€œåˆ†æ­¥éª¤æ„å»º ç®—æ³•â€çš„éœ€æ±‚å˜åŠ¨ builderæ¨¡å¼è·Ÿæ¨¡ç‰ˆæ–¹æ³•æœ‰ç‚¹ç±»ä¼¼ï¼Œä½†builderæ¨¡å¼å¾€å¾€åªæ˜¯ä¸ºäº†è§£å†³æ„å»ºå¯¹è±¡å›°éš¾è€Œäº§ç”Ÿçš„ï¼Œè€Œä¸”builderæ¨¡å¼æœ‰ä¸€ä¸ªç›‘å·¥ï¼Œæ¨¡ç‰ˆæ–¹æ³•çš„ç›‘å·¥å…¶å®æ˜¯çˆ¶ç±»ã€‚ å•ä¾‹æ¨¡å¼singletonâ€”æ€§èƒ½é—®é¢˜ åŠ¨æœº å®é™…å¼€å‘é¡¹ç›®ä¸­ä¸­å°±æ˜¯éœ€è¦ä¸€äº›è¿™æ ·çš„ç±»ï¼Œä¿è¯å®ƒä»¬åœ¨ç³»ç»Ÿä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ ï¼Œæ‰èƒ½ä¿è¯é€»è¾‘æ­£ç¡®æ€§ï¼Œæˆ–è€…å¤§éƒ¨åˆ†æ—¶å€™ä¹Ÿæ˜¯ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå› ä¸ºé¢‘ç¹çš„äº§ç”Ÿå¤šä¸ªå®ä¾‹ï¼Œä¼šå¸¦æ¥æ€§èƒ½ä¸‹é™ï¼Œå†…å­˜æ¶ˆè€—ç­‰ç­‰\nä»£ç å®ç° class Singleton { private: Singleton() {cout \u003c\u003c \"Singleton construct\\n\";} Singleton(const Singleton\u0026 s) = delete; // ç¦ç”¨æ‹·è´æ„é€ å‡½æ•° Singleton\u0026 operator=(const Singleton\u0026 s) = delete; // ç¦ç”¨æ‹·è´èµ‹å€¼æ“ä½œç¬¦ static Singleton m_singleton; public: static Singleton* getInstance(){ return \u0026m_singleton; } }; //è¿™ç§æ¨¡å¼ç»å¯¹æ˜¯okçš„ï¼Œåªæ˜¯æœ‰äº›äººä¼šè¯´æœ‰ä¸€å®šçš„å†…å­˜æµªè´¹ï¼Œå› ä¸ºå³ä½¿åé¢ä¸ä½¿ç”¨ä¹Ÿä¼šç”Ÿæˆç›¸åº”å¯¹è±¡ //ç±»çš„é™æ€å˜é‡åœ¨ç±»å¤–éƒ¨åˆå§‹åŒ– è€Œä¸”æ˜¯å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒº è¿›å…¥mainå‡½æ•°ä¹‹å‰å°±å·²ç»æ‰§è¡Œäº† Singleton Singleton::m_singleton; int main(){ Singleton *a=Singleton::getInstance(); Singleton *b=Singleton::getInstance(); Singleton *c=Singleton::getInstance(); Singleton *d=Singleton::getInstance(); } class Singleton { public: static Singleton* getInstance(){ //å¦‚æœçº¿ç¨‹1 æ‰§è¡Œåˆ°ä¸‹é¢ä¸€è¡Œ(è¿˜æ²¡æœ‰newå‡ºæ¥) cpuè®©ç»™çº¿ç¨‹2ï¼Œçº¿ç¨‹2ä¹Ÿåˆ°è¿™è¡Œ æœ€å2ä¸ªçº¿ç¨‹éƒ½ä¼šnewå‡ºæ¥ if ( m_singleton==nullptr){ //çº¿ç¨‹ä¸å®‰å…¨ å¯èƒ½ä¼šå‡ºç°newå‡ºå¤šä¸ªçš„æƒ…å†µ return new Singleton(); } return m_singleton; } private: Singleton() {cout \u003c\u003c \"Singleton construct\\n\";} Singleton(const Singleton\u0026 s) = delete; // ç¦ç”¨æ‹·è´æ„é€ å‡½æ•° Singleton\u0026 operator=(const Singleton\u0026 s) = delete; // ç¦ç”¨æ‹·è´èµ‹å€¼æ“ä½œç¬¦ static Singleton *m_singleton; }; //ç±»çš„é™æ€å˜é‡åœ¨ç±»å¤–éƒ¨åˆå§‹åŒ– è€Œä¸”æ˜¯å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒº è¿›å…¥mainå‡½æ•°ä¹‹å‰å°±å·²ç»æ‰§è¡Œäº† Singleton* Singleton::m_singleton=nullptr; } class Singleton { public: static Singleton* getInstance(){ m_lock.lock(); //è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„è¿™ä¸ªåœ°æ–¹æ˜¯è¦åŠ é”çš„ ä½†æ˜¯å¦‚æœå·²ç»newå‡ºæ¥äº† å¤šä¸ªçº¿ç¨‹æ¯æ¬¡è°ƒç”¨éƒ½è¦åŠ é”å°±ä¼šå½±å“æ€§èƒ½ if ( m_singleton==nullptr){ m_singleton= new Singleton(); } m_lock.unlock(); return m_singleton; } private: Singleton() {cout \u003c\u003c \"Singleton construct\\n\";} Singleton(const Singleton\u0026 s) = delete; // ç¦ç”¨æ‹·è´æ„é€ å‡½æ•° Singleton\u0026 operator=(const Singleton\u0026 s) = delete; // ç¦ç”¨æ‹·è´èµ‹å€¼æ“ä½œç¬¦ static Singleton *m_singleton; static mutex m_lock; }; //ç±»çš„é™æ€å˜é‡åœ¨ç±»å¤–éƒ¨åˆå§‹åŒ– è€Œä¸”æ˜¯å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒº è¿›å…¥mainå‡½æ•°ä¹‹å‰å°±å·²ç»æ‰§è¡Œäº† Singleton* Singleton::m_singleton=nullptr; mutex Singleton::m_lock; class Singleton { public: static Singleton* getInstance(){ if ( m_singleton==nullptr){//å¦‚æœå·²ç»åˆå§‹åŒ– åˆ™ç›´æ¥è¿”å›å³å¯ m_lock.lock(); //è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„è¿™ä¸ªåœ°æ–¹æ˜¯è¦åŠ é”çš„ //å†æ¬¡æ£€æŸ¥æ˜¯å¦newè¿‡äº† ä¸‹é¢åˆ¤ç©ºé€»è¾‘ä¸èƒ½å»æ‰ å»æ‰äº†è¿˜æ˜¯ä¼šnewå‡ºå¤šä¸ªå®ä¾‹ å› ä¸ºå¦‚æœ2ä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥ä¸Šé¢çš„ç›¼ç©ºå å°±ä¼šå‡ºç° if ( m_singleton==nullptr){ m_singleton= new Singleton(); // å¯¹è±¡çš„newä¸æ˜¯åŸå­æ“ä½œ 1ã€åˆ†é…å†…å­˜ï¼Œ2 è°ƒç”¨æ„é€ ï¼Œ3 èµ‹å€¼æ“ä½œï¼Œåˆ°ç¬¬3æ­¥çš„æ—¶å€™æ‰æ˜¯m_singletonéç©º //1ã€åˆ†é…å†…å­˜ï¼Œ2 èµ‹å€¼æ“ä½œ 3 è°ƒç”¨æ„é€ ï¼Œåˆ°ç¬¬2æ­¥çš„æ—¶å€™æ‰æ˜¯m_singletonéç©º //å¦‚æœé¡ºåºæ˜¯å…ˆ2åœ¨3 2åšå®Œå å¦å¤–ä¸€ä¸ªçº¿ç¨‹å°±åˆ¤æ–­éç©º ç›´æ¥ä½¿ç”¨ä½†è¿˜æ²¡æœ‰è°ƒç”¨æ„é€ å‡½æ•°è¿™ä¸ªæ—¶å€™å°±ä¼šè®©å¦å¤–çº¿ç¨‹å‡ºé”™ } m_lock.unlock(); } return m_singleton; } private: Singleton() {cout \u003c\u003c \"Singleton construct\\n\";} Singleton(const Singleton\u0026 s) = delete; // ç¦ç”¨æ‹·è´æ„é€ å‡½æ•° Singleton\u0026 operator=(const Singleton\u0026 s) = delete; // ç¦ç”¨æ‹·è´èµ‹å€¼æ“ä½œç¬¦ static Singleton *m_singleton; static mutex m_lock; }; //ç±»çš„é™æ€å˜é‡åœ¨ç±»å¤–éƒ¨åˆå§‹åŒ– è€Œä¸”æ˜¯å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒº è¿›å…¥mainå‡½æ•°ä¹‹å‰å°±å·²ç»æ‰§è¡Œäº† Singleton* Singleton::m_singleton=nullptr; mutex Singleton::m_lock; //å¤šçº¿ç¨‹å®‰å…¨ç‰ˆæœ¬ åŒæ£€æŸ¥ä¸ºç©ºå¹¶åŠ é” åˆ©ç”¨atomicåº“æ¶ˆé™¤å†…å­˜è¯»å†™reorderé—®é¢˜ ç›¸å¯¹å®ç°å¤æ‚ å¯ä»¥ä½¿ç”¨ class Singleton { public: static Singleton* getInstance(){ Singleton* tmp = m_singleton.load(std::memory_order_relaxed); std::atomic_thread_fence(std::memory_order_acquire);//è·å–å†…å­˜fence if ( tmp==nullptr){//å¦‚æœå·²ç»åˆå§‹åŒ– åˆ™ç›´æ¥è¿”å›å³å¯ std::lock_guard\u003cstd::mutex\u003e lock(m_lock);; //è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„è¿™ä¸ªåœ°æ–¹æ˜¯è¦åŠ é”çš„ if ( tmp==nullptr){//å†æ¬¡æ£€æŸ¥æ˜¯å¦newè¿‡äº† è¿™è¡Œä¸èƒ½å»æ‰ å»æ‰äº†è¿˜æ˜¯ä¼šnewå‡ºå¤šä¸ªå®ä¾‹ å› ä¸ºå¦‚æœ2ä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥67è¡Œä»£ç  å°±ä¼šå‡ºç° tmp = new Singleton(); // 1ã€åˆ†é…å†…å­˜ï¼Œ2 è°ƒç”¨æ„é€ ï¼Œ3 èµ‹å€¼æ“ä½œ è¿™é‡Œä¸ä¼šå†å‡ºç°å†…å­˜è¯»å†™reorderé—®é¢˜ std::atomic_thread_fence(std::memory_order_release);//é‡Šæ”¾å†…å­˜fence m_singleton.store(tmp, std::memory_order_relaxed); } } return tmp; } private: Singleton() {cout \u003c\u003c \"Singleton construct\\n\";} Singleton(const Singleton\u0026 s) = delete; // ç¦ç”¨æ‹·è´æ„é€ å‡½æ•° Singleton\u0026 operator=(const Singleton\u0026 s) = delete; // ç¦ç”¨æ‹·è´èµ‹å€¼æ“ä½œç¬¦ static std::atomic\u003cSingleton*\u003e m_singleton; static mutex m_lock; }; //ç±»çš„é™æ€å˜é‡åœ¨ç±»å¤–éƒ¨åˆå§‹åŒ– è€Œä¸”æ˜¯å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒº è¿›å…¥mainå‡½æ•°ä¹‹å‰å°±å·²ç»æ‰§è¡Œäº† std::atomic\u003cSingleton*\u003e Singleton::m_singleton; mutex Singleton::m_lock; é€šè¿‡è¿”å›å±€éƒ¨é™æ€å˜é‡æ–¹å¼å®ç° çº¿ç¨‹å®‰å…¨ å†™æ³•ç®€å• æ¨èä½¿ç”¨\nclass Singleton { public: static Singleton* getInstance(){ static Singleton instance; //è¿™ç§ç›¸å¯¹äºä½¿ç”¨atomicçš„å†™æ³•æ›´ç®€æ´ è€Œä¸”åˆæ˜¯æ‡’æ±‰æ¨¡å¼ ä½¿ç”¨çš„æ—¶å€™æ‰ç”Ÿæˆ æ¨èä½¿ç”¨ //å±€éƒ¨é™æ€å˜é‡åˆå§‹åŒ–æ˜¯ä¼šåŠ é”çš„ ä¹Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„,è€Œä¸”æ˜¯c++å’Œç¼–è¯‘å™¨ä¿è¯çš„ æ¨èä½¿ç”¨ return \u0026instance; } private: Singleton() {cout \u003c\u003c \"Singleton construct\\n\";} Singleton(const Singleton\u0026 s) = delete; // ç¦ç”¨æ‹·è´æ„é€ å‡½æ•° Singleton\u0026 operator=(const Singleton\u0026 s) = delete; // ç¦ç”¨æ‹·è´èµ‹å€¼æ“ä½œç¬¦ static Singleton* m_singleton; }; //ç±»çš„é™æ€å˜é‡åœ¨ç±»å¤–éƒ¨åˆå§‹åŒ– è€Œä¸”æ˜¯å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒº è¿›å…¥mainå‡½æ•°ä¹‹å‰å°±å·²ç»æ‰§è¡Œäº† Singleton* Singleton::m_singleton=nullptr; äº«å…ƒæ¨¡å¼FlyWeightâ€”æ€§èƒ½é—®é¢˜ åŠ¨æœº å¦‚æœä¸€åˆ‡çš†å¯¹è±¡ï¼Œæœ‰äº›å¯¹è±¡åœ¨ç³»ç»Ÿä¸­å¤§é‡å­˜åœ¨(ä¸‡ã€åä¸‡ã€ç™¾ä¸‡ã€åƒä¸‡ç­‰)ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå¸¦æ¥å¤§é‡çš„è¿è¡Œæ—¶å¼€é”€ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹å¯èƒ½æ˜¯å†…å­˜æµªè´¹ã€‚æ¯”å¦‚è®¾è®¡å›´æ£‹æ¸¸æˆï¼Œæ¯ä¸€ä¸ªé»‘æ——ã€ç™½æ£‹éƒ½ææˆå¯¹è±¡ï¼Œæˆåƒä¸Šä¸‡çš„äººåœ¨ç©ï¼Œé‚£å°±æ˜¯åä¸‡ç”šè‡³ç™¾ä¸‡ä¸ªå¯¹è±¡ï¼Œæ¯”å¦‚è®¾è®¡å­—ä½“å¤„ç†è½¯ä»¶ï¼Œæ¯ä¸ªæœ‰å¤§é‡çš„å­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦åˆæœ‰å¤§é‡çš„å­—ä½“ï¼Œæ¯ä¸ªå­—ç¬¦æ¯ä¸ªå­—ä½“éƒ½ç”Ÿæˆ1ä¸ªå¯¹è±¡ï¼Œæœ€ç»ˆå ç”¨å†…å­˜å°†æ˜¯éå¸¸å¤¸å¼ çš„ï¼Œè€Œå¤§éƒ¨åˆ†æ—¶å€™æ˜¯ä¸éœ€è¦ï¼Œå› ä¸ºè¿™äº›å¯¹è±¡éƒ½æ˜¯åªè¯»çš„ï¼Œå®Œå…¨å¯ä»¥ç”¨æ± çš„æ¦‚å¿µæ¥å…±äº«ï¼Œå¦‚æœå·²ç»åˆ›å»ºè¿‡äº†ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ ä¸å†åˆ›å»ºï¼Œå¦åˆ™å°±åˆ›å»ºå¹¶ä¸”åŠ åˆ°å…±äº«æ± ä¸­ã€‚\næ¨¡å¼å®šä¹‰ é€šè¿‡å…±äº«æŠ€æœ¯æœ‰æ•ˆæ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚\nä»£ç  class Font { private: //unique object key string key; //object state //.... public: Font(const string\u0026 key){ //... } }; //å¯¹è±¡ç”Ÿæˆå·¥å‚ ç”¨mapå®ç°å…±äº«æ±  class FontFactory{ private: map\u003cstring,Font* \u003e fontPool; public: Font* GetFont(const string\u0026 key){ map\u003cstring,Font*\u003e::iterator item=fontPool.find(key); if(item!=footPool.end()){ return fontPool[key]; } else{ Font* font = new Font(key); fontPool[key]= font; return font; } } void clear(){ //... } }; è¦ç‚¹æ€»ç»“ äº«å…ƒæ¨¡å¼ä¸»è¦æ˜¯è§£å†³å¤§é‡å¯¹è±¡å¸¦æ¥çš„å†…å­˜æ¶ˆè€—é—®é¢˜ï¼Œå¦‚æœè¯„ä¼°ä¸å¯èƒ½å‘ç”Ÿï¼Œä¹Ÿæ²¡æœ‰å¿…è¦ä½¿ç”¨ã€‚\né—¨é¢æ¨¡å¼ facadeâ€”æ¥å£éš”ç¦» éœ€æ±‚èƒŒæ™¯ä¸åŠ¨æœº é¡¹ç›®ä¸­ç”¨åˆ°äº†å¤šç§æ•°æ®åº“ï¼Œæ¯”å¦‚mysqlã€oracleã€DB2ã€Timestenç­‰ç­‰ï¼Œå¦‚æœå¤šä¸ªç¨‹åºç›´æ¥ä¸è¿™äº›æ•°æ®åº“æ‰“äº¤é“ï¼Œæ¯ä¸ªç¨‹åºéƒ½ä¼šéå¸¸å¤æ‚ï¼ŒäºŒæœŸå¦‚æœæ•°æ®åº“å‡çº§ï¼Œæ•°æ®åº“æ¥å£å˜åŠ¨ï¼Œç›¸å…³çš„ç¨‹åºéƒ½éœ€è¦æ”¹åŠ¨ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä¸€ä¸ªæ•°æ®è®¿é—®å±‚(æä¾›å›ºå®šçš„æ•°æ®è®¿é—®æ¥å£)ï¼Œç»™å¤–éƒ¨æä¾›ç»Ÿä¸€çš„è®¿é—®æ¥å£ï¼Œå°†å„ä¸ªæ•°æ®åº“çš„å¤„ç†ç»†èŠ‚å±è”½ï¼Œå³ä½¿æ•°æ®åº“å‡çº§æ”¹åŠ¨ï¼Œåªä¿®æ”¹æ¥å£å®ç°ï¼Œå¤–éƒ¨ç¨‹åºä¸ç”¨æ”¹åŠ¨ã€‚\næ¨¡å¼å®šä¹‰ ä¸ºç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´ç¨³å®šçš„ç•Œé¢ï¼Œfacadeæ¨¡å¼å®šä¹‰ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œä½¿å¾—ç³»ç»Ÿå¤–éƒ¨ä½¿ç”¨è€…æ›´åŠ æ˜“ç”¨ï¼Œç¨³å®šï¼Œä¸ç”¨é¢‘ç¹å˜åŒ–ã€‚\nè¦ç‚¹æ€»ç»“ facadeæ¨¡å¼æ²¡æœ‰å›ºå®šçš„ä»£ç æ¨¡å¼ï¼Œæ›´å¤šçš„æ˜¯ä¸€ç§æ¶æ„æ€ç»´ facadeæ¨¡å¼å†…éƒ¨å¿…é¡»æ˜¯é«˜ç›¸å…³çš„ç»„ä»¶ï¼Œä¸èƒ½ä»€ä¹ˆéƒ½æ”¾ ä»£ç†æ¨¡å¼Proxyâ€”æ¥å£éš”ç¦» éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº ç”±äºä¸€äº›å®é™…çš„ç°å®åŸå› ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨æŸä¸ªå¯¹è±¡(æ¯”å¦‚ä½¿ç”¨ä¹‹å‰è¦åšä¸€äº›å®‰å…¨æ§åˆ¶ï¼Œæˆ–è€…è¯´ç›´æ¥åˆ›å»ºæŸä¸ªå¯¹è±¡çš„å¼€é”€å¤ªå¤§ï¼Œåˆæˆ–è€…æ ¹æœ¬æ— æ³•ç›´æ¥åˆ›å»º[è®¿é—®ä¸€äº›åˆ†å¸ƒå¼æœºå™¨ä¸Šçš„èµ„æº])ï¼Œæ‰€ä»¥ç›´æ¥è®¿é—®ä¼šç»™ä½¿ç”¨è€…æˆ–è€…ç³»ç»Ÿæ¶æ„çš„è®¾è®¡ä»£ç éº»çƒ¦ï¼Œæ‰€ä»¥å°±éœ€è¦ä¸€ç§ä»£ç†ï¼Œå°±åƒç°å®ä¸–ç•Œçš„ä»£ç†ä¸€æ ·ï¼Œä¸ç”¨ç®¡ä¸€äº›ç»†èŠ‚ï¼Œåªè¦å®ƒä»¬æä¾›ç›¸åº”çš„æœåŠ¡å³å¯(è½¯ä»¶å±‚é¢å¯èƒ½å°±æ˜¯æä¾›ä¸€äº›å¯ç”¨çš„æ¥å£)ã€‚\nä»£ç†çš„æ“ä½œå¾€å¾€è·Ÿç›´æ¥æ“ä½œå¯¹è±¡ä¸€è‡´ï¼Œå¯ä»¥ç†è§£å¢åŠ äº†ä¸€ä¸ªé—´æ¥å±‚ä¹Ÿå°±æ˜¯ä»£ç†ï¼Œæ¥å®ç°æ§åˆ¶è¿™äº›å¯¹è±¡ã€‚\næ¨¡å¼å®šä¹‰ ä¸ºå…¶å®ƒå¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶(éš”ç¦»ï¼Œä½¿ç”¨æ¥å£)å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚\næˆ‘çš„ç†è§£å°±æ˜¯å¢åŠ ä¸€ä¸ªé—´æ¥å±‚ ä¸è®©ç›´æ¥ä½¿ç”¨ï¼Œè¿™ä¸ªæœ‰å¾ˆå¤šå¥½å¤„ï¼Œè·Ÿé—¨é¢æ¨¡å¼ä¸€æ ·ï¼Œå¯ä»¥éš”ç¦»å¾ˆå¤šå˜åŒ–ã€‚\nç»“æ„å›¾è§£ ä»£ç  class ISubject{ public: virtual void process(); }; class RealSubject: public ISubject{ public: virtual void process(){ //.... } }; //å®¢æˆ·ç«¯ç›´æ¥ä½¿ç”¨æŸä¸ªå¯¹è±¡ å¦‚æœç°å®ä¸­ä¸èƒ½è®©ç›´æ¥ä½¿ç”¨ æ¯”å¦‚è¦å¢åŠ å®‰å…¨æ§åˆ¶ //åˆæ³•çš„clientæ‰èƒ½ä½¿ç”¨å°±è¦è€ƒè™‘æ”¹é€ äº† è€Œä¸”ä¸èƒ½å¯¹æ¯ä¸ªclientéƒ½æ”¹é€  æ‰€ä»¥æœ€åå®ç°èµ·å¯èƒ½æ¯”è¾ƒå¤æ‚æ··ä¹± class ClientApp{ ISubject* subject; public: ClientApp(){ subject=new RealSubject(); } void DoTask(){ //... subject-\u003eprocess(); //.... } }; class ISubject{ public: virtual void process(); }; class RealSubject: public ISubject{ public: virtual void process(){ //.... } }; //Proxyçš„è®¾è®¡ ç»§æ‰¿ISubjectå®ç° ä¸€è‡´æ€§çš„æ¥å£ class SubjectProxy: public ISubject{ public: virtual void process(){ //å¯¹RealSubjectçš„ä¸€ç§é—´æ¥è®¿é—® æ¯”å¦‚è°ƒç”¨å‰åšå®‰å…¨æ§åˆ¶ ç»Ÿè®¡ä¸‹è°ƒç”¨æ¬¡æ•°ï¼Œä½¿ç”¨rpcè®¿é—®åˆ«çš„æœºå™¨ç­‰ç­‰ //.... } }; //å®¢æˆ·ç«¯ä½¿ç”¨ä»£ç†è·Ÿç›´æ¥ä½¿ç”¨RealSubjectæ²¡æœ‰å¤ªå¤§åŒºåˆ« class ClientApp{ ISubject* subject; public: ClientApp(){ subject=new SubjectProxy(); } void DoTask(){ //... subject-\u003eprocess(); //.... } }; è¦ç‚¹æ€»ç»“ â€œå¢åŠ ä¸€ä¸ªä¸­é—´å±‚â€æ˜¯è½¯ä»¶ç³»ç»Ÿå¯¹è®¸å¤šå¤æ‚é—®é¢˜çš„ä¸€ç§å¸¸è§è§£å†³æ–¹æ¡ˆï¼Œå¦‚æœç›´æ¥ä½¿ç”¨æŸä¸ªå¯¹è±¡ä¼šå¸¦æ¥å¾ˆå¤šéº»çƒ¦ï¼Œå°±å°è¯•ä½¿ç”¨ä»£ç†æ¨¡å¼ å…·ä½“proxyè®¾è®¡æ¨¡å¼çš„å®ç°æ–¹æ³•ï¼Œåƒå·®ä¸‡åˆ«ã€‚ é€‚é…å™¨æ¨¡å¼Adapterâ€”æ¥å£éš”ç¦» éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº â€‹\tç°å®é¡¹ç›®ä¸­ç”±äºåº”ç”¨ç¯å¢ƒçš„å˜åŒ–ï¼Œå¸¸å¸¸éœ€è¦å°†â€œä¸€äº›ç°å­˜çš„å¯¹è±¡â€æ”¾åœ¨æ–°ç¯å¢ƒä½¿ç”¨ï¼Œä½†æ˜¯æ–°ç¯å¢ƒè¦æ±‚çš„æ¥å£åˆæ˜¯ä¸€äº›è€å¯¹è±¡æ‰€ä¸èƒ½ç›´æ¥æ»¡è¶³çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šæƒ³åˆ°é€‚é…å™¨æ¨¡å¼ï¼Œç®€å•æ¥è¯´å°±æ˜¯å®šä¹‰ä¸€ä¸ªé€‚é…å™¨ç±»ç»§æ‰¿æ–°æ¥å£çš„åŸºç±»ï¼Œä½†æ˜¯ç”¨å¯¹è±¡ç»„åˆçš„æ–¹å¼æ‹¥æœ‰è€å¯¹è±¡çš„åŸºç±»æˆ–è€…å­ç±»ï¼Œç”¨è€å¯¹è±¡çš„æŸäº›æ–¹æ³•å®ç°æ–°çš„æ¥å£ã€‚\nâ€‹\tç°å®ç”Ÿæ´»ä¸­ä¹Ÿæœ‰å¾ˆå¤šé€‚é…å™¨ï¼Œæ¯”å¦‚ç”µæºçš„é€‚é…å™¨ï¼ŒHTMIè½¬VGAç­‰ç­‰ï¼Œè¯´ç™½äº†å°±æ˜¯æŠŠä¸€ä¸ªè€çš„æ¥å£è½¬æˆæ–°çš„æ¥å£ã€‚\næ¨¡å¼å®šä¹‰ å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ–°æ¥å£ã€‚Adapteræ¨¡å¼ä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚\nç»“æ„å›¾è§£ è¦ç‚¹æ€»ç»“ Adapteræ¨¡å¼ä¸»è¦åº”ç”¨äºâ€œå¸Œæœ›å¤ç”¨ä¸€äº›ç°å­˜çš„ç±»â€ï¼Œä½†æ¥å£åˆä¸å¤ç”¨ç¯å¢ƒè¦æ±‚çš„ä¸ä¸€è‡´ï¼Œåœ¨é—ç•™ä»£ç å¤ç”¨ï¼Œç±»åº“è¿ç§»ç­‰æ–¹é¢éå¸¸æœ‰ç”¨ã€‚ GoF23å®šä¹‰çš„é€‚é…å™¨æœ‰2ç§ï¼Œå¯¹è±¡é€‚é…å™¨(ä¸Šå›¾çš„è¿™ç§)å’Œç±»é€‚é…å™¨(ç›´æ¥å¤šç»§æ‰¿è€å¯¹è±¡)ï¼Œç±»é€‚é…å™¨ä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºä½¿ç”¨äº†å¤šç»§æ‰¿ï¼Œä¸€èˆ¬éƒ½æ˜¯è¢«æ‘’å¼ƒçš„ã€‚å¯¹è±¡ç»„åˆçš„æ–¹å¼æ›´ç¬¦åˆæ¾è€¦åˆç²¾ç¥ å…¶å®å®é™…é¡¹ç›®ä¸­å®Œå…¨ä¹Ÿä¸ç”¨æ‹˜æ³¥äºä¹¦ä¸­å®šä¹‰çš„ç»“æ„ï¼Œå³ä½¿æŠŠè€å¯¹è±¡ä½œä¸ºæ–°å¯¹è±¡æ–°æ¥å£çš„å‚æ•°ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚ ä»£ç  Adapteré€‚é…å™¨æ¨¡å¼ c++\n//ç›®æ ‡æ¥å£ï¼ˆæ–°æ¥å£ï¼‰ class ITarget{ public: virtual void process()=0; }; //é—ç•™æ¥å£ï¼ˆè€æ¥å£ï¼‰ class IAdaptee{ public: virtual void foo(int data)=0; virtual int bar()=0; }; //é—ç•™ç±»å‹ class OldClass: public IAdaptee{ //.... }; //å¯¹è±¡é€‚é…å™¨ class Adapter: public ITarget{ //ç»§æ‰¿æ–°æ¥å£åŸºç±» protected: IAdaptee* pAdaptee;//ç»„åˆæ–¹å¼æ‹¥æœ‰è€å¯¹è±¡ è¿™æ ·å°±å¯ä»¥é€šè¿‡åŠ å·¥è€å¯¹è±¡çš„æ–¹æ³•å®ç°æ–°æ¥å£ public: Adapter(IAdaptee* pAdaptee){ this-\u003epAdaptee=pAdaptee; } virtual void process(){ int data=pAdaptee-\u003ebar(); pAdaptee-\u003efoo(data); } }; //ç±»é€‚é…å™¨ class Adapter: public ITarget, protected OldClass{ //å¤šç»§æ‰¿ ä¸æ¨èä½¿ç”¨ }; int main(){ IAdaptee* pAdaptee=new OldClass(); ITarget* pTarget=new Adapter(pAdaptee); pTarget-\u003eprocess(); } //stlçš„æ ˆå’Œé˜Ÿåˆ— å¤§è‡´ä¹Ÿæ˜¯é€šè¿‡å¯¹è±¡ç»„åˆçš„æ–¹å¼å®ç°çš„ ä¹Ÿå¯ä»¥ç†è§£ä¸ºAdapteræ¨¡å¼ class stack{ deqeue container; }; class queue{ deqeue container; }; ä¸­ä»‹è€…Mediatorâ€”æ¥å£éš”ç¦» éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº å¦‚æœç°å®é¡¹ç›®ä¸­å‡ºç°äº†å¤šä¸ªå¯¹è±¡äº’ç›¸å…³è”äº¤äº’çš„æƒ…å†µï¼Œå®ƒä»¬å½¼æ­¤ä¹‹é—´å¾å¥¥ç»´æŒä¸€ç§å¤æ‚çš„å¼•ç”¨å…³ç³»ï¼ŒAå˜äº† BCä¹Ÿè¦å˜ï¼ŒCå˜äº†Dä¹Ÿè¦å˜ï¼ŒDå˜äº†å¯èƒ½Aåˆè¦è·Ÿç€åšç›¸åº”å˜åŒ–ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœé‡åˆ°éœ€æ±‚å˜æ›´ï¼Œæ”¹åŠ¨èµ·æ¥å°†ä¼šéå¸¸éº»çƒ¦ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚\nè¿™ä¸ªæ—¶å€™å°±å¯ä»¥è€ƒè™‘å¼•å…¥ä¸€ä¸ªä¸­ä»‹è€…ï¼Œè®©å®ƒä»¬å½¼æ­¤çš„å¼•ç”¨æ‹†å¼€ï¼Œå˜æˆéƒ½ç»™ä¸­ä»‹è€…æ‰“äº¤é“ï¼ŒAå˜äº†å¦‚æœè¦æ”¹å˜Bæˆ–è€…Cï¼Œå°±é€šçŸ¥ä¸­ä»‹è€…ï¼Œç„¶åä¸­ä»‹å»é€šçŸ¥BCåšæ”¹å˜ï¼Œå½“ç„¶è¦å»ºç«‹è‰¯å¥½çš„é€šçŸ¥æœºåˆ¶å’Œåè®®ã€‚\nå¦‚æœä¸­ä»‹è€…æœ€åéå¸¸åºå¤§æˆ–è€…å¤æ‚ï¼Œä¹Ÿè¦è€ƒè™‘ç»§ç»­æ‹†åˆ†ä¸­ä»‹è€…\næ¨¡å¼å®šä¹‰ ç”¨ä¸­ä»‹å¯¹è±¡æ¥å°è£…(å˜åŒ–)ä¸€äº›åˆ—çš„å¯¹è±¡äº¤äº’ï¼Œè®©åŸå…ˆå„ä¸ªå¯¹è±¡ä¸éœ€è¦æ˜¾ç¤ºç›¸äº’å¼•ç”¨(ç¼–è¯‘æ—¶ä¾èµ–â€”\u003eè¿è¡Œæ—¶ä¾èµ–)ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œä¾¿äºç®¡ç†å˜åŒ–ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹çš„æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚\nç»“æ„å›¾è§£ è¦ç‚¹æ€»ç»“ å°†å¤šä¸ªå¯¹è±¡å¤æ‚çš„å…³è”å…³ç³»è§£è€¦ï¼ŒMediatoræ¨¡å¼å°†å¤šä¸ªå¯¹è±¡é—´çš„æ§åˆ¶é€»è¾‘è¿›è¡Œç»Ÿä¸€ç®¡ç†ï¼Œå°†â€œå¤šä¸ªå¯¹è±¡äº’ç›¸å…³è”â€å˜æˆäº†\"å¤šä¸ªå¯¹è±¡éƒ½å’Œä¸­ä»‹è€…å…³è”â€œï¼Œç®€åŒ–äº†ç³»ç»Ÿçš„ç»´æŠ¤ï¼ŒæŠµå¾¡äº†å¯èƒ½çš„å˜åŒ–ã€‚ å¦‚æœMediatorå˜å¾—å¤ªå¤šå¤æ‚ä¹Ÿè¦å¯¹å…¶æ‹†åˆ†å¤„ç† facadeæ¨¡å¼æ˜¯è§£è€¦ç³»ç»Ÿé—´(å•å‘)çš„å¯¹è±¡å…³è”å…³ç³»ï¼Œä½†Mediatoræ¨¡å¼æ˜¯è§£è€¦ç³»ç»Ÿå†…å„ä¸ªå¯¹è±¡ä¹‹é—´çš„(åŒå‘)å…³è”å…³ç³»ã€‚ çŠ¶æ€æ¨¡å¼Stateâ€”çŠ¶æ€å˜åŒ– éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº åœ¨è½¯ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼ŒæŸäº›å¯¹è±¡çš„çŠ¶æ€å¦‚æœæ”¹å˜ï¼Œå…¶è¡Œä¸ºä¹Ÿä¼šéšä¹‹å‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚æ–‡æ¡£å¤„äºåªè¯»çŠ¶æ€ï¼Œåˆ™æ”¯æŒè¡Œä¸ºå’Œè¯»å†™çŠ¶æ€çš„è¡Œä¸ºå¯èƒ½å°±å®Œå…¨ä¸åŒäº†\nå¦‚ä½•åœ¨è¿è¡Œæ—¶æ ¹æ®å¯¹è±¡çš„çŠ¶æ€æ¥é€æ˜çš„æ›´æ”¹å¯¹è±¡çš„è¡Œä¸ºï¼Ÿè€Œä¸”ä¸ä¼šä¸ºå¯¹è±¡æ“ä½œå’ŒçŠ¶æ€è½¬åŒ–ä¹‹é—´å¼•å…¥è€¦åˆï¼Ÿ\nä¾‹å­ å‡è®¾æœ‰ä¸€ä¸ªç½‘ç»œçŠ¶æ€å¤„ç†ç±»ï¼Œå¤§è‡´æœ‰3ç§æ“ä½œï¼Œä½†æ˜¯å¯¹äºæ¯ç§æ“ä½œï¼Œä¸åŒçš„çŠ¶æ€æœ‰ä¸åŒçš„å¤„ç†ï¼Œè€Œä¸”å¤„ç†åè¦åˆ‡æ¢åˆ°å¯¹åº”çš„çŠ¶æ€\n//æšä¸¾å€¼ å®šä¹‰ç½‘ç»œçš„å¤šç§çŠ¶æ€ æœªæ¥å¯èƒ½ä¼šæ–°å¢çŠ¶æ€çš„å¤„ç† enum NetworkState { Network_Open, Network_Close, Network_Connect, }; //ç½‘ç»œå¤„ç†ç±» class NetworkProcessor{ NetworkState state; public: //é’ˆå¯¹æ“ä½œ1 ä¸åŒçš„çŠ¶æ€ä¼šå‘ç”Ÿä¸åŒçš„è¡Œä¸ºï¼ŒåŒæ—¶æ“ä½œåçŠ¶æ€è¦åˆ‡æ¢ è¿™é‡Œé¢åç»­å¯èƒ½è¿˜è¦å¢åŠ çŠ¶æ€ ä¸€æ¥ä¿®æ”¹å¯èƒ½å¼•å…¥bugï¼ŒäºŒæ¥ä¿®æ”¹èµ·æ¥å¾€å¾€æ¯”è¾ƒå›°éš¾ï¼Œå› ä¸ºå¤ªå¤šifelseäº†å®¹æ˜“æ™• void Operation1(){ if (state == Network_Open){ //********** state = Network_Close; } else if (state == Network_Close){ //.......... state = Network_Connect; } else if (state == Network_Connect){ //$$$$$$$$$$ state = Network_Open; } } //é’ˆå¯¹æ“ä½œ2 ä¸åŒçš„çŠ¶æ€ä¼šå‘ç”Ÿä¸åŒçš„è¡Œä¸ºï¼ŒåŒæ—¶æ“ä½œåçŠ¶æ€è¦åˆ‡æ¢ public void Operation2(){ if (state == Network_Open){ //********** state = Network_Connect; } else if (state == Network_Close){ //..... state = Network_Open; } else if (state == Network_Connect){ //$$$$$$$$$$ state = Network_Close; } } //é’ˆå¯¹æ“ä½œ3 ä¸åŒçš„çŠ¶æ€ä¼šå‘ç”Ÿä¸åŒçš„è¡Œä¸ºï¼ŒåŒæ—¶æ“ä½œåçŠ¶æ€è¦åˆ‡æ¢ public void Operation3(){ //ã€‚ã€‚ã€‚ã€‚ã€‚ } }; æ¨¡å¼å®šä¹‰ å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜çš„æ—¶å€™æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œä»è€Œä½¿å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å…¶è¡Œä¸ºã€‚ ç»“æ„å›¾è§£ è¦ç‚¹æ€»ç»“ Stateæ¨¡å¼æ ¸å¿ƒæ˜¯å°†æ‰€æœ‰ä¸ä¸€ä¸ªç‰¹å®šçŠ¶æ€ç›¸å…³çš„è¡Œä¸ºéƒ½æ”¾å…¥ä¸€ä¸ªStateçš„å­ç±»å¯¹è±¡ä¸­ï¼Œåœ¨å¯¹è±¡çŠ¶æ€åˆ‡æ¢çš„æ—¶å€™ï¼Œå…¶å®æ˜¯åˆ‡æ¢äº†ä¸åŒçš„å­ç±»å¯¹è±¡æŒ‡å‘ï¼Œä½†åŒæ—¶ç»´æŒStateçš„æ¥å£(éƒ½ç»§æ‰¿åŒä¸€ä¸ªåŸºç±»)ï¼Œè¿™æ ·å°±å®ç°äº†å…·ä½“çš„æ“ä½œå’ŒçŠ¶æ€è½¬æ¢ä¹‹é—´çš„è§£è€¦ã€‚ ä¸ºä¸åŒçš„çŠ¶æ€å¼•å…¥ä¸åŒçš„å¯¹è±¡ä½¿å¾—çŠ¶æ€è½¬æ¢å˜å¾—æ›´åŠ æ˜ç¡®ï¼Œè€Œä¸”å¯ä»¥ä¿è¯ä¸ä¼šå‡ºç°çŠ¶æ€ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå› ä¸ºè½¬æ¢æ˜¯æºè‡ªè¡Œçš„ï¼Œè¦ä¹ˆå½»åº•è½¬æ¢è¿‡æ¥ï¼Œè¦ä¹ˆä¸è½¬æ¢ã€‚ å¦‚æœStateå¯¹è±¡æ²¡æœ‰å®ä¾‹å˜é‡ï¼Œå¯ä»¥ç”¨singetoneæ¨¡å¼å…±äº«åŒä¸€ä¸ªå¯¹è±¡ï¼Œä»è€ŒèŠ‚çœå¯¹è±¡å¼€é”€ ä»£ç  //çŠ¶æ€åŸºç±»ï¼Œå°†ä¸åŒçš„çŠ¶æ€æ”¹ä¸ºä¸åŒçš„ç±»(å¯¹è±¡)ï¼Œå®ç°åŒæ ·çš„æ¥å£ class NetworkState{ public: NetworkState* pNext; virtual void Operation1()=0; virtual void Operation2()=0; virtual void Operation3()=0; virtual ~NetworkState(){} }; //æ‰“å¼€çŠ¶æ€ç±» è¦å®ç°ä¸åŒçš„æ“ä½œå¯¹åº”åº”è¯¥æ€ä¹ˆå¤„ç† åŒæ—¶æ“ä½œååº”è¯¥åˆ‡æ¢åˆ°ä»€ä¹ˆçŠ¶æ€ class OpenState :public NetworkState{ static NetworkState* m_instance; public: static NetworkState* getInstance(){ if (m_instance == nullptr) { m_instance = new OpenState(); } return m_instance; } //è¿™é‡Œå°†åªå…³æ³¨æ‰“å¼€çŠ¶æ€åœ¨Operation1æ—¶å¦‚ä½•å¤„ç†ï¼Œä¸å®¹æ˜“æ··æ·†ï¼ŒåŒæ—¶åˆ‡æ¢çŠ¶æ€å…¶å®æ˜¯åˆ‡æ¢å­ç±»æŒ‡é’ˆæŒ‡å‘ï¼Œæ˜¯æœ‰åŸå­æ€§çš„ void Operation1(){ //********** pNext = CloseState::getInstance(); } void Operation2(){ //.......... pNext = ConnectState::getInstance(); } void Operation3(){ //$$$$$$$$$$ pNext = OpenState::getInstance(); } }; //å…³é—­çŠ¶æ€ç±» è¦å®ç°ä¸åŒçš„æ“ä½œå¯¹åº”åº”è¯¥æ€ä¹ˆå¤„ç† åŒæ—¶æ“ä½œååº”è¯¥åˆ‡æ¢åˆ°ä»€ä¹ˆçŠ¶æ€ class CloseState:public NetworkState{ }; //.. class NetworkProcessor{ NetworkState* pState; public: //çŠ¶æ€ç±»åˆå§‹åŒ–å é’ˆå¯¹ä¸åŒçš„çŠ¶æ€ æ“ä½œæ¥å£æ˜¯ç±»ä¼¼çš„ï¼Œé‚£å°±æ˜¯æ‰§è¡Œæƒ³è¦çš„æ“ä½œï¼Œåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œ //ä»£ç ä¿æŒç¨³å®šï¼Œå³ä½¿æ–°å¢çŠ¶æ€ï¼Œå¦‚æœæ¥å£ä¸æ”¹å˜ NetworkProcessorç±»ä»£ç æ— éœ€æ”¹å˜ NetworkProcessor(NetworkState* pState){ this-\u003epState = pState; } void Operation1(){ //... pState-\u003eOperation1(); pState = pState-\u003epNext; //... } void Operation2(){ //... pState-\u003eOperation2(); pState = pState-\u003epNext; //... } void Operation3(){ //... pState-\u003eOperation3(); pState = pState-\u003epNext; //... } }; å¤‡å¿˜å½•Mementoâ€”-çŠ¶æ€å˜åŒ– éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº ç°å®è½¯ä»¶ç³»ç»Ÿæœ‰æ—¶å€™éœ€è¦ä¿å­˜æŸä¸ªå¯¹è±¡çš„çŠ¶æ€ï¼Œç›¸å½“äºç»™å½“ä¸‹çš„å¯¹è±¡æ¥ä¸ªå¿«ç…§ä¿å­˜èµ·æ¥ï¼Œä»¥ä¾¿æœªæ¥æŸä¸ªæ—¶é—´æ¢å¤è¿™ä¸ªçŠ¶æ€åšç›¸åº”çš„å¤„ç†ï¼Œåˆä¸èƒ½ç ´åå¯¹è±¡çš„å°è£…æ€§ï¼Œä¸èƒ½æš´æ¼å…¬å…±æ¥å£ç»™å¤–éƒ¨ã€‚ æœ€å¼€å§‹çš„æ—¶å€™å°±æƒ³åˆ°äº†å¤‡å¿˜å½•æ¨¡å¼ï¼Œæ‰€è°“å¤‡å¿˜å½•ç®€å•ç†è§£å°±æ˜¯æ·±æ‹·è´ä¸€ä¸ªå¯¹è±¡ï¼Œä¿å­˜èµ·æ¥ï¼Œæœªæ¥æŸä¸ªæ—¶é—´å†æ‹¿è¿™ä¸ªå¤‡å¿˜å½•é‡å»ºå¯¹è±¡ï¼Œå®ç°æŸäº›ç‰¹å®šçš„åŠŸèƒ½ã€‚ æ¨¡å¼å®šä¹‰ ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™æ ·ä»¥åå°±å¯ä»¥å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ï¼Œä»¥å®ç°ç‰¹å®šçš„åŠŸèƒ½ã€‚ ç»“æ„å›¾è§£ è¦ç‚¹æ€»ç»“ å¤‡å¿˜å½•Mementoéœ€è¦å­˜å‚¨åŸå‘å™¨Originatorå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œä»¥å¤‡éœ€è¦æ—¶æ¢å¤åŸå‘å™¨Originatorçš„çŠ¶æ€ Mementoçš„æ ¸å¿ƒæ˜¯ä¿¡æ¯éšè— å› ä¸ºè®¾è®¡æ¨¡å¼æ˜¯94å¹´æå‡ºäº†ï¼Œç°åœ¨è¿™ä¸ªæ¨¡å¼æœ‰ç‚¹è¿‡æ—¶ï¼Œå› ä¸ºå¾ˆå¤šé«˜çº§è¯­è¨€éƒ½æä¾›äº†åºåˆ—åŒ–ã€ååºåˆ—åŒ–çš„æŠ€æœ¯ï¼Œä½†æ˜¯æ€æƒ³æ˜¯ä¸€æ ·çš„ã€‚ ä»£ç  //å¤‡å¿˜å½•ç±» class Memento { string state; //.. è¿™é‡Œä¸ºäº†ä¿å­˜å†…éƒ¨çš„çŠ¶æ€ å¯èƒ½å®ç°æ¯”è¾ƒå¤æ‚ ä»…ä¸ºç¤ºæ„ä»£ç  public: Memento(const string \u0026 s) : state(s) {} string getState() const { return state; } void setState(const string \u0026 s) { state = s; } }; //åŸå‘å™¨ç±» class Originator { string state; //.... public: Originator() {} //åˆ›å»ºå¤‡å¿˜å½• Memento createMomento() { Memento m(state); return m; } //ç”¨å¤‡å¿˜å½•æ¢å¤åŸå§‹çŠ¶æ€ void setMomento(const Memento \u0026 m) { state = m.getState(); } }; int main() { Originator orginator; //..åšç›¸åº”å¤„ç† æ”¹å˜çŠ¶æ€ //æ•è·å¯¹è±¡çŠ¶æ€ï¼Œå­˜å‚¨åˆ°å¤‡å¿˜å½• Memento mem = orginator.createMomento(); //... æ”¹å˜orginatorçŠ¶æ€ //ä»å¤‡å¿˜å½•ä¸­æ¢å¤ orginator.setMomento(mem); } ç»„åˆæ¨¡å¼Compositâ€”æ•°æ®ç»“æ„ éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº å¦‚ä½•å®¢æˆ·ä»£ç è¿‡å¤šçš„ä¾èµ–å¯¹è±¡å®¹å™¨å¤æ‚çš„å†…éƒ¨å®ç°çš„æ•°æ®ç»“æ„ï¼Œå¯¹è±¡å®¹å™¨å†…éƒ¨çš„å®ç°ç»“æ„(ä¸æ˜¯æŠ½è±¡æ¥å£)å¦‚æœå‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆå®¢æˆ·ä»£ç ä¹Ÿä¼šé¢‘ç¹å˜åŒ–ï¼Œå°±å¸¦æ¥äº†ä»£ç çš„ç»´æŠ¤æ€§ï¼Œæ‰©å±•æ€§ç­‰å¼Šç«¯ æ‰€ä»¥éœ€è¦å°†å®¢æˆ·ä»£ç ä¸å¤æ‚çš„å¯¹è±¡å®¹å™¨ç»“æ„è§£è€¦ï¼Œè®©å®¢æˆ·ä¸ç®¡æ˜¯å¤„ç†ä»€ä¹ˆæ ·çš„ç»“æ„éƒ½è°ƒç”¨ç»Ÿä¸€çš„æ¥å£ç®€å•å¤„ç†ï¼Œä¸ä¼šå› ä¸ºå¯¹è±¡å†…éƒ¨æ•°æ®ç»“æ„çš„å˜åŒ–è€Œå‘ç”Ÿå˜åŒ– å‡è®¾æœ‰ä¸€ä¸ªéœ€æ±‚éœ€è¦å¤„ç†å•ä¸ªå¶å­èŠ‚ç‚¹ï¼Œä¹Ÿè¦å¤æ‚èŠ‚ç‚¹(listé›†åˆ è£…æœ‰å¤šä¸ªèŠ‚ç‚¹) æ¨¡å¼å®šä¹‰ â€‹\tå°†å¯¹è±¡ç¥–è¾ˆæˆå±æ€§ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ï¼ŒCompositeæ˜¯çš„ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡è¿˜æ˜¯ç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§(ç¨³å®š)ã€‚\nå…¶å®å°±æ˜¯å•ä¸ªå¯¹è±¡ ç»„åˆå¯¹è±¡éƒ½ç»§æ‰¿åŒä¸€ä¸ªåŸºç±»ï¼Œå®ç°åŒä¸€ä¸ªå…¬å…±æ¥å£ï¼Œè¿™æ ·ç”¨å¤šæ€å®ç°ï¼Œå®¢æˆ·ç«¯çš„è°ƒç”¨å°±æ˜¯ä¸€è‡´çš„ï¼Œä¸ç”¨é¢‘ç¹æ”¹å˜ã€‚ ç»“æ„å›¾è§£ ä»£ç  Compositeç»„åˆæ¨¡å¼c++\n#include #include #include #include using namespace std; //ç»„ä»¶åŸºç±» å®šä¹‰å…¬ç”¨æ¥å£ è¿™äº›æ¥å£å¾€å¾€æ˜¯ç›´æ¥æš´æ¼ç»™å®¢æˆ·çš„ class Component { public: virtual void process() = 0; virtual ~Component(){} }; //æ”¯æŒå¤æ‚ç»“æ„çš„å¤„ç† ç»§æ‰¿ç»„ä»¶åŸºç±» å®ç°processå…¬å…±å¤–éƒ¨æ¥å£ class Composite : public Component{ string name; list\u003cComponent*\u003e elements; public: Composite(const string \u0026 s) : name(s) {} //å› ä¸ºå†…éƒ¨æ˜¯ä¸€ä¸ªlisté›†åˆï¼Œæ‰€ä»¥éœ€è¦add removeæ–¹æ³• addçš„å¯ä»¥æ˜¯ç®€å•èŠ‚ç‚¹ ä¹Ÿå¯ä»¥è¿˜æ˜¯ä¸€ä¸ªlist void add(Component* element) { elements.push_back(element); } void remove(Component* element){ elements.remove(element); } //å®ç°å…¬å…±å¤–éƒ¨æ¥å£ void process(){ //1. process current node //2. process leaf nodes å¾ªç¯å¯¹listå†…éƒ¨çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½å¤„ç† for (auto \u0026e : elements) e-\u003eprocess(); //å¤šæ€è°ƒç”¨ } }; //å¶å­èŠ‚ç‚¹ ç®€å•èŠ‚ç‚¹ ä¹Ÿå®ç°processå…¬å…±æ¥å£ class Leaf : public Component{ string name; public: Leaf(string s) : name(s) {} //å®ç°å…¬å…±processæ¥å£ void process(){ //process current node } }; // å®¢æˆ·ç«¯çš„è°ƒç”¨ void Invoke(Component \u0026 c){ //... c.process();//è¿™é‡Œå®¢æˆ·ç«¯ä¸ç”¨å…³å¿ƒç»„ä»¶åˆ°åº•æ˜¯ç®€å•èŠ‚ç‚¹è¿˜æ˜¯é›†åˆå¤æ‚èŠ‚ç‚¹ ç”¨å¤šæ€å®ç°äº†ç»Ÿä¸€çš„å¤„ç† //å¦‚æœè¿™é‡Œä¸ç”¨å¤šæ€ï¼Œå®¢æˆ·å°±è¦åŒºåˆ†åˆ°åº•æ˜¯ç®€å•èŠ‚ç‚¹è¿˜æ˜¯listé›†åˆï¼Œé’ˆå¯¹listé›†åˆè¦åšæƒ³è¦çš„å¾ªç¯éå†å¤„ç†ï¼ŒæŠŠå¯¹è±¡çš„æ›´å¤šç»†èŠ‚æš´æ¼ç»™å®¢æˆ· //åŒæ—¶å¦‚æœlistæ•°æ®ç»“æ„å‘ç”Ÿäº†å˜åŒ– æ¯”å¦‚æ”¹ä¸ºäº†setå®ç°ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯çš„ä»£ç ä¹Ÿè¦è·Ÿç€æ”¹å˜ è¿™æ˜¯éå¸¸ç³Ÿç³•çš„ã€‚ } int main() { Composite root(\"root\"); Composite treeNode1(\"treeNode1\"); Composite treeNode2(\"treeNode2\"); Composite treeNode3(\"treeNode3\"); Composite treeNode4(\"treeNode4\"); Leaf leat1(\"left1\"); Leaf leat2(\"left2\"); root.add(\u0026treeNode1); treeNode1.add(\u0026treeNode2); treeNode2.add(\u0026leaf1); root.add(\u0026treeNode3); treeNode3.add(\u0026treeNode4); treeNode4.add(\u0026leaf2); //å®¢æˆ·ç«¯ä¸è®ºæ˜¯å¤„ç†å¤æ‚èŠ‚ç‚¹è¿˜æ˜¯å¶å­èŠ‚ç‚¹ ä»£ç ä¿æŒä¸€ç›´ç¨³å®š ä¸ç”¨ç†ä¼šç»„ä»¶å¯¹è±¡å†…éƒ¨æ•°æ®ç»“æ„å®¹å™¨å®ç°çš„å˜åŒ– Invoke(root); Invoke(leaf2); Invoke(treeNode3); } è¦ç‚¹æ€»ç»“ Compositeæ¨¡å¼é‡‡ç”¨æ ‘å½¢ç»“æ„å®ç°éƒ¨ç‰‡å­˜åœ¨çš„å¯¹è±¡å®¹å™¨ï¼Œä»è€Œå°†ä¸€å¯¹å¤š å˜ä¸ºâ€œä¸€å¯¹ä¸€â€ï¼Œå…¶å®ä¹Ÿå°±æ˜¯åŸå…ˆå¯¹å¤šä¸ªå¯¹è±¡ï¼Œç°åœ¨å˜ä¸ºå¯¹ä¸€ä¸ªåŸºç±»ï¼Œè®©åŸå…ˆçš„å¤šä¸ªå¯¹è±¡éƒ½ç»§æ‰¿åŒä¸€ä¸ªåŸºç±»((æ‹¥æœ‰åŒæ ·çš„å…¬å…±æ¥å£))ï¼Œè¿™æ ·å®¢æˆ·å°±ä¸ç”¨å…³å¿ƒæŸä¸ªå¤æ‚å¯¹è±¡å†…éƒ¨çš„æ•°æ®ç»“æ„å®ç°ï¼Œä¹Ÿä¸ä¼šå› ä¸ºå…¶æ•°æ®ç»“æ„çš„å˜åŠ¨è€Œå¯¼è‡´å®¢æˆ·ç«¯ä»£ç ä¿®æ”¹ã€‚ Compositeæ¨¡å¼åœ¨å…·ä½“å®ç°ä¸­ï¼Œå¯ä»¥è®©è´Ÿå¯¹è±¡ä¸­çš„å­å¯¹è±¡åå‘è¿½æº¯ï¼Œå¦‚æœè´Ÿå¯¹è±¡æœ‰é¢‘ç¹çš„éå†éœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ç¼“å­˜æ¥æ”¹å–„æ•ˆç‡ è¿­ä»£å™¨æ¨¡å¼Iteratorâ€”æ•°æ®ç»“æ„ éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº è½¯ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼Œé›†åˆå¯¹è±¡å†…éƒ¨ç»“æ„å¸¸å¸¸å˜åŒ–å„å¼‚ï¼Œä½†å¯¹äºè¿™äº›é›†åˆå¯¹è±¡ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æš´æ¼å…¶å†…éƒ¨æ•°æ®ç»“æ„ï¼Œè€Œä¸”å¸Œæœ›æä¾›ä¸€ä¸ªä¸€è‡´çš„æ¥å£è®©å®¢æˆ·è®¿é—®ï¼ŒåŒæ—¶å¦‚æœæä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œå°±æœ‰å¯èƒ½æä¾›ç»Ÿä¸€çš„ç®—æ³• ä½¿ç”¨é¢å‘å¯¹è±¡æŠ€æœ¯(ä¹Ÿå°±æ˜¯å¤šæ€ æœ‰ä¸ªè¿­ä»£å™¨åŸºç±»ï¼Œå®šä¹‰ç»Ÿä¸€çš„å‡ ä¸ªæ¥å£ï¼Œè®©ä¸åŒçš„é›†åˆè¿­ä»£å™¨å¯¹è±¡éƒ½ç»§æ‰¿è¿™ä¸ªåŸºç±»ï¼Œå®ç°å…¶æ–¹æ³•å³å¯) æ¨¡å¼å®šä¹‰ æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œä¸æš´æ¼(ç¨³å®š)è¯¥å¯¹è±¡å†…éƒ¨çš„è¡¨ç¤º(å®ç°ç»†èŠ‚ æ¯”å¦‚æŸäº›æ•°æ®ç»“æ„) ç»“æ„å›¾è§£ ä»£ç  //è¿­ä»£å™¨åŸºç±» å®šä¹‰å…¬å…±æ“ä½œæ¥å£ å¯¹å®¢æˆ·æš´æ¼ template\u003ctypename T\u003e class Iterator { public: virtual void first() = 0; virtual void next() = 0; virtual bool isDone() const = 0; virtual T\u0026 current() = 0; }; //ç”ŸæˆæŸä¸€ä¸ªç±»å‹çš„è¿­ä»£å™¨ template\u003ctypename T\u003e class MyCollection{ public: Iterator\u003cT\u003e GetIterator(){ //... } }; //å…·ä½“çš„è¿­ä»£å…¶å­ç±»å®ç° ç»§æ‰¿è¿­ä»£å™¨åŸºç±» å®ç°å…¬å…±æ¥å£ template\u003ctypename T\u003e class CollectionIterator : public Iterator\u003cT\u003e{ MyCollection\u003cT\u003e mc; public: CollectionIterator(const MyCollection\u003cT\u003e \u0026 c): mc(c){ } void first() override { } void next() override { } bool isDone() const override{ } T\u0026 current() override{ } }; //è°ƒç”¨ void MyAlgorithm() { MyCollection\u003cint\u003e mc;//æŸä¸€ä¸ªé›†åˆ Iterator\u003cint\u003e iter= mc.GetIterator();//é’ˆå¯¹æŸä¸€ä¸ªé›†åˆåˆ›å»ºè¿­ä»£å™¨å¯¹è±¡ for (iter.first(); !iter.isDone(); iter.next()){//éå† cout \u003c\u003c iter.current() \u003c\u003c endl; } //è¿™é‡Œæ¯æ¬¡è°ƒç”¨éƒ½æ˜¯å¤šæ€ å°±è¦æ‰¾åˆ°è™šå‡½æ•°æŒ‡é’ˆ å¦‚æœé‡å¤ªå¤§ï¼Œ //è¿™ä¸ªæ•ˆç‡å°±ä¼šæœ‰é—®é¢˜ æ‰€ä»¥c++ STLçš„è¿­ä»£å™¨éƒ½æ˜¯ç”¨æ¨¡ç‰ˆå®ç°äº† ä¹Ÿå°±æ˜¯ç¼–è¯‘æ—¶å¤šæ€ï¼Œè€Œä¸æ˜¯è¿è¡Œæ—¶å¤šæ€ } è¦ç‚¹æ€»ç»“ å› ä¸ºè™šå‡½æ•°åœ¨æ€§èƒ½ä¸Šçš„æ¶ˆè€—ï¼Œç°ä»£c++ STLåº“çš„è¿­ä»£å™¨éƒ½æ˜¯ç”¨æ¨¡ç‰ˆå®ç°çš„ï¼Œä¹Ÿå°±æ˜¯ç¼–è¯‘æ—¶å¤šæ€ï¼Œè€Œä¸æ˜¯è¿è¡Œæ—¶å¤šæ€ ä½†æ€æƒ³æ—¶ä¸€è‡´çš„ è¿­ä»£å¤šæ€ä¸ºéå†ä¸åŒçš„é›†åˆç»“æ„æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œä»è€Œæ”¯æŒåŒæ ·çš„ç®—æ³•åœ¨ä¸åŒå’Œé›†åˆç»“æ„ä¸Šæ“ä½œ ä½¿ç”¨è¿­ä»£å™¨ä¸€å®šè¦è€ƒè™‘å¥å£®æ€§ï¼Œéå†çš„åŒæ—¶å¦‚æœæ›´æ”¹äº†æ‰€åœ¨çš„é›†åˆç»“æ„ï¼Œå¾ˆå¯èƒ½å‡ºé—®é¢˜ï¼Œå› ä¸ºå†…å­˜å·²ç»å‘ç”Ÿå˜åŒ–ï¼Œå¤§éƒ¨åˆ†è¿­ä»£å™¨æ˜¯åªè¯»çš„ã€‚ èŒè´£é“¾ChainOfResponsibilityâ€”æ•°æ®ç»“æ„ éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº å¦‚æœä½ çš„é¡¹ç›®ä¸­ä¸€ä¸ªè¯·æ±‚å¯èƒ½ä¼šè¢«å¤šä¸ªå¯¹è±¡å¤„ç†ï¼Œä½†æ˜¯æ¯ä¸ªè¯·æ±‚åœ¨è¿è¡Œæ—¶åªèƒ½æœ‰ä¸€ä¸ªæ¥æ”¶è€…ï¼Œå¦‚æœæ˜¾ç¤ºæŒ‡å®šï¼Œå°†å¿…ä¸å¯å°‘çš„å¸¦æ¥æƒ…è¶£å‘é€è€…ä¸æ¥å—è€…çš„ç´§è€¦åˆ å¦‚ä½•è®©è¯·æ±‚çš„å‘é€è€…ä¸éœ€è¦æŒ‡å®šå…·ä½“çš„æ¥å—è€…ï¼Ÿ æ¨¡å¼å®šä¹‰ å®šä¹‰ä¸€ä¸ªè¯·æ±‚å¤„ç†åŸºç±»ï¼Œå®šä¹‰å…¬å…±å¤„ç†æ¥å£ï¼ŒåŒæ—¶æœ‰ä¸€ä¸ªåŸºç±»æŒ‡é’ˆnext è¿è¡Œæ—¶å¯ä»¥æŒ‡å‘å…·ä½“çš„è¯·æ±‚å¤„ç†å­ç±»ï¼Œè¿™æ ·å°±å¯ä»¥å½¢æˆä¸€ä¸ªé“¾æ¡ï¼Œç¬¬ä¸€ä¸ªä¸å¤„ç†æ‰”ç»™ä¸‹ä¸€ä¸ªï¼Œå¯¹æ¯ä¸ªå…·ä½“çš„å¤„ç†å­ç±»éƒ½æœ‰è¿™æ ·çš„å¤„ç†é€»è¾‘ï¼Œè¿™æ ·åšå°±è¾¾åˆ°äº†ä¸å¿…æŒ‡å®šå…·ä½“çš„å¤„ç†è€…ã€‚ æ²¿ç€å¯¹è±¡çš„ä¸€æ¡é“¾ ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ï¼Œå°±æƒ³æ•°æ®ç»“æ„çš„é“¾è¡¨ä¸€æ ·ã€‚ ç»“æ„å›¾è§£ ä»£ç  ChainOfResponsibilityèŒè´£é“¾æ¨¡å¼ c++\n#include #include using namespace std; //è¯·æ±‚æšä¸¾ç±»å‹ enum class RequestType { REQ_HANDLER1, REQ_HANDLER2, REQ_HANDLER3 }; //è¯·æ±‚å¯¹è±¡å®šä¹‰ class Reqest { string description; RequestType reqType; public: Reqest(const string \u0026 desc, RequestType type) : description(desc), reqType(type) {} RequestType getReqType() const { return reqType; } const string\u0026 getDescription() const { return description; } }; //èŒè´£é“¾åŸºç±» å®šä¹‰æ¥å£ æœ‰ä¸ªæŒ‡å‘è‡ªå·±çš„æŒ‡é’ˆ(è¿è¡Œæ—¶çµæ´»æŒ‡æ´¾ä¸‹ä¸€ä¸ªå¤„ç†è´£ä»»ä¸»ä½“) class ChainHandler{ ChainHandler *nextChain; //å°†è¯·æ±‚å‘é€ä¸ªé“¾æ¡ä¸Šä¸‹ä¸€ä¸ªå¤„ç†è´£ä»»ä¸»ä½“ void sendReqestToNextHandler(const Reqest \u0026 req) { if (nextChain != nullptr) nextChain-\u003ehandle(req); } protected: virtual bool canHandleRequest(const Reqest \u0026 req) = 0; virtual void processRequest(const Reqest \u0026 req) = 0; public: ChainHandler() { nextChain = nullptr; } void setNextChain(ChainHandler *next) { nextChain = next; } //å…¬å…±å¤„ç†æ¥å£ void handle(const Reqest \u0026 req) { if (canHandleRequest(req))//å¦‚æœè‡ªå·±èƒ½å¤„ç† åˆ™ç›´æ¥å¤„ç†è¯·æ±‚ processRequest(req); else sendReqestToNextHandler(req);//å¦åˆ™ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå¤„ç†è´£ä»»ä¸»ä½“ } }; //å®é™…å¤„ç†ä¸»ä½“1 ç»§æ‰¿èŒè´£é“¾å¤„ç†åŸºç±» class Handler1 : public ChainHandler{ protected: bool canHandleRequest(const Reqest \u0026 req) override { return req.getReqType() == RequestType::REQ_HANDLER1; } void processRequest(const Reqest \u0026 req) override { cout \u003c\u003c \"Handler1 is handle reqest: \" \u003c\u003c req.getDescription() \u003c\u003c endl; } }; //å®é™…å¤„ç†ä¸»ä½“2 ç»§æ‰¿èŒè´£é“¾å¤„ç†åŸºç±» class Handler2 : public ChainHandler{ protected: bool canHandleRequest(const Reqest \u0026 req) override { return req.getReqType() == RequestType::REQ_HANDLER2; } void processRequest(const Reqest \u0026 req) override { cout \u003c\u003c \"Handler2 is handle reqest: \" \u003c\u003c req.getDescription() \u003c\u003c endl; } }; //å®é™…å¤„ç†ä¸»ä½“3 ç»§æ‰¿èŒè´£é“¾å¤„ç†åŸºç±» class Handler3 : public ChainHandler{ protected: bool canHandleRequest(const Reqest \u0026 req) override { return req.getReqType() == RequestType::REQ_HANDLER3; } void processRequest(const Reqest \u0026 req) override { cout \u003c\u003c \"Handler3 is handle reqest: \" \u003c\u003c req.getDescription() \u003c\u003c endl; } }; //è°ƒç”¨ç¤ºæ„ int main(){ Handler1 h1; Handler2 h2; Handler3 h3; h1.setNextChain(\u0026h2); h2.setNextChain(\u0026h3); Reqest req(\"process task ... \", RequestType::REQ_HANDLER3);//è¿™é‡Œçœ‹ç€ç®€å• è¿è¡Œç€è¿™ä¸ªå¯¹è±¡å¯èƒ½è¡¨å¤æ‚ æˆ–è€…æ¯”è¾ƒå¤šï¼Œéƒ½ç›´æ¥æ˜¾ç¤ºæŒ‡å®šè€¦åˆå¤ªå¤š h1.handle(req);//è°ƒç”¨çš„æ—¶å€™ä¸ç”¨æŒ‡å®šå…·ä½“çš„è´£ä»»ä¸»ä½“ return 0; } è¦ç‚¹æ€»ç»“ èŒè´£é“¾æ¨¡å¼çš„åº”ç”¨ï¼Œè®©å¯¹è±¡èŒè´£åˆ†æ´¾æ›´å…·æœ‰çµæ´»æ€§ å¦‚æœæœ€åä¸€ä¸ªè¯·æ±‚å¤„ç†ä¸»ä½“ä¹Ÿä¸èƒ½å¤„ç†ï¼Œåº”è¯¥æœ‰ä¸€ä¸ªå‘Šè­¦æˆ–è€…ç¼ºçœçš„å¤„ç†æœºåˆ¶ã€‚è¿™ä¹Ÿæ˜¯æ¯ä¸€ä¸ªæ¥å—è¯·æ±‚å¯¹è±¡çš„è´£ä»»ï¼Œè€Œä¸æ˜¯å‘é€è¯·æ±‚å¯¹è±¡çš„è´£ä»» å½“ç„¶è´£ä»»é“¾æ¨¡å¼å¾ˆå®¹æ˜“ç›´æ¥ç”¨æ•°æ®ç»“æ„å®ç°äº†ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯è¿™ä¸ªæ¨¡å¼ä¸æ€ä¹ˆæµè¡Œçš„åŸå›  æ¯”è¾ƒç®€ç­” ä½†æ€æƒ³å¯ä»¥å€Ÿé‰´ å‘½ä»¤æ¨¡å¼Commandâ€”è¡Œä¸ºå˜åŒ– éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº è½¯ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼Œâ€œè¡Œä¸ºè¯·æ±‚è€…â€å’Œâ€œè¡Œä¸ºå®ç°è€…â€é€šå¸¸å‘ˆç°ä¸€ç§ç´§è€¦åˆ(å¯¹è±¡å’Œæˆå‘˜å‡½æ•°)ï¼Œä½†åœ¨æŸäº›åœºåˆï¼Œæ¯”å¦‚è¦å¯¹è¡Œä¸ºè¿›è¡Œâ€œè®°å½•ã€æ’¤é”€ã€é‡åš(undo/redo)ã€äº‹åŠ¡â€ç­‰å¤„ç†ï¼Œè¿™ç§ç´§è€¦åˆæ— æ³•æŠµå¾¡å˜åŒ–ã€‚ æ€ä¹ˆæ ·æ‰èƒ½å°†â€œè¡Œä¸ºè¯·æ±‚è€…â€ä¸â€œè¡Œä¸ºå®ç°è€…â€è§£è€¦ï¼Ÿ æ¨¡å¼å®šä¹‰ å°†ä¸€ä¸ªè¯·æ±‚(è¡Œä¸ºã€æˆ–è€…ç›´æ¥è¯´æˆå‘˜å‡½æ•°)å°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿ä½ å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼Œè¯·è¯·æ±‚æ’é˜Ÿæˆ–è€…è®°å½•æ—¥å¿—ã€æ’¤é”€ç­‰ç­‰ã€‚ ç»“æ„å›¾è§£ ä»£ç  Commandå‘½ä»¤æ¨¡å¼c++\n#include #include #include using namespace std; //å‘½ä»¤åŸºç±»å®šä¹‰æ¥å£æ–¹æ³• class Command { public: virtual void execute() = 0; }; //å‘½ä»¤1å®ç° class ConcreteCommand1 : public Command { string arg; public: ConcreteCommand1(const string \u0026 a) : arg(a) {} void execute() override { cout\u003c\u003c \"#1 process...\"\u003c\u003carg\u003c\u003cendl; } }; //å‘½ä»¤2å®ç° class ConcreteCommand2 : public Command { string arg; public: ConcreteCommand2(const string \u0026 a) : arg(a) {} void execute() override { cout\u003c\u003c \"#2 process...\"\u003c\u003carg\u003c\u003cendl; } }; //ç»„åˆå‘½ä»¤å®ç° class MacroCommand : public Command { vector\u003cCommand*\u003e commands; public: void addCommand(Command *c) { commands.push_back(c); } void execute() override { for (auto \u0026c : commands) { c-\u003eexecute(); } } }; int main() { //æ‰§è¡ŒæŸäº›å‘½ä»¤æ“ä½œå°±å˜æˆäº† æ„é€ æŸäº›å¯¹è±¡ ç„¶åæ‰§è¡Œå…¶ç›¸åº”æ–¹æ³• ConcreteCommand1 command1(receiver, \"Arg ###\"); ConcreteCommand2 command2(receiver, \"Arg $$$\"); MacroCommand macro; macro.addCommand(\u0026command1); macro.addCommand(\u0026command2); macro.execute(); } è¦ç‚¹æ€»ç»“ Commandæ¨¡å¼ç›®çš„æ˜¯å°†â€œè¡Œä¸ºè¯·æ±‚è€…â€å’Œâ€è¡Œä¸ºå®ç°è€…â€œè§£è€¦ï¼Œåœ¨é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œå¸¸è§çš„æ‰‹æ®µæ˜¯\"â€œå°†è¡Œä¸ºæŠ½è±¡ä¸ºå¯¹è±¡â€ è¿™ä¸ªæ¨¡å¼è·Ÿc++çš„å‡½æ•°å¯¹è±¡åˆäº›ç±»ä¼¼ï¼Œç›¸æ¯”Commandæ¨¡å¼æ¥å£æ›´è§„èŒƒï¼Œä½†å‡½æ•°å¯¹è±¡ä½¿ç”¨æ›´åŠ çµæ´»ï¼Œç°ä»£å·¥ç¨‹å‡½æ•°å¯¹è±¡ç”¨çš„æ›´å¤š æ‰€è°“å‡½æ•°å¯¹è±¡å°±æ˜¯ä¸€ä¸ªclasså¯¹è±¡é‡è½½äº†()è¿ç®—ç¬¦ï¼Œæ‰€ä»¥å¯¹è±¡åç§°åŠ ä¸Š()å°±ç›¸å½“äºè°ƒç”¨äº†ä¸€ä¸ªå‡½æ•° è®¿é—®å™¨æ¨¡å¼Visitorâ€”-è¡Œä¸ºå˜åŒ– éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº ç”±äºéœ€æ±‚çš„æ”¹å˜ã€æŸäº›ç±»å±‚æ¬¡ç»“æ„å¸¸å¸¸éœ€è¦å¢åŠ æ–°çš„è¡Œæ–‡(å¯¹è±¡æˆå‘˜æ–¹æ³•)ï¼Œå¦‚æœè€ƒè™‘åŸºç±»å­ç±»çš„å®ç°æ–¹å¼ï¼Œéœ€è¦åœ¨åŸºç±»ã€å­ç±»éƒ½æ·»åŠ å¯¹åº”çš„æ–¹æ³•ï¼Œå¦‚æœç›´æ¥åœ¨åŸºç±»ä¿®æ”¹ï¼Œå°†ä¼šç»™å­ç±»å¸¦æ¥ç¹é‡çš„è´Ÿæ‹…ï¼Œç”šè‡³ç ´ååŸè®¾è®¡ å¦‚ä½•åœ¨ä¸æ”¹å˜ç±»å±‚æ¬¡ç»“æ„çš„å‰æä¸‹ï¼Œåœ¨è¿è¡Œæ—¶é€æ˜åœ°ä¸ºç±»å±‚æ¬¡ç»“æ„çš„å„ä¸ªç±»åŠ¨æ€çš„æ·»åŠ æ–°çš„è¡Œä¸ºæ“ä½œï¼Ÿ æ¨¡å¼å®šä¹‰ è¡¨ç¤ºä¸€ä¸ªä½œç”¨äºæŸä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œï¼Œä½¿å¾—å¯ä»¥åœ¨ä¸æ”¹å˜(ç¨³å®š)ä¸ªå…ƒç´ çš„ç±»çš„å‰æä¸‹å®šä¹‰(æ‰©å±•)ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œ(è¡Œä¸º) é‡‡ç”¨äºŒæ¬¡åˆ†å‘çš„æ–¹å¼å®ç° ä½†å‰ææ˜¯åŸºç±»çš„å­ç±»éå¸¸ç¡®å®š ä¸ä¼šç»å¸¸å˜åŒ–ï¼Œæ˜¯å­ç±»çš„è¡Œä¸ºç»å¸¸å˜åŒ–ã€‚ ç»“æ„å›¾è§£ ä»£ç  #include using namespace std; //ä¸šåŠ¡åŸºç±» åˆšå¼€å§‹æœ‰2ä¸ªæ–¹æ³• class Element { public: virtual void Func1() = 0; virtual void Func2(int data)=0; virtual void Func3(int data)=0;//éšç€é¡¹ç›®å‘å±• è¦ä¸åœçš„å¢åŠ æ–¹æ³• é‚£ä¹ˆå°±éœ€è¦ä¿®æ”¹åŸºç±»ç„¶åä¿®æ”¹æ¯ä¸€ä¸ªå­ç±» //... virtual ~Element(){} }; class ElementA : public Element { public: void Func1() override{ //... } void Func2(int data) override{ //... } //è¿™é‡Œæ·»åŠ Func3 }; class ElementB : public Element { public: void Func1() override{ //*** } void Func2(int data) override { //*** } //è¿™é‡Œæ·»åŠ Func3 Func4.... }; Visitorè®¿é—®å™¨æ¨¡å¼\n#include using namespace std; //å…ˆå£°æ˜ class Visitor; //ä¸šåŠ¡åŸºç±» class Element { public: virtual void accept(Visitor\u0026 visitor) = 0; //ç¬¬ä¸€æ¬¡å¤šæ€è¾¨æ virtual ~Element(){} }; //ä¸šåŠ¡å­ç±»A class ElementA : public Element { public: void accept(Visitor \u0026visitor) override { visitor.visitElementA(*this); } }; //ä¸šåŠ¡å­ç±»B class ElementB : public Element { public: void accept(Visitor \u0026visitor) override { visitor.visitElementB(*this); //ç¬¬äºŒæ¬¡å¤šæ€è¾¨æ } }; //è®¿é—®å™¨åŸºç±» å®šä¹‰å¥½è®¿é—®æ¯ä¸ªå­ä¸šåŠ¡ç±»çš„æ¥å£ åé¢æœ‰å„ä¸ªè®¿é—®å™¨å®ç°(ä¸ºæ¯ä¸ªå­ç±»å¢åŠ æˆå‘˜æ–¹æ³•) class Visitor{ public: virtual void visitElementA(ElementA\u0026 element) = 0; virtual void visitElementB(ElementB\u0026 element) = 0; virtual ~Visitor(){} }; //==========================ä¸Šè¿°å¦‚æœåªæœ‰2ä¸ªå­ç±» éšä¾¿æ·»åŠ æ–¹æ³• ä»¥ä¸Šç¨³å®š============================== //æ‰©å±•1 ä¸ºå­ç±»å¢åŠ ä¸€ä¸ªæˆå‘˜æ–¹æ³• class Visitor1 : public Visitor{ public: void visitElementA(ElementA\u0026 element) override{ cout \u003c\u003c \"Visitor1 is processing ElementA\" \u003c\u003c endl; } void visitElementB(ElementB\u0026 element) override{ cout \u003c\u003c \"Visitor1 is processing ElementB\" \u003c\u003c endl; } }; //æ‰©å±•2 ä¸ºå­ç±»å¢åŠ å†ä¸€ä¸ªæˆå‘˜æ–¹æ³• class Visitor2 : public Visitor{ public: void visitElementA(ElementA\u0026 element) override{ cout \u003c\u003c \"Visitor2 is processing ElementA\" \u003c\u003c endl; } void visitElementB(ElementB\u0026 element) override{ cout \u003c\u003c \"Visitor2 is processing ElementB\" \u003c\u003c endl; } }; //æ‰©å±•3 ä¸ºå­ç±»å¢åŠ å†ä¸€ä¸ªæˆå‘˜æ–¹æ³• class Visitor3 : public Visitor{}; int main() { Visitor2 visitor; ElementB elementB; elementB.accept(visitor);// double dispatch ç›®çš„å®ç°è°ƒç”¨elementBå¯¹åº”Visitor2å®šä¹‰çš„æˆå‘˜æ–¹æ³• ElementA elementA; elementA.accept(visitor);// double dispatch ç›®çš„å®ç°è°ƒç”¨elementAå¯¹åº”Visitor2å®šä¹‰çš„æˆå‘˜æ–¹æ³• return 0; } è¦ç‚¹æ€»ç»“ é€šè¿‡åŒé‡åˆ†å‘æœºåˆ¶(double dispatch)æ¥å®ç°åœ¨ä¸æ›´æ–°ä¸šåŠ¡ç±»(Element)ç±»å±‚æ¬¡ç»“æ„çš„å‰æä¸‹ï¼Œè¿è¡Œæ—¶é€æ˜çš„ä¸ºå„ä¸ªä¸šåŠ¡ç±»å¢åŠ æ–¹æ³• æœ€å¤§ç¼ºç‚¹ ä¸šåŠ¡ç±»çš„å­ç±»æ•°é‡è¦ç¡®å®š è¿™å°±å¯¼è‡´åœ¨ç°å®ä¸–ç•Œå¾ˆéš¾ç”¨åˆ° åªèƒ½ç”¨äºå“ªäº›å­ç±»ä¸ªæ•°ä¸é¢‘ç¹å˜åŒ–ï¼Œä½†æ˜¯æ¯ä¸ªå­ç±»è¡Œä¸ºé¢‘ç¹å˜åŒ–çš„æƒ…å†µ è§£æå™¨æ¨¡å¼Interpreterâ€”é¢†åŸŸè§„åˆ™ éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº å¦‚æœåœ¨æŸä¸€ç‰¹å®šé¢†åŸŸçš„é—®é¢˜æ¯”è¾ƒå¤æ‚ï¼Œç±»ä¼¼çš„ç»“æ„åˆä¸æ–­é‡å¤å‡ºç°ï¼Œå¦‚æœä½¿ç”¨æ™®éçš„å˜æˆæ–¹å¼å®ç°å°†é¢ä¸´éå¸¸é¢‘ç¹çš„å˜åŒ– å¦‚æœèƒ½å¤Ÿå°†è¿™ä¸ªç‰¹å®šé¢†åŸŸçš„é—®é¢˜è¡¨è¾¾ä¸ºæŸç§è¯­æ³•è§„åˆ™ï¼Œç„¶åæ„å»ºä¸€ä¸ªè§£æå™¨è§£é‡Šè¿™æ ·çš„æƒ…å†µï¼Œä»è€Œè§£å†³é—®é¢˜ æ¯”å¦‚è¦å®ç°ä¸€ä¸ªåŠ å‡æ³•çš„è¡¨è¾¾å¼é—®é¢˜ a+b-c+d æ¨¡å¼å®šä¹‰ ç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œå®šä¹‰çš„æ–‡æ³•è¡¨ç¤ºï¼Œå¹¶å®ç°ä¸€ä¸ªè§£é‡Šå™¨æ¥è§£å†³ ç»“æ„å›¾è§£ ä»£ç  Interpreterè§£æå™¨æ¨¡å¼c++\n#include #include #include using namespace std; //è¡¨è¾¾å¼åŸºç±» class Expression { public: //ä¸»è¦æ¥å£ è§£æè¡¨è¾¾å¼ virtual int interpreter(map\u003cchar, int\u003e var)=0; virtual ~Expression(){} }; //å˜é‡è¡¨è¾¾å¼ class VarExpression: public Expression { char key; public: VarExpression(const char\u0026 key) { this-\u003ekey = key; } //å˜é‡è¡¨è¾¾å¼çš„è§£æå°±ç›´æ¥è¿”å›å…¶å†…å­˜å€¼å³å¯ int interpreter(map\u003cchar, int\u003e var) override { return var[key]; } }; //ç¬¦å·è¡¨è¾¾å¼åŸºç±» class SymbolExpression : public Expression { // è¿ç®—ç¬¦å·¦å³ä¸¤ä¸ªå‚æ•° æŠ½è±¡è¯­æ³•å°±æ˜¯æœ‰å·¦å³2ä¸ªè¡¨è¾¾å¼ protected: Expression* left; Expression* right; public: SymbolExpression( Expression* left, Expression* right): left(left),right(right){ } }; //åŠ æ³•è¿ç®—è¡¨è¾¾å¼å®ç° class AddExpression : public SymbolExpression { public: AddExpression(Expression* left, Expression* right): SymbolExpression(left,right){ } //è§£æè§„åˆ™å°±æ˜¯å·¦å³ä¸¤ä¸ªè¡¨è¾¾å¼çš„è§£æå€¼ç›¸åŠ  è¿™ä¸­é—´ä¼šæ¶‰åŠå¤šæ€é€’å½’è°ƒç”¨ int interpreter(map\u003cchar, int\u003e var) override { return left-\u003einterpreter(var) + right-\u003einterpreter(var); } }; //å‡æ³•è¿ç®— class SubExpression : public SymbolExpression { public: SubExpression(Expression* left, Expression* right): SymbolExpression(left,right){ } //è§£æè§„åˆ™å°±æ˜¯å·¦å³ä¸¤ä¸ªè¡¨è¾¾å¼çš„è§£æå€¼ç›¸å‡ è¿™ä¸­é—´ä¼šæ¶‰åŠå¤šæ€é€’å½’è°ƒç”¨ int interpreter(map\u003cchar, int\u003e var) override { return left-\u003einterpreter(var) - right-\u003einterpreter(var); } }; //å®šä¹‰è§£æå™¨ Expression* analyse(string expStr) { stack\u003cExpression*\u003e expStack; Expression* left = nullptr; Expression* right = nullptr; for(int i=0; i\u003cexpStr.size(); i++) { switch(expStr[i]) { case '+': // åŠ æ³•è¿ç®— left = expStack.top(); right = new VarExpression(expStr[++i]); expStack.push(new AddExpression(left, right)); break; case '-': // å‡æ³•è¿ç®— left = expStack.top(); right = new VarExpression(expStr[++i]); expStack.push(new SubExpression(left, right)); break; default: // å˜é‡è¡¨è¾¾å¼ expStack.push(new VarExpression(expStr[i])); } } Expression* expression = expStack.top(); return expression; } void release(Expression* expression){ //é‡Šæ”¾è¡¨è¾¾å¼æ ‘çš„èŠ‚ç‚¹å†…å­˜... } int main(int argc, const char * argv[]) { string expStr = \"a+b-c+d-e\"; map\u003cchar, int\u003e var; var.insert(make_pair('a',5)); var.insert(make_pair('b',2)); var.insert(make_pair('c',1)); var.insert(make_pair('d',6)); var.insert(make_pair('e',10)); Expression* expression= analyse(expStr);//å°†å­—ç¬¦ä¸²è§£ææˆå¯¹è±¡ int result=expression-\u003einterpreter(var);//å¤šæ€è°ƒç”¨è§£ææœ€ç»ˆå€¼ è§£å†³é—®é¢˜ cout\u003c\u003cresult\u003c\u003cendl; release(expression); return 0; } è¦ç‚¹æ€»ç»“ ç°å®é¡¹ç›®ä¸­ç”¨åˆ°çš„ä¸å¤š åªèƒ½è§£å†³è¯­æ³•ç›¸å¯¹ç®€å•çš„é—®é¢˜ å¦åˆ™å¤šæ€è™šå‡½æ•°è°ƒç”¨è¿‡å¤šä¼šäº§ç”Ÿå¾ˆå¤šæ€§èƒ½é—®é¢˜ 23ç§è®¾è®¡æ¨¡å¼æ€»ç»“ ç›®æ ‡ä¸èƒ½å¿˜è®° ç®¡ç†å˜åŒ–ï¼Œæé«˜å¤ç”¨ ä¸¤è€…ä¸»è¦çš„æ‰‹æ®µ åˆ†è§£å’ŒæŠ½è±¡ æ·±åˆ»ç«‹åˆ»8å¤§åŸåˆ™å’Œé‡æ„çš„5ç§æŠ€å·§ è®¾è®¡æ¨¡å¼æœ€ç»ˆå¯èƒ½çš„å¯¹è±¡æ¨¡å‹ æ—¶åˆ»è¦æ³¨æ„å…³æ³¨å˜åŒ–ç‚¹å’Œç¨³å®šç‚¹ å“ªäº›åœºæ™¯ä¸å¤ªé€‚åˆç”¨æ¨¡å¼ ä»£ç å¯è¯»æ€§å¾ˆå·®çš„æ—¶å€™ ä¸å»ºè®®ç›´æ¥ä½¿ç”¨ è¦é¦–å…ˆä¿è¯ä»£ç æœ‰è‰¯å¥½çš„å¯è¯»æ€§ è¿™ä¸ªæ˜¯å‰ææ¡ä»¶ éœ€æ±‚ç†è§£çš„ä¸æ·±åˆ»æ—¶ æ­¤æ—¶ä¸èƒ½æ·±åˆ»ç†è§£å“ªäº›æ˜¯ç¨³å®šç‚¹å’Œå˜åŒ–ç‚¹ å˜åŒ–æ²¡æœ‰æ˜¾ç°çš„æ—¶å€™ ä¹Ÿæ˜¯æ— æ³•æ·±åˆ»ç†è§£å˜åŒ–ç‚¹çš„ æ ¹æœ¬å°±ä¸æ˜¯ç³»ç»Ÿçš„å…³é”®ä¾èµ–ç‚¹ å¯ä»¥ä¸ç”¨èŠ±å¤§çš„ç²¾åŠ›æ¥æŠ˜è…¾è®¾è®¡æ¨¡å¼ é¡¹ç›®æœ¬èº«æ²¡æœ‰ä»»ä½•å¤ç”¨ä»·å€¼ æ²¡æœ‰å¤ç”¨ä»·å€¼ä¹Ÿå°±ä¸ç”¨è€ƒè™‘è®¾è®¡æ¨¡å¼äº† é¡¹ç›®å³å°†å‘å¸ƒçš„æ—¶å€™ å°±ä¸è¦åœ¨æŠ˜è…¾è®¾è®¡æ¨¡å¼äº† åˆ«å†æ•´å‡ºä¸€å¤§å †bug ä¸€äº›ç»éªŒä¹‹è°ˆ ä¸è¦ä¸ºäº†æ¨¡å¼è€Œæ¨¡å¼ è¦é‡è§†æŠ½è±¡ç±»å’Œæ¥å£ ç†æ¸…æ¥šå˜åŒ–ç‚¹å’Œç¨³å®šç‚¹éå¸¸é‡è¦ ç»å¸¸å®¡è§†ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»éå¸¸é‡è¦ Frameworkå’ŒApplicationçš„åŒºéš”æ€ç»´è¦æœ‰ è‰¯å¥½çš„è®¾è®¡éƒ½æ˜¯æ…¢æ…¢æ¼”åŒ–çš„ç»“æœ ä¸èƒ½ä¸€è¹´è€Œå°± æˆé•¿ä¹‹è·¯ â€œæ‰‹ä¸­æ— å‰‘ï¼Œå¿ƒä¸­æ— å‰‘â€ï¼š è§åˆ°æ¨¡å¼ä¸è®¤è¯† â€œæ‰‹ä¸­æœ‰å‰‘ï¼Œå¿ƒä¸­æ— å‰‘â€: å¯ä»¥è¯†åˆ«ä¸åŒçš„æ¨¡å¼ ä½œä¸ºåº”ç”¨å¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨ â€œæ‰‹ä¸­æœ‰å‰‘ï¼Œå¿ƒä¸­æœ‰å‰‘â€ï¼š å¯ä»¥ä½œä¸ºæ¡†æ¶å¼€å‘äººå‘˜åº”ç”¨è®¾è®¡æ¨¡å¼ è®©åˆ«äººç”¨ä½ å¼€å‘çš„äº§å“æ¡†æ¶ â€œæ‰‹ä¸­æ— å‰‘ï¼Œå¿ƒä¸­æœ‰å‰‘â€ï¼š å·²ç»å¿˜è®°äº†æ­»æ¿çš„è®¾è®¡æ¨¡å¼ï¼Œæ·±åˆ»ç†è§£åŸåˆ™ï¼Œç”šè‡³èƒ½å¤Ÿåˆ›é€ æ¨¡å¼ ",
  "wordCount" : "25076",
  "inLanguage": "zh",
  "datePublished": "2020-05-18T22:45:46+08:00",
  "dateModified": "2020-05-18T22:45:46+08:00",
  "author":[{
    "@type": "Person",
    "name": "becool"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://heketong.github.io/posts/tech/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "ç–¯å­çˆ±æ·¡å®š",
    "logo": {
      "@type": "ImageObject",
      "url": "http://heketong.github.io/img/heketong_profile_photo.JPG"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    (function () {
        let  arr,reg = new RegExp("(^| )"+"change-themes"+"=([^;]*)(;|$)");
        if(arr = document.cookie.match(reg)) {
        } else {
            if (new Date().getHours() >= 19 || new Date().getHours() < 6) {
                document.body.classList.add('dark');
                localStorage.setItem("pref-theme", 'dark');
            } else {
                document.body.classList.remove('dark');
                localStorage.setItem("pref-theme", 'light');
            }
        }
    })()

    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://heketong.github.io/" accesskey="h" title="ç–¯å­çˆ±æ·¡å®š (Alt + H)">
            <img src="http://heketong.github.io/img/heketong_profile_photo.JPG" alt="logo" aria-label="logo"
                 height="35">ç–¯å­çˆ±æ·¡å®š</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://heketong.github.io/search" title="ğŸ” æœç´¢ (Alt &#43; /)" accesskey=/>
                <span>ğŸ” æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="http://heketong.github.io/" title="ğŸ  ä¸»é¡µ">
                <span>ğŸ  ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="http://heketong.github.io/posts" title="ğŸ“š æ–‡ç« ">
                <span>ğŸ“š æ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="http://heketong.github.io/tags" title="ğŸ§© æ ‡ç­¾">
                <span>ğŸ§© æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="http://heketong.github.io/archives/" title="â±ï¸ æ—¶é—´è½´">
                <span>â±ï¸ æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="http://heketong.github.io/about" title="ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº">
                <span>ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº</span>
                </a>
            </li>
            <li>
                <a href="http://heketong.github.io/links" title="ğŸ¤ å‹é“¾">
                <span>ğŸ¤ å‹é“¾</span>
                </a>
            </li>
            <li>
                <a href="http://heketong.github.io/categories/" title="ğŸ§© åˆ†ç±»">
                <span>ğŸ§© åˆ†ç±»</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main page">
<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }
</style>

<article class="post-single">
    <div id="single-content">
        <header class="post-header">
            <div class="breadcrumbs"><a href="http://heketong.github.io/">ğŸ  ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="http://heketong.github.io/posts/">ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href="http://heketong.github.io/posts/tech/">ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯</a></div>
            <h1 class="post-title">
                è®¾è®¡æ¨¡å¼
            </h1>
            <div class="post-description">
                è®¾è®¡æ¨¡å¼å­¦ä¹ è®°å½•
            </div>
            <div class="post-meta">

<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }

    .parent-post-meta {
        display: flex;
        flex-wrap: wrap;
        opacity: 0.8;
    }
</style>

<span class="parent-post-meta">
    <span id="post_meta_style_1">
        <span class="fa fa-calendar-check-o"></span>
        <span>2020-05-18
            &nbsp;&nbsp;
        </span>
    </span>
    
    
    
    
    
    
    
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>25076å­—
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>51åˆ†é’Ÿ
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_5">
        <span class="fa fa-user-o"></span>
        <span>becool
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
            <span class="post-tags-meta">
                <a href="http://heketong.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="color: var(--secondary)!important;">è®¾è®¡æ¨¡å¼</a>
            </span>
        </span>
    </span>
</span>
<span style="opacity: 0.8;">
                    <span id="post_meta_style_7">
                        &nbsp;&nbsp;
                        <span class="fa fa-eye" ></span>
                        <span>
                            <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span>
                            &nbsp;&nbsp;
                        </span>
                    </span>
                    <span id="post_meta_style_8">
                        <span class="fa fa-commenting-o"></span>
                        <span>
                            <script src="https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js"></script>
                            <script>
                                let url = document.documentURI
                                
                                let dnsUrl = "http://heketong.github.io/"
                                let urlSplit = url.split(dnsUrl)
                                let finalUrl = urlSplit[1]
                                if (finalUrl[0] !== '/') {
                                    finalUrl = '/'+finalUrl
                                }
                                twikoo.getCommentsCount({
                                    envId:  null , 
                                region:  null , 
                                urls: [ 
                                    
                                    finalUrl,
                                ],
                                    includeReply: false 
                                }).then(function (res) {
                                    let count = res[0].count
                                    const obj = document.getElementById("comment_count");
                                    obj.innerText = count
                                    
                                    
                                    
                                }).catch(function (err) {
                                    
                                    console.error(err);
                                });
                            </script>
                            <span id="comment_count"></span>
                        </span>
                    </span>
                </span>

</div>
        </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e4%bb%8b%e7%bb%8d" aria-label="è®¾è®¡æ¨¡å¼ä»‹ç»">è®¾è®¡æ¨¡å¼ä»‹ç»</a><ul>
                        
                <li>
                    <a href="#%e9%87%8d%e6%9e%84%e7%9a%84%e5%85%b3%e9%94%ae%e6%8a%80%e5%b7%a7" aria-label="é‡æ„çš„å…³é”®æŠ€å·§">é‡æ„çš„å…³é”®æŠ€å·§</a></li></ul>
                </li>
                <li>
                    <a href="#%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1%e8%ae%be%e8%ae%a1%e5%8e%9f%e5%88%99" aria-label="é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™">é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™</a><ul>
                        
                <li>
                    <a href="#%e9%87%8d%e6%96%b0%e8%ae%a4%e8%af%86%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1" aria-label="é‡æ–°è®¤è¯†é¢å‘å¯¹è±¡">é‡æ–°è®¤è¯†é¢å‘å¯¹è±¡</a></li>
                <li>
                    <a href="#1-%e4%be%9d%e8%b5%96%e5%80%92%e7%bd%ae%e5%8e%9f%e5%88%99dip" aria-label="1 ä¾èµ–å€’ç½®åŸåˆ™(DIP)">1 ä¾èµ–å€’ç½®åŸåˆ™(DIP)</a></li>
                <li>
                    <a href="#2-%e5%bc%80%e6%94%be%e5%b0%81%e9%97%ad%e5%8e%9f%e5%88%99ocp" aria-label="2 å¼€æ”¾å°é—­åŸåˆ™(OCP)">2 å¼€æ”¾å°é—­åŸåˆ™(OCP)</a></li>
                <li>
                    <a href="#3-%e5%8d%95%e4%b8%80%e8%81%8c%e8%b4%a3%e5%8e%9f%e5%88%99srp" aria-label="3 å•ä¸€èŒè´£åŸåˆ™(SRP)">3 å•ä¸€èŒè´£åŸåˆ™(SRP)</a></li>
                <li>
                    <a href="#4-liskov%e6%9b%bf%e6%8d%a2%e5%8e%9f%e5%88%99lsp" aria-label="4 Liskovæ›¿æ¢åŸåˆ™(LSP)">4 Liskovæ›¿æ¢åŸåˆ™(LSP)</a></li>
                <li>
                    <a href="#5-%e6%8e%a5%e5%8f%a3%e9%9a%94%e7%a6%bb%e5%8e%9f%e5%88%99isp" aria-label="5 æ¥å£éš”ç¦»åŸåˆ™(ISP)">5 æ¥å£éš”ç¦»åŸåˆ™(ISP)</a></li>
                <li>
                    <a href="#6-%e4%bc%98%e5%85%88%e4%bd%bf%e7%94%a8%e5%af%b9%e8%b1%a1%e7%bb%84%e5%90%88-%e8%80%8c%e4%b8%8d%e6%98%af%e7%b1%bb%e7%bb%a7%e6%89%bf" aria-label="6 ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆ è€Œä¸æ˜¯ç±»ç»§æ‰¿">6 ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆ è€Œä¸æ˜¯ç±»ç»§æ‰¿</a></li>
                <li>
                    <a href="#7-%e5%b0%81%e8%a3%85%e5%8f%98%e5%8c%96%e7%82%b9" aria-label="7 å°è£…å˜åŒ–ç‚¹">7 å°è£…å˜åŒ–ç‚¹</a></li>
                <li>
                    <a href="#8-%e9%92%88%e5%af%b9%e6%8e%a5%e5%8f%a3%e7%bc%96%e7%a8%8b%e4%b8%8d%e8%a6%81%e9%92%88%e5%af%b9%e5%ae%9e%e7%8e%b0%e7%bc%96%e7%a8%8b" aria-label="8 é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œä¸è¦é’ˆå¯¹å®ç°ç¼–ç¨‹">8 é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œä¸è¦é’ˆå¯¹å®ç°ç¼–ç¨‹</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%a8%a1%e7%89%88%e6%96%b9%e6%b3%95template-method---%e7%bb%84%e4%bb%b6%e5%8d%8f%e4%bd%9c" aria-label="æ¨¡ç‰ˆæ–¹æ³•Template method&amp;mdash;ç»„ä»¶åä½œ">æ¨¡ç‰ˆæ–¹æ³•Template method&mdash;ç»„ä»¶åä½œ</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af" aria-label="éœ€æ±‚èƒŒæ™¯ï¼š">éœ€æ±‚èƒŒæ™¯ï¼š</a></li>
                <li>
                    <a href="#%e4%bc%a0%e7%bb%9f%e7%bb%93%e6%9e%84%e5%8c%96%e6%80%9d%e6%83%b3%e5%ae%9e%e7%8e%b0" aria-label="ä¼ ç»Ÿç»“æ„åŒ–æ€æƒ³å®ç°">ä¼ ç»Ÿç»“æ„åŒ–æ€æƒ³å®ç°</a></li>
                <li>
                    <a href="#%e5%8a%a8%e6%9c%ba" aria-label="åŠ¨æœº">åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li>
                <li>
                    <a href="#%e5%87%a0%e5%bc%a0%e5%9b%be%e8%a7%a3" aria-label="å‡ å¼ å›¾è§£">å‡ å¼ å›¾è§£</a></li>
                <li>
                    <a href="#%e6%a8%a1%e7%89%88%e6%96%b9%e6%b3%95%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0" aria-label="æ¨¡ç‰ˆæ–¹æ³•ä»£ç å®ç°">æ¨¡ç‰ˆæ–¹æ³•ä»£ç å®ç°</a></li></ul>
                </li>
                <li>
                    <a href="#%e7%ad%96%e7%95%a5%e6%a8%a1%e5%bc%8f-strategy---%e7%bb%84%e4%bb%b6%e5%8d%8f%e4%bd%9c" aria-label="ç­–ç•¥æ¨¡å¼ strategy&amp;mdash;ç»„ä»¶åä½œ">ç­–ç•¥æ¨¡å¼ strategy&mdash;ç»„ä»¶åä½œ</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af-1" aria-label="éœ€æ±‚èƒŒæ™¯">éœ€æ±‚èƒŒæ™¯</a></li>
                <li>
                    <a href="#%e4%bc%a0%e7%bb%9f%e5%ae%9e%e7%8e%b0" aria-label="ä¼ ç»Ÿå®ç°">ä¼ ç»Ÿå®ç°</a></li>
                <li>
                    <a href="#%e5%8a%a8%e6%9c%ba-1" aria-label="åŠ¨æœº">åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e7%9a%84%e5%ae%9a%e4%b9%89" aria-label="æ¨¡å¼çš„å®šä¹‰">æ¨¡å¼çš„å®šä¹‰</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-1" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li>
                <li>
                    <a href="#%e5%9b%be%e8%a7%a3" aria-label="å›¾è§£">å›¾è§£</a></li>
                <li>
                    <a href="#%e7%ad%96%e7%95%a5%e6%a8%a1%e5%bc%8f%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0" aria-label="ç­–ç•¥æ¨¡å¼ä»£ç å®ç°">ç­–ç•¥æ¨¡å¼ä»£ç å®ç°</a></li></ul>
                </li>
                <li>
                    <a href="#%e8%a7%82%e5%af%9f%e8%80%85%e6%a8%a1%e5%bc%8fobserver---%e7%bb%84%e4%bb%b6%e5%8d%8f%e4%bd%9c" aria-label="è§‚å¯Ÿè€…æ¨¡å¼Observer&amp;mdash;ç»„ä»¶åä½œ">è§‚å¯Ÿè€…æ¨¡å¼Observer&mdash;ç»„ä»¶åä½œ</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af-2" aria-label="éœ€æ±‚èƒŒæ™¯">éœ€æ±‚èƒŒæ™¯</a></li>
                <li>
                    <a href="#%e4%bc%a0%e7%bb%9f%e5%ae%9e%e7%8e%b0-1" aria-label="ä¼ ç»Ÿå®ç°">ä¼ ç»Ÿå®ç°</a></li>
                <li>
                    <a href="#%e5%8a%a8%e6%9c%ba-2" aria-label="åŠ¨æœº">åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e7%9a%84%e5%ae%9a%e4%b9%89-1" aria-label="æ¨¡å¼çš„å®šä¹‰">æ¨¡å¼çš„å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-2" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li>
                <li>
                    <a href="#%e8%a7%82%e5%af%9f%e8%80%85%e6%a8%a1%e5%bc%8f%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0" aria-label="è§‚å¯Ÿè€…æ¨¡å¼ä»£ç å®ç°">è§‚å¯Ÿè€…æ¨¡å¼ä»£ç å®ç°</a></li></ul>
                </li>
                <li>
                    <a href="#%e8%a3%85%e9%a5%b0%e6%a8%a1%e5%bc%8fdecorator---%e5%8d%95%e4%b8%80%e8%81%8c%e8%b4%a3" aria-label="è£…é¥°æ¨¡å¼Decorator&amp;mdash;å•ä¸€èŒè´£">è£…é¥°æ¨¡å¼Decorator&mdash;å•ä¸€èŒè´£</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af-3" aria-label="éœ€æ±‚èƒŒæ™¯">éœ€æ±‚èƒŒæ™¯</a></li>
                <li>
                    <a href="#%e4%bc%a0%e7%bb%9f%e5%ae%9e%e7%8e%b0-2" aria-label="ä¼ ç»Ÿå®ç°">ä¼ ç»Ÿå®ç°</a></li>
                <li>
                    <a href="#%e5%8a%a8%e6%9c%ba-3" aria-label="åŠ¨æœº">åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e7%9a%84%e5%ae%9a%e4%b9%89-2" aria-label="æ¨¡å¼çš„å®šä¹‰">æ¨¡å¼çš„å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-1" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-3" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li>
                <li>
                    <a href="#%e7%ae%80%e6%98%93%e4%bb%a3%e7%a0%81" aria-label="ç®€æ˜“ä»£ç ">ç®€æ˜“ä»£ç </a></li></ul>
                </li>
                <li>
                    <a href="#%e6%a1%a5%e6%a8%a1%e5%bc%8fbridge---%e5%8d%95%e4%b8%80%e8%81%8c%e8%b4%a3" aria-label="æ¡¥æ¨¡å¼Bridge&amp;mdash;å•ä¸€èŒè´£">æ¡¥æ¨¡å¼Bridge&mdash;å•ä¸€èŒè´£</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af-4" aria-label="éœ€æ±‚èƒŒæ™¯">éœ€æ±‚èƒŒæ™¯</a></li>
                <li>
                    <a href="#%e4%bc%a0%e7%bb%9f%e5%ae%9e%e7%8e%b0-3" aria-label="ä¼ ç»Ÿå®ç°">ä¼ ç»Ÿå®ç°</a></li>
                <li>
                    <a href="#%e5%8a%a8%e6%9c%ba-4" aria-label="åŠ¨æœº">åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-1" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-2" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-4" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0" aria-label="ä»£ç å®ç°">ä»£ç å®ç°</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%b7%a5%e5%8e%82%e6%a8%a1%e5%bc%8ffactory---%e5%af%b9%e8%b1%a1%e5%88%9b%e5%bb%ba" aria-label="å·¥å‚æ¨¡å¼factory&amp;mdash;å¯¹è±¡åˆ›å»º">å·¥å‚æ¨¡å¼factory&mdash;å¯¹è±¡åˆ›å»º</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af-5" aria-label="éœ€æ±‚èƒŒæ™¯">éœ€æ±‚èƒŒæ™¯</a></li>
                <li>
                    <a href="#%e4%bc%a0%e7%bb%9f%e5%ae%9e%e7%8e%b0-4" aria-label="ä¼ ç»Ÿå®ç°">ä¼ ç»Ÿå®ç°</a></li>
                <li>
                    <a href="#%e5%8a%a8%e6%9c%ba-5" aria-label="åŠ¨æœº">åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-2" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e5%b7%a5%e5%8e%82%e6%a8%a1%e5%bc%8f%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0" aria-label="å·¥å‚æ¨¡å¼ä»£ç å®ç°">å·¥å‚æ¨¡å¼ä»£ç å®ç°</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-3" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-5" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%8a%bd%e8%b1%a1%e5%b7%a5%e5%8e%82abstractfactory---%e5%af%b9%e8%b1%a1%e5%88%9b%e5%bb%ba" aria-label="æŠ½è±¡å·¥å‚AbstractFactory&amp;mdash;å¯¹è±¡åˆ›å»º">æŠ½è±¡å·¥å‚AbstractFactory&mdash;å¯¹è±¡åˆ›å»º</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af-6" aria-label="éœ€æ±‚èƒŒæ™¯">éœ€æ±‚èƒŒæ™¯</a></li>
                <li>
                    <a href="#%e4%bc%a0%e7%bb%9f%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88" aria-label="ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ">ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ</a></li>
                <li>
                    <a href="#%e7%94%a8%e5%8e%9f%e5%a7%8b%e5%b7%a5%e5%8e%82%e6%96%b9%e6%b3%95%e6%a8%a1%e5%bc%8f%e6%94%b9%e9%80%a0" aria-label="ç”¨åŸå§‹å·¥å‚æ–¹æ³•æ¨¡å¼æ”¹é€ ">ç”¨åŸå§‹å·¥å‚æ–¹æ³•æ¨¡å¼æ”¹é€ </a></li>
                <li>
                    <a href="#%e5%8a%a8%e6%9c%ba-6" aria-label="åŠ¨æœº">åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-3" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-4" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-6" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0-1" aria-label="ä»£ç å®ç°">ä»£ç å®ç°</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%8e%9f%e5%9e%8b%e6%a8%a1%e5%bc%8f-prototype---%e5%af%b9%e8%b1%a1%e5%88%9b%e5%bb%ba" aria-label="åŸå‹æ¨¡å¼ prototype&amp;mdash;å¯¹è±¡åˆ›å»º">åŸå‹æ¨¡å¼ prototype&mdash;å¯¹è±¡åˆ›å»º</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af%e5%8f%8a%e5%8a%a8%e6%9c%ba" aria-label="éœ€æ±‚èƒŒæ™¯åŠåŠ¨æœº">éœ€æ±‚èƒŒæ™¯åŠåŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-4" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-5" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-7" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0-%e5%af%b9%e6%af%94%e5%b7%a5%e5%8e%82%e6%a8%a1%e5%bc%8f%e7%9c%8b" aria-label="ä»£ç å®ç° å¯¹æ¯”å·¥å‚æ¨¡å¼çœ‹">ä»£ç å®ç° å¯¹æ¯”å·¥å‚æ¨¡å¼çœ‹</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%9e%84%e5%bb%ba%e5%99%a8%e6%a8%a1%e5%bc%8fbuilder---%e5%af%b9%e8%b1%a1%e5%88%9b%e5%bb%ba" aria-label="æ„å»ºå™¨æ¨¡å¼Builder&amp;mdash;å¯¹è±¡åˆ›å»º">æ„å»ºå™¨æ¨¡å¼Builder&mdash;å¯¹è±¡åˆ›å»º</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af-7" aria-label="éœ€æ±‚èƒŒæ™¯">éœ€æ±‚èƒŒæ™¯</a></li>
                <li>
                    <a href="#%e4%bc%a0%e7%bb%9f%e5%ae%9e%e7%8e%b0-5" aria-label="ä¼ ç»Ÿå®ç°">ä¼ ç»Ÿå®ç°</a></li>
                <li>
                    <a href="#%e5%8a%a8%e6%9c%ba-7" aria-label="åŠ¨æœº">åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-5" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-6" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0-2" aria-label="ä»£ç å®ç°">ä»£ç å®ç°</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-8" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%8d%95%e4%be%8b%e6%a8%a1%e5%bc%8fsingleton---%e6%80%a7%e8%83%bd%e9%97%ae%e9%a2%98" aria-label="å•ä¾‹æ¨¡å¼singleton&amp;mdash;æ€§èƒ½é—®é¢˜">å•ä¾‹æ¨¡å¼singleton&mdash;æ€§èƒ½é—®é¢˜</a><ul>
                        
                <li>
                    <a href="#%e5%8a%a8%e6%9c%ba-8" aria-label="åŠ¨æœº">åŠ¨æœº</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0-3" aria-label="ä»£ç å®ç°">ä»£ç å®ç°</a></li></ul>
                </li>
                <li>
                    <a href="#%e4%ba%ab%e5%85%83%e6%a8%a1%e5%bc%8fflyweight---%e6%80%a7%e8%83%bd%e9%97%ae%e9%a2%98" aria-label="äº«å…ƒæ¨¡å¼FlyWeight&amp;mdash;æ€§èƒ½é—®é¢˜">äº«å…ƒæ¨¡å¼FlyWeight&mdash;æ€§èƒ½é—®é¢˜</a><ul>
                        
                <li>
                    <a href="#%e5%8a%a8%e6%9c%ba-9" aria-label="åŠ¨æœº">åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-6" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81" aria-label="ä»£ç ">ä»£ç </a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-9" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li></ul>
                </li>
                <li>
                    <a href="#%e9%97%a8%e9%9d%a2%e6%a8%a1%e5%bc%8f-facade---%e6%8e%a5%e5%8f%a3%e9%9a%94%e7%a6%bb" aria-label="é—¨é¢æ¨¡å¼ facade&amp;mdash;æ¥å£éš”ç¦»">é—¨é¢æ¨¡å¼ facade&mdash;æ¥å£éš”ç¦»</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af%e4%b8%8e%e5%8a%a8%e6%9c%ba" aria-label="éœ€æ±‚èƒŒæ™¯ä¸åŠ¨æœº">éœ€æ±‚èƒŒæ™¯ä¸åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-7" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-10" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li></ul>
                </li>
                <li>
                    <a href="#%e4%bb%a3%e7%90%86%e6%a8%a1%e5%bc%8fproxy---%e6%8e%a5%e5%8f%a3%e9%9a%94%e7%a6%bb" aria-label="ä»£ç†æ¨¡å¼Proxy&amp;mdash;æ¥å£éš”ç¦»">ä»£ç†æ¨¡å¼Proxy&mdash;æ¥å£éš”ç¦»</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af%e5%92%8c%e5%8a%a8%e6%9c%ba" aria-label="éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº">éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-8" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-7" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81-1" aria-label="ä»£ç ">ä»£ç </a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-11" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li></ul>
                </li>
                <li>
                    <a href="#%e9%80%82%e9%85%8d%e5%99%a8%e6%a8%a1%e5%bc%8fadapter---%e6%8e%a5%e5%8f%a3%e9%9a%94%e7%a6%bb" aria-label="é€‚é…å™¨æ¨¡å¼Adapter&amp;mdash;æ¥å£éš”ç¦»">é€‚é…å™¨æ¨¡å¼Adapter&mdash;æ¥å£éš”ç¦»</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af%e5%8a%a8%e6%9c%ba" aria-label="éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-9" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-8" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-12" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81-2" aria-label="ä»£ç ">ä»£ç </a></li></ul>
                </li>
                <li>
                    <a href="#%e4%b8%ad%e4%bb%8b%e8%80%85mediator---%e6%8e%a5%e5%8f%a3%e9%9a%94%e7%a6%bb" aria-label="ä¸­ä»‹è€…Mediator&amp;mdash;æ¥å£éš”ç¦»">ä¸­ä»‹è€…Mediator&mdash;æ¥å£éš”ç¦»</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af%e5%92%8c%e5%8a%a8%e6%9c%ba-1" aria-label="éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº">éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-10" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-9" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-13" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li></ul>
                </li>
                <li>
                    <a href="#%e7%8a%b6%e6%80%81%e6%a8%a1%e5%bc%8fstate---%e7%8a%b6%e6%80%81%e5%8f%98%e5%8c%96" aria-label="çŠ¶æ€æ¨¡å¼State&amp;mdash;çŠ¶æ€å˜åŒ–">çŠ¶æ€æ¨¡å¼State&mdash;çŠ¶æ€å˜åŒ–</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af%e5%8a%a8%e6%9c%ba-1" aria-label="éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº</a></li>
                <li>
                    <a href="#%e4%be%8b%e5%ad%90" aria-label="ä¾‹å­">ä¾‹å­</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-11" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-10" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-14" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81-3" aria-label="ä»£ç ">ä»£ç </a></li></ul>
                </li>
                <li>
                    <a href="#%e5%a4%87%e5%bf%98%e5%bd%95memento----%e7%8a%b6%e6%80%81%e5%8f%98%e5%8c%96" aria-label="å¤‡å¿˜å½•Memento&amp;mdash;-çŠ¶æ€å˜åŒ–">å¤‡å¿˜å½•Memento&mdash;-çŠ¶æ€å˜åŒ–</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af%e5%8a%a8%e6%9c%ba-2" aria-label="éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-12" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-11" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-15" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81-4" aria-label="ä»£ç ">ä»£ç </a></li></ul>
                </li>
                <li>
                    <a href="#%e7%bb%84%e5%90%88%e6%a8%a1%e5%bc%8fcomposit---%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84" aria-label="ç»„åˆæ¨¡å¼Composit&amp;mdash;æ•°æ®ç»“æ„">ç»„åˆæ¨¡å¼Composit&mdash;æ•°æ®ç»“æ„</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af%e5%92%8c%e5%8a%a8%e6%9c%ba-2" aria-label="éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº">éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-13" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-12" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81-5" aria-label="ä»£ç ">ä»£ç </a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-16" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li></ul>
                </li>
                <li>
                    <a href="#%e8%bf%ad%e4%bb%a3%e5%99%a8%e6%a8%a1%e5%bc%8fiterator---%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84" aria-label="è¿­ä»£å™¨æ¨¡å¼Iterator&amp;mdash;æ•°æ®ç»“æ„">è¿­ä»£å™¨æ¨¡å¼Iterator&mdash;æ•°æ®ç»“æ„</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af%e5%92%8c%e5%8a%a8%e6%9c%ba-3" aria-label="éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº">éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-14" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-13" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81-6" aria-label="ä»£ç ">ä»£ç </a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-17" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li></ul>
                </li>
                <li>
                    <a href="#%e8%81%8c%e8%b4%a3%e9%93%bechainofresponsibility---%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84" aria-label="èŒè´£é“¾ChainOfResponsibility&amp;mdash;æ•°æ®ç»“æ„">èŒè´£é“¾ChainOfResponsibility&mdash;æ•°æ®ç»“æ„</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af%e5%8a%a8%e6%9c%ba-3" aria-label="éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-15" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-14" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81-7" aria-label="ä»£ç ">ä»£ç </a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-18" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%91%bd%e4%bb%a4%e6%a8%a1%e5%bc%8fcommand---%e8%a1%8c%e4%b8%ba%e5%8f%98%e5%8c%96" aria-label="å‘½ä»¤æ¨¡å¼Command&amp;mdash;è¡Œä¸ºå˜åŒ–">å‘½ä»¤æ¨¡å¼Command&mdash;è¡Œä¸ºå˜åŒ–</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af%e5%8a%a8%e6%9c%ba-4" aria-label="éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-16" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-15" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81-8" aria-label="ä»£ç ">ä»£ç </a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-19" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li></ul>
                </li>
                <li>
                    <a href="#%e8%ae%bf%e9%97%ae%e5%99%a8%e6%a8%a1%e5%bc%8fvisitor----%e8%a1%8c%e4%b8%ba%e5%8f%98%e5%8c%96" aria-label="è®¿é—®å™¨æ¨¡å¼Visitor&amp;mdash;-è¡Œä¸ºå˜åŒ–">è®¿é—®å™¨æ¨¡å¼Visitor&mdash;-è¡Œä¸ºå˜åŒ–</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af%e5%8a%a8%e6%9c%ba-5" aria-label="éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-17" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-16" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81-9" aria-label="ä»£ç ">ä»£ç </a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-20" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li></ul>
                </li>
                <li>
                    <a href="#%e8%a7%a3%e6%9e%90%e5%99%a8%e6%a8%a1%e5%bc%8finterpreter---%e9%a2%86%e5%9f%9f%e8%a7%84%e5%88%99" aria-label="è§£æå™¨æ¨¡å¼Interpreter&amp;mdash;é¢†åŸŸè§„åˆ™">è§£æå™¨æ¨¡å¼Interpreter&mdash;é¢†åŸŸè§„åˆ™</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e8%83%8c%e6%99%af%e5%8a%a8%e6%9c%ba-6" aria-label="éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89-18" aria-label="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%84%e5%9b%be%e8%a7%a3-17" aria-label="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81-10" aria-label="ä»£ç ">ä»£ç </a></li>
                <li>
                    <a href="#%e8%a6%81%e7%82%b9%e6%80%bb%e7%bb%93-21" aria-label="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“</a></li></ul>
                </li>
                <li>
                    <a href="#23%e7%a7%8d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e6%80%bb%e7%bb%93" aria-label="23ç§è®¾è®¡æ¨¡å¼æ€»ç»“">23ç§è®¾è®¡æ¨¡å¼æ€»ç»“</a><ul>
                        
                <li>
                    <a href="#%e7%9b%ae%e6%a0%87%e4%b8%8d%e8%83%bd%e5%bf%98%e8%ae%b0-%e7%ae%a1%e7%90%86%e5%8f%98%e5%8c%96%e6%8f%90%e9%ab%98%e5%a4%8d%e7%94%a8" aria-label="ç›®æ ‡ä¸èƒ½å¿˜è®° ç®¡ç†å˜åŒ–ï¼Œæé«˜å¤ç”¨">ç›®æ ‡ä¸èƒ½å¿˜è®° ç®¡ç†å˜åŒ–ï¼Œæé«˜å¤ç”¨</a></li>
                <li>
                    <a href="#%e4%b8%a4%e8%80%85%e4%b8%bb%e8%a6%81%e7%9a%84%e6%89%8b%e6%ae%b5-%e5%88%86%e8%a7%a3%e5%92%8c%e6%8a%bd%e8%b1%a1" aria-label="ä¸¤è€…ä¸»è¦çš„æ‰‹æ®µ åˆ†è§£å’ŒæŠ½è±¡">ä¸¤è€…ä¸»è¦çš„æ‰‹æ®µ åˆ†è§£å’ŒæŠ½è±¡</a></li>
                <li>
                    <a href="#%e6%b7%b1%e5%88%bb%e7%ab%8b%e5%88%bb8%e5%a4%a7%e5%8e%9f%e5%88%99%e5%92%8c%e9%87%8d%e6%9e%84%e7%9a%845%e7%a7%8d%e6%8a%80%e5%b7%a7" aria-label="æ·±åˆ»ç«‹åˆ»8å¤§åŸåˆ™å’Œé‡æ„çš„5ç§æŠ€å·§">æ·±åˆ»ç«‹åˆ»8å¤§åŸåˆ™å’Œé‡æ„çš„5ç§æŠ€å·§</a></li>
                <li>
                    <a href="#%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e6%9c%80%e7%bb%88%e5%8f%af%e8%83%bd%e7%9a%84%e5%af%b9%e8%b1%a1%e6%a8%a1%e5%9e%8b" aria-label="è®¾è®¡æ¨¡å¼æœ€ç»ˆå¯èƒ½çš„å¯¹è±¡æ¨¡å‹">è®¾è®¡æ¨¡å¼æœ€ç»ˆå¯èƒ½çš„å¯¹è±¡æ¨¡å‹</a></li>
                <li>
                    <a href="#%e6%97%b6%e5%88%bb%e8%a6%81%e6%b3%a8%e6%84%8f%e5%85%b3%e6%b3%a8%e5%8f%98%e5%8c%96%e7%82%b9%e5%92%8c%e7%a8%b3%e5%ae%9a%e7%82%b9" aria-label="æ—¶åˆ»è¦æ³¨æ„å…³æ³¨å˜åŒ–ç‚¹å’Œç¨³å®šç‚¹">æ—¶åˆ»è¦æ³¨æ„å…³æ³¨å˜åŒ–ç‚¹å’Œç¨³å®šç‚¹</a></li>
                <li>
                    <a href="#%e5%93%aa%e4%ba%9b%e5%9c%ba%e6%99%af%e4%b8%8d%e5%a4%aa%e9%80%82%e5%90%88%e7%94%a8%e6%a8%a1%e5%bc%8f" aria-label="å“ªäº›åœºæ™¯ä¸å¤ªé€‚åˆç”¨æ¨¡å¼">å“ªäº›åœºæ™¯ä¸å¤ªé€‚åˆç”¨æ¨¡å¼</a></li>
                <li>
                    <a href="#%e4%b8%80%e4%ba%9b%e7%bb%8f%e9%aa%8c%e4%b9%8b%e8%b0%88" aria-label="ä¸€äº›ç»éªŒä¹‹è°ˆ">ä¸€äº›ç»éªŒä¹‹è°ˆ</a></li>
                <li>
                    <a href="#%e6%88%90%e9%95%bf%e4%b9%8b%e8%b7%af" aria-label="æˆé•¿ä¹‹è·¯">æˆé•¿ä¹‹è·¯</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        
        activeElement = elements[0];
        const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
        document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
    }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        if (elements) {
            activeElement = Array.from(elements).find((element) => {
                if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                    (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                    return element;
                }
            }) || activeElement

            elements.forEach(element => {
                const id = encodeURI(element.getAttribute('id')).toLowerCase();
                if (element === activeElement){
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
                } else {
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
                }
            })
        }
    }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;
    }
</script>
        <div class="post-content"><h1 id="è®¾è®¡æ¨¡å¼ä»‹ç»">è®¾è®¡æ¨¡å¼ä»‹ç»<a hidden class="anchor" aria-hidden="true" href="#è®¾è®¡æ¨¡å¼ä»‹ç»">#</a></h1>
<p>è®¾è®¡æ¨¡å¼æœ€å…³é”®çš„ä½œç”¨æ˜¯ä¸ºäº†å¯å¤ç”¨ï¼Œå‡å°‘å¼€å‘å·¥ä½œé‡ã€‚</p>
<p>æ¨¡å¼å°±æ˜¯é’ˆå¯¹ç°å®ä¸–ç•Œé‡å¤å‡ºç°çš„é—®é¢˜ï¼Œç»™å‡ºæ ¸å¿ƒè§£å†³æ–¹æ¡ˆï¼Œå¿½ç•¥æ‰ä¸€äº›ä¸é‡è¦çš„ç»†èŠ‚ã€‚</p>
<p>åˆ†è§£å’ŒæŠ½è±¡æ˜¯2ç§è§£å†³ç°å®é—®é¢˜çš„é€šç”¨æ–¹æ³•ã€‚</p>
<p>åº•å±‚æ€ç»´æ˜¯å‘ä¸‹çš„ï¼Œå¤šæ•°æ˜¯ç†è§£è®¡ç®—æœºçš„ï¼ŒæŠ½è±¡æ˜¯å‘ä¸Šæ€ç»´ï¼Œå¤šæ•°æ˜¯ç†è§£ç°å®ä¸–ç•Œçš„ã€‚</p>
<p>åœ¨ç°å®å·¥ç¨‹å¼€å‘ä¸­ï¼Œè¦å¯»æ‰¾éœ€æ±‚é¢‘ç¹å˜åŒ–ç‚¹ï¼Œåº”ç”¨å¯¹åº”çš„è®¾è®¡æ¨¡å¼ï¼Œä»è€Œæé«˜ä»£ç å¤ç”¨æ€§ï¼Œé™ä½å¼€å‘æˆæœ¬ï¼Œæµ‹è¯•æˆæœ¬ã€‚</p>
<p>è®¾è®¡æ¨¡å¼çš„åº”ç”¨ä¸å®œå…ˆå…¥ä¸ºä¸»ï¼Œæœ€å¥½æ˜¯Refactoring to Patterns ä¹Ÿå°±æ˜¯é’ˆå¯¹ç°å®çš„ç—›ç‚¹(å˜åŒ–ç‚¹)ï¼Œé‡æ„åˆ°è®¾è®¡æ¨¡å¼</p>
<h2 id="é‡æ„çš„å…³é”®æŠ€å·§">é‡æ„çš„å…³é”®æŠ€å·§<a hidden class="anchor" aria-hidden="true" href="#é‡æ„çš„å…³é”®æŠ€å·§">#</a></h2>
<ul>
<li>é™æ€&mdash;-åŠ¨æ€</li>
<li>æ—©ç»‘å®š&mdash;-æ™šç»‘å®š</li>
<li>ç»§æ‰¿&mdash;&ndash;ç»„åˆ</li>
<li>ç¼–è¯‘æ—¶ä¾èµ–&mdash;-è¿è¡Œæ—¶ä¾èµ–</li>
<li>ç´§è€¦åˆ&mdash;-æ¾è€¦åˆ</li>
</ul>
<h1 id="é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™">é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™<a hidden class="anchor" aria-hidden="true" href="#é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™">#</a></h1>
<h2 id="é‡æ–°è®¤è¯†é¢å‘å¯¹è±¡">é‡æ–°è®¤è¯†é¢å‘å¯¹è±¡<a hidden class="anchor" aria-hidden="true" href="#é‡æ–°è®¤è¯†é¢å‘å¯¹è±¡">#</a></h2>
<ol>
<li>
<p>ç†è§£éš”ç¦»å˜åŒ–</p>
<p>å®è§‚å±‚é¢æ¥çœ‹ é¢å‘å¯¹è±¡çš„æ„å»ºæ–¹å¼èƒ½å¤Ÿé€‚åº”è½¯ä»¶çš„å˜åŒ–ï¼Œèƒ½å°†å˜åŒ–å¸¦æ¥çš„å½±å“å‡ä¸ºæœ€å°</p>
</li>
<li>
<p>å„å¸å…¶èŒ</p>
<p>å¾®è§‚å±‚é¢æ¥è¯´ï¼Œé¢å‘å¯¹è±¡æ›´å¼ºè°ƒç‹¬ç«‹çš„å„ä¸ªç±»</p>
<p>éœ€æ±‚å˜åŒ–å¸¦æ¥çš„æ–°å¢ç±» ä¸åº”è¯¥æ”¹å˜åŸæ¥ç±»çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªç±»å„å¸å…¶èŒ</p>
</li>
<li>
<p>å¯¹è±¡åˆ°åº•æ˜¯ä»€ä¹ˆ</p>
<p>ä»è¯­è¨€çš„è§’åº¦æ¥è¯´ï¼Œå¯¹è±¡å°è£…äº†ä»£ç å’Œæ•°æ®</p>
<p>ä»è§„æ ¼å±‚é¢æ¥è¯´ï¼Œå¯¹è±¡æ˜¯ä¸€äº›åˆ—å¯ä»¥ä½¿ç”¨çš„å…¬å…±æ¥å£</p>
<p>ä»æ¦‚å¿µå±‚é¢æ¥è¯´ï¼Œå¯¹è±¡æ˜¯æ‹¥æœ‰æŸç§è´£ä»»çš„æŠ½è±¡</p>
</li>
</ol>
<h2 id="1-ä¾èµ–å€’ç½®åŸåˆ™dip">1 ä¾èµ–å€’ç½®åŸåˆ™(DIP)<a hidden class="anchor" aria-hidden="true" href="#1-ä¾èµ–å€’ç½®åŸåˆ™dip">#</a></h2>
<ul>
<li>
<p>é«˜å±‚æ¨¡å—(å¾€å¾€æ˜¯ç¨³å®šçš„)ä¸åº”è¯¥ä¾èµ–åº•å±‚æ¨¡å—(å¾€å¾€æ˜¯ä¸åœçš„å˜åŒ–çš„)ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚</p>
</li>
<li>
<p>æŠ½è±¡(ç¨³å®š)ä¸åº”è¯¥ä¾èµ–äºå®ç°ç»†èŠ‚(å˜åŒ–)ï¼Œå®ç°ç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡(ç¨³å®š)</p>
</li>
</ul>
<p><img loading="lazy" src="http://becool.vip:666/img/OOD_principle_1.png" alt=""  />
</p>
<h2 id="2-å¼€æ”¾å°é—­åŸåˆ™ocp">2 å¼€æ”¾å°é—­åŸåˆ™(OCP)<a hidden class="anchor" aria-hidden="true" href="#2-å¼€æ”¾å°é—­åŸåˆ™ocp">#</a></h2>
<ul>
<li>å¯¹äºæ‰©å±•æ˜¯å¼€æ”¾çš„ï¼Œå¯¹äºä¿®æ”¹æ˜¯å°é—­çš„</li>
<li>ç±»æ¨¡å—åº”è¯¥æ˜¯æ˜¯å¯ä»¥æ‰©å±•çš„ï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹ã€‚</li>
</ul>
<p>åœ¨è®¾è®¡ä¹‹åˆåº”è¯¥è€ƒè™‘å…¶æ‰©å±•æ€§ï¼Œä¸åº”è¯¥å› ä¸ºæ–°å¢ä¸€ä¸ªåŠŸèƒ½ï¼Œåè€Œè¦æ›´æ”¹åŸå…ˆçš„åŠŸèƒ½ï¼Œåº”è¯¥è®©æ–°å¢åŠŸèƒ½ä¸ºæ‰©å±•ï¼Œä¸åº”è¯¥ä¿®æ”¹åŸå…ˆçš„ä»£ç ã€‚</p>
<h2 id="3-å•ä¸€èŒè´£åŸåˆ™srp">3 å•ä¸€èŒè´£åŸåˆ™(SRP)<a hidden class="anchor" aria-hidden="true" href="#3-å•ä¸€èŒè´£åŸåˆ™srp">#</a></h2>
<ul>
<li>ä¸€ä¸ªç±»åº”è¯¥ä»…æœ‰ä¸€ä¸ªå¼•èµ·å…¶å˜åŒ–çš„åŸå› </li>
<li>å…¶å˜åŒ–çš„åŸå›  å¾€å¾€å°±æ˜¯å…¶è¯¥æ‰¿æ‹…çš„è´£ä»»ã€‚</li>
</ul>
<h2 id="4-liskovæ›¿æ¢åŸåˆ™lsp">4 Liskovæ›¿æ¢åŸåˆ™(LSP)<a hidden class="anchor" aria-hidden="true" href="#4-liskovæ›¿æ¢åŸåˆ™lsp">#</a></h2>
<ul>
<li>å­ç±»å¿…é¡»èƒ½å¤Ÿæ›¿æ¢å®ƒçš„çˆ¶ç±»(IS-A)</li>
<li>ç»§æ‰¿è¡¨è¾¾ç±»å‹æŠ½è±¡</li>
</ul>
<h2 id="5-æ¥å£éš”ç¦»åŸåˆ™isp">5 æ¥å£éš”ç¦»åŸåˆ™(ISP)<a hidden class="anchor" aria-hidden="true" href="#5-æ¥å£éš”ç¦»åŸåˆ™isp">#</a></h2>
<ul>
<li>ä¸åº”è¯¥å¼ºè¿«å®¢æˆ·ç¨‹åºä¾èµ–ä»–ä»¬ä¸ä½¿ç”¨çš„æ–¹æ³•</li>
<li>æ¥å£åº”è¯¥å°è€Œå®Œå¤‡</li>
</ul>
<h2 id="6-ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆ-è€Œä¸æ˜¯ç±»ç»§æ‰¿">6 ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆ è€Œä¸æ˜¯ç±»ç»§æ‰¿<a hidden class="anchor" aria-hidden="true" href="#6-ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆ-è€Œä¸æ˜¯ç±»ç»§æ‰¿">#</a></h2>
<ul>
<li>ç±»ç»§æ‰¿é€šå¸¸æ˜¯ç™½ç®±å¤ç”¨ å¯¹è±¡ç»„åˆé€šå¸¸ä¸ºé»‘ç®±å¤ç”¨</li>
<li>ç»§æ‰¿åœ¨æŸç§ç¨‹åº¦ä¸Šç ´åäº†å°è£…æ€§ï¼Œå­ç±»çˆ¶ç±»è€¦åˆåº¦è¾ƒé«˜</li>
<li>å¯¹è±¡ç»„åˆåªè¦æ±‚è¢«ç»„åˆçš„å¯¹è±¡æœ‰è‰¯å¥½çš„æ¥å£å®šä¹‰ï¼Œè€¦åˆåº¦ä½</li>
</ul>
<h2 id="7-å°è£…å˜åŒ–ç‚¹">7 å°è£…å˜åŒ–ç‚¹<a hidden class="anchor" aria-hidden="true" href="#7-å°è£…å˜åŒ–ç‚¹">#</a></h2>
<ul>
<li>
<p>ä½¿ç”¨å°è£…æ¥åˆ›å»ºå¯¹è±¡ä¹‹é—´çš„åˆ†ç•Œå±‚ï¼Œè®©è®¾è®¡è€…å¯ä»¥åœ¨åˆ†ç•Œå±‚ä¸€ä¾§ä¿®æ”¹ï¼Œä¸å½±å“å¦å¤–ä¸€ä¾§ï¼Œå®ç°åˆ†å±‚é—´çš„æ¾è€¦åˆã€‚</p>
</li>
<li>
<p>å°è£…å…¶å®æ˜¯å°è£…å˜åŒ–ç‚¹ã€‚</p>
</li>
</ul>
<h2 id="8-é’ˆå¯¹æ¥å£ç¼–ç¨‹ä¸è¦é’ˆå¯¹å®ç°ç¼–ç¨‹">8 é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œä¸è¦é’ˆå¯¹å®ç°ç¼–ç¨‹<a hidden class="anchor" aria-hidden="true" href="#8-é’ˆå¯¹æ¥å£ç¼–ç¨‹ä¸è¦é’ˆå¯¹å®ç°ç¼–ç¨‹">#</a></h2>
<ul>
<li>ä¸å°†å˜é‡å£°æ˜ä¸ºç‰¹å®šçš„ç±»ï¼Œè€Œæ˜¯å£°æ˜ä¸ºæ¥å£ã€‚</li>
<li>å®¢æˆ·ç¨‹åºä¸éœ€è¦çŸ¥é“å¯¹è±¡å…·ä½“ç±»å‹ï¼Œåªéœ€è¦çŸ¥é“å…¶å¼€æ”¾çš„æ¥å£</li>
<li>å‡å°‘å„éƒ¨åˆ†ä¾èµ–å…³ç³»ï¼Œå®ç°é«˜å†…èš æ¾è€¦åˆ</li>
<li>äº§ä¸šå¼ºç›› æœ€å¥½æ˜¯æ¥å£ç›¸å½“æ ‡å‡†åŒ–ã€‚</li>
</ul>
<h1 id="æ¨¡ç‰ˆæ–¹æ³•template-method---ç»„ä»¶åä½œ">æ¨¡ç‰ˆæ–¹æ³•Template method&mdash;ç»„ä»¶åä½œ<a hidden class="anchor" aria-hidden="true" href="#æ¨¡ç‰ˆæ–¹æ³•template-method---ç»„ä»¶åä½œ">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯">éœ€æ±‚èƒŒæ™¯ï¼š<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯">#</a></h2>
<p>éœ€è¦å®ç°å¤šä¸ªappï¼Œéƒ½éœ€è¦5ä¸ªæ“ä½œæ­¥éª¤(5ä¸ªæ­¥éª¤æ“ä½œé¡ºåºä¹Ÿéƒ½æ˜¯å›ºå®šçš„),æœ‰3ä¸ªå·²ç»æœ‰æ¡†æ¶æˆ–è€…libraryåº“å®ç°äº†ï¼Œå®ç°è¿™ä¸ªapp</p>
<h2 id="ä¼ ç»Ÿç»“æ„åŒ–æ€æƒ³å®ç°">ä¼ ç»Ÿç»“æ„åŒ–æ€æƒ³å®ç°<a hidden class="anchor" aria-hidden="true" href="#ä¼ ç»Ÿç»“æ„åŒ–æ€æƒ³å®ç°">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C++" data-lang="C++"><span style="display:flex;"><span><span style="color:#75715e">#include&lt;iostream&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Library</span>{<span style="color:#75715e">//è¿™é‡Œå¾€å¾€æ˜¯åº“å‡½æ•°æˆ–è€…åˆ«äººçš„å®ç° å®ç°äº†3ä¸ªæ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">bool</span> Step1(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      cout<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;Library::Step1()&#34;</span><span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> true;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Step3</span>(){
</span></span><span style="display:flex;"><span>       cout<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;Library::Step3()&#34;</span><span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Step5</span>(){
</span></span><span style="display:flex;"><span>       cout<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;Library::Step5()&#34;</span><span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">App</span>{<span style="color:#75715e">//åº”ç”¨ç¨‹åº å®ç°Step2 Step4æ–¹æ³• è¿™2ä¸ªæ–¹æ³•ç»å¸¸å˜åŒ– ä¸åŒçš„åº”ç”¨ä¸ä¸€æ ·çš„å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> Step2(){
</span></span><span style="display:flex;"><span>      cout<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;App::Step2()&#34;</span><span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  } 
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Step4</span>(){
</span></span><span style="display:flex;"><span>      cout<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;App::Step4()&#34;</span><span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){<span style="color:#75715e">//å¦‚æœè¦å®ç°å¦å¤–ä¸€ä¸ªç¨‹åº åˆ™éœ€è¦é‡æ–°å†å†™ä¸€ä¸ªmain é‡æ–°å†™ä¸€ä¸ªAppç±» å®ç°Step2å’ŒStep4æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  App app;
</span></span><span style="display:flex;"><span>  Library lib;
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//ä»¥ä¸‹ä¸ºç¨‹åºå®ç°é€»è¾‘ ä¹Ÿå°±æ˜¯ç®—æ³•æ¡†æ¶ç»“æ„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span>(lib.Step1()){
</span></span><span style="display:flex;"><span>      app.Step2();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  lib.Step3();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">4</span>;<span style="color:#f92672">++</span>i) {
</span></span><span style="display:flex;"><span>      app.Step4();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  lib.Step5();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å¦‚æœ34--41çš„ç®—æ³•æ­¥éª¤æ•´ä½“æ˜¯ç¨³å®šçš„ åªæœ‰Step2å’ŒStep4æ˜¯ç»å¸¸å˜åŒ–çš„ å¯ä»¥è€ƒè™‘ç”¨TempalteMethodè®¾è®¡æ¨¡å¼æ¥å®ç°
</span></span></span></code></pre></div><h2 id="åŠ¨æœº">åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#åŠ¨æœº">#</a></h2>
<ul>
<li>æŸé¡¹ä»»åŠ¡ å¸¸å¸¸æœ‰ç¨³å®šçš„æ•´ä½“æ“ä½œç»“æ„ï¼Œä½†æ˜¯å„ä¸ªå­æ­¥éª¤éœ€è¦ç»å¸¸å˜åŒ–ï¼Œæˆ–è€…ç”±äºå›ºæœ‰çš„åŸå› (æ¡†æ¶å’Œåº”ç”¨çš„å…³ç³»)ï¼Œæ— æ³•å’Œä»»åŠ¡çš„æ•´ä½“ç»“æ„åŒæ—¶å®ç°</li>
<li>è¿™å°±è¦æ€è€ƒå¦‚ä½•ç¡®å®šç¨³å®šçš„æ“ä½œç»“æ„çš„å‰æä¸‹ï¼Œæ¥çµæ´»åº”å¯¹å„ä¸ªå­æ­¥éª¤çš„å˜åŒ–æˆ–è€…æ™šæœŸå®ç°éœ€æ±‚</li>
</ul>
<h2 id="æ¨¡å¼å®šä¹‰">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰">#</a></h2>
<ul>
<li>å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•éª¨æ¶(å¾€å¾€æ˜¯ç¨³å®šçš„)ï¼Œå°†ä¸€äº›æ­¥éª¤(å¾€å¾€æ˜¯å˜åŒ–äº†ï¼Œå‰æœŸç¡®å®šä¸ä¸‹æ¥)å»¶è¿Ÿåˆ°å­ç±»ä¸­å®ç°ï¼ŒTemplate Methodä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜(å¤ç”¨)ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰(Overrideé‡å†™)è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šå­æ­¥éª¤ã€‚</li>
</ul>
<h2 id="è¦ç‚¹æ€»ç»“">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“">#</a></h2>
<ul>
<li>tempalte methodæ˜¯ä¸€ç§éå¸¸åŸºç¡€æ€§çš„è®¾è®¡æ¨¡å¼ åœ¨é¢å‘å¯¹è±¡ç³»ç»Ÿä¸­æœ‰å¤§é‡çš„åº”ç”¨ï¼Œæœºåˆ¶éå¸¸ç®€æ´(è™šå‡½æ•°çš„å¤šæ€)ï¼Œä¸ºå¾ˆå¤šåº”ç”¨ç¨‹åºçš„æ¡†æ¶æä¾›äº†çµæ´»çš„æ‰©å±•ç‚¹(ç»§æ‰¿+è™šå‡½æ•°å¤šæ€åº¦)ï¼Œæ˜¯ä»£ç å¤ç”¨çš„åŸºæœ¬å®ç°ç»“æ„</li>
<li>ä¸è¦è°ƒç”¨æˆ‘ï¼Œè®©æˆ‘æ¥è°ƒç”¨ä½ </li>
<li>å…·ä½“å®ç°æ–¹é¢ï¼Œè¢«template methodè°ƒç”¨çš„è™šæ–¹æ³•å¯ä»¥æœ‰å®ç°ä¹Ÿå¯ä»¥æ²¡æœ‰å®ç°ï¼Œä¸€èˆ¬å°†è¢«è°ƒç”¨çš„æ–¹æ³•è®¾ç½®ä¸ºprotectrdã€‚å› ä¸ºè¿™äº›è¢«template methodè°ƒç”¨çš„è™šæ–¹æ³•ç¦»å¼€äº†ä¸»æµç¨‹å¾€å¾€æ²¡æœ‰æ„ä¹‰ï¼Œä¹Ÿä¸åº”è¯¥è®¾ç½®ä¸ºpublicæš´æ¼ç»™å¤–éƒ¨ã€‚</li>
</ul>
<h2 id="å‡ å¼ å›¾è§£">å‡ å¼ å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#å‡ å¼ å›¾è§£">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_%e7%bb%93%e6%9e%84%e5%8c%96%e8%bd%af%e4%bb%b6%e8%ae%be%e8%ae%a1%e6%b5%81%e7%a8%8b.png" alt=""  />
</p>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1%e8%bd%af%e4%bb%b6%e8%ae%be%e8%ae%a1%e6%b5%81%e7%a8%8b.png" alt=""  />
</p>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_%e6%97%a9%e7%bb%91%e5%ae%9a%e4%b8%8e%e6%99%9a%e7%bb%91%e5%ae%9a.png" alt=""  />
</p>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_TempalteMethod%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="æ¨¡ç‰ˆæ–¹æ³•ä»£ç å®ç°">æ¨¡ç‰ˆæ–¹æ³•ä»£ç å®ç°<a hidden class="anchor" aria-hidden="true" href="#æ¨¡ç‰ˆæ–¹æ³•ä»£ç å®ç°">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">#include&lt;iostream&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Library</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> run(){<span style="color:#75715e">//template method
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">//è¿™é‡Œçš„runæ–¹æ³•ä¹Ÿå°±æ˜¯æ‰€è¯´çš„ç›¸å¯¹ç¨³å®šçš„æ•´ä½“å¤„ç†ç»“æ„ Step2å’ŒStep4ä¼šæ ¹æ®ä¸åŒçš„åº”ç”¨å®ç°ä¸ºä¸åŒçš„é€»è¾‘ï¼Œæ‰€ä»¥å£°æ˜ä¸ºçº¯è™šå‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span>(Step1()){
</span></span><span style="display:flex;"><span>            Step2();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        Step3();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">4</span>;<span style="color:#f92672">++</span>i) {
</span></span><span style="display:flex;"><span>            Step4();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        Step5();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Library(){}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">bool</span> Step1(){
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        cout<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;Library::Step1()&#34;</span><span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> true;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Step3</span>(){
</span></span><span style="display:flex;"><span>         cout<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;Library::Step3()&#34;</span><span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Step5</span>(){
</span></span><span style="display:flex;"><span>         cout<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;Library::Step5()&#34;</span><span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Step2</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#75715e">//è¿™é‡Œå£°æ˜ä¸ºçº¯è™šå‡½æ•° è®©å­ç±»å»å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Step4</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">App</span> <span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> Library{<span style="color:#75715e">//ç»§æ‰¿æ¡†æ¶ç±» å®ç°å®¹æ˜“å˜åŒ–çš„2ä¸ªå‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> Step2(){
</span></span><span style="display:flex;"><span>        cout<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;App::Step2()&#34;</span><span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    } 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Step4</span>(){
</span></span><span style="display:flex;"><span>        cout<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;App::Step4()&#34;</span><span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>    }    
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>    Library<span style="color:#f92672">*</span> pLib<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> App();
</span></span><span style="display:flex;"><span>    pLib<span style="color:#f92672">-&gt;</span>run();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">delete</span> pLib;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="ç­–ç•¥æ¨¡å¼-strategy---ç»„ä»¶åä½œ">ç­–ç•¥æ¨¡å¼ strategy&mdash;ç»„ä»¶åä½œ<a hidden class="anchor" aria-hidden="true" href="#ç­–ç•¥æ¨¡å¼-strategy---ç»„ä»¶åä½œ">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯-1">éœ€æ±‚èƒŒæ™¯<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯-1">#</a></h2>
<p>éœ€è¦å®ç°ä¸€ä¸ªç±»ï¼Œè®¡ç®—å„ä¸ªå›½å®¶çš„ç¨ï¼Œæ¯ä¸ªå›½å®¶çš„è®¡ç¨ç®—æ³•ä¸ä¸€æ ·ï¼ŒåæœŸå¯èƒ½ä¿®æ”¹æˆ–è€…å¢åŠ ä¸€äº›å›½å®¶çš„è®¡ç¨ç®—æ³•</p>
<h2 id="ä¼ ç»Ÿå®ç°">ä¼ ç»Ÿå®ç°<a hidden class="anchor" aria-hidden="true" href="#ä¼ ç»Ÿå®ç°">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C++" data-lang="C++"><span style="display:flex;"><span><span style="color:#75715e">//ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ traditional solution
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">enum</span> <span style="color:#a6e22e">TaxBase</span> {
</span></span><span style="display:flex;"><span>  CN_Tax,
</span></span><span style="display:flex;"><span>  US_Tax,
</span></span><span style="display:flex;"><span>  DE_Tax,
</span></span><span style="display:flex;"><span>  FR_Tax       <span style="color:#75715e">//å¦‚æœè¦å¢åŠ æ”¯æŒæ³•å›½ç¨æ³•å°±è¦ä¿®æ”¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SalesOrder</span>{
</span></span><span style="display:flex;"><span>  TaxBase tax;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">double</span> CalculateTax(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ ç›´æ¥ifelse åˆ†è€Œæ²»ä¹‹ éœ€è¦ç»å¸¸ä¿®æ”¹è¿™ä¸ªå‡½æ•° å¾ˆå¯èƒ½å‡ºç°å¼•å…¥æ–°çš„éœ€æ±‚ å¯¼è‡´åŸå…ˆçš„å®ç°æ–¹æ¡ˆå¼•å…¥bug
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">if</span> (tax <span style="color:#f92672">==</span> CN_Tax){
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">//CN***********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (tax <span style="color:#f92672">==</span> US_Tax){
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">//US***********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (tax <span style="color:#f92672">==</span> DE_Tax){
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">//DE***********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      }
</span></span><span style="display:flex;"><span>  	<span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (tax <span style="color:#f92672">==</span> FR_Tax){  
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">//å¦‚æœè¦å¢åŠ æ”¯æŒæ³•å›½ç¨æ³•å°±è¦ä¿®æ”¹ è¿™ä¸ªåœ°æ–¹è¿èƒŒäº†å¼€é—­åŸåˆ™(ç”¨æ‰©å±•çš„æ–¹å¼æ”¯æŒä¿®æ”¹ è€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  		<span style="color:#75715e">//ç»éªŒå‘Šè¯‰æˆ‘ä»¬ï¼Œç›´æ¥ä¿®æ”¹çš„æ–¹å¼ ä¹Ÿæ¯”è¾ƒå®¹æ˜“å¼•å…¥bug
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	}
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>};                      
</span></span></code></pre></div><h2 id="åŠ¨æœº-1">åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#åŠ¨æœº-1">#</a></h2>
<ul>
<li>å¦‚æœç°å®è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒæŸä¸€ä¸ªå¯¹è±¡ä½¿ç”¨äº†å¤šç§ç®—æ³•ï¼Œè€Œä¸”è¿™äº›ç®—æ³•å¯èƒ½ç»å¸¸æ”¹å˜ï¼Œæˆ–è€…ç»å¸¸éœ€è¦æ–°å¢ç±»ä¼¼ç®—æ³•(æ¯”å¦‚è®¡ç®—ä¸åŒå›½å®¶çš„ç¨)ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœå°†è¿™äº›ç®—æ³•å…¨éƒ¨ç¼–ç åˆ°å¯¹è±¡ä¸­ï¼Œè¿™ä¸ªå¯¹è±¡å°±ä¼šå˜çš„éå¸¸å¤æ‚ï¼Œå®¹æ˜“å‡ºé”™ï¼Œç­–ç•¥æ¨¡å¼å¯ä»¥è§£å†³é—®é¢˜</li>
<li>æ›´ç›´è§‚ç‚¹ å¦‚æœä½¿ç”¨äº†å¤§é‡if elseæˆ–è€…switch caseï¼Œè€Œä¸”ä¸ç¨³å®šï¼Œç»å¸¸å˜åŒ–ï¼Œå°±å¯ä»¥è€ƒè™‘ç”¨strategyæ¨¡å¼æ”¹é€ </li>
<li>è¦è€ƒè™‘ä½¿ç”¨å¤šæ€æœºåˆ¶åœ¨è¿è¡Œæ—¶åŠ¨æ€çš„ä½¿ç”¨ç›¸åº”çš„ç®—æ³•è§£å†³é—®é¢˜</li>
</ul>
<h2 id="æ¨¡å¼çš„å®šä¹‰">æ¨¡å¼çš„å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼çš„å®šä¹‰">#</a></h2>
<ul>
<li><strong>å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•</strong>(åŠ¨æœºç« èŠ‚æåˆ°çš„ç»å¸¸å˜åŒ–çš„ç®—æ³•)ï¼ŒæŠŠå®ƒä»¬ä¸€ä¸ªä¸ª<strong>å°è£…èµ·æ¥(ä¸åŒçš„å­ç±»)</strong>ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯äº’ç›¸æ›¿æ¢(å˜åŒ–)&ndash;(<strong>ä½¿ç”¨å¤šæ€è¿è¡Œæ—¶å†³å®šä½¿ç”¨å“ªç§ç®—æ³•</strong>)ã€‚è¯¥æ¨¡å¼ä½¿å¾—ç®—æ³•å¯ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·ç¨‹åº(ç¨³å®š)è€Œå˜åŒ–(æ‰©å±•ï¼Œå­ç±»åŒ–)ã€‚â€”â€”ã€Šè®¾è®¡æ¨¡å¼ã€‹GoF</li>
</ul>
<h2 id="è¦ç‚¹æ€»ç»“-1">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-1">#</a></h2>
<ul>
<li>
<p>StrategyåŠå…¶å­ç±»ä¸ºç»„ä»¶æä¾›äº†ä¸€ç³»åˆ—å¯é‡ç”¨çš„ç®—æ³•ï¼Œä»è€Œå¯ä»¥ä½¿å¾—ç±»å‹åœ¨è¿è¡Œæ—¶æ–¹ä¾¿åœ°æ ¹æ®éœ€è¦åœ¨å„ä¸ªç®—æ³•ä¹‹é—´è¿›è¡Œåˆ‡æ¢(å¤šæ€)ã€‚</p>
</li>
<li>
<p>Strategyæ¨¡å¼æä¾›äº†ç”¨æ¡ä»¶åˆ¤æ–­è¯­å¥ä»¥å¤–çš„å¦ä¸€ç§é€‰æ‹©ï¼Œæ¶ˆé™¤æ¡ä»¶åˆ¤æ–­è¯­å¥ï¼Œå°±æ˜¯åœ¨è§£è€¦åˆã€‚å«æœ‰è®¸å¤šæ¡ä»¶åˆ¤æ–­è¯­å¥çš„ä»£ç é€šå¸¸éƒ½éœ€ è¦Strategyæ¨¡å¼ã€‚</p>
</li>
<li>
<p>å¦‚æœStrategyå¯¹è±¡æ²¡æœ‰å®ä¾‹å˜é‡ï¼Œé‚£ä¹ˆå„ä¸ªä¸Šä¸‹æ–‡å¯ä»¥å…±äº«åŒä¸€ä¸ª Strategyå¯¹è±¡ï¼Œä»è€ŒèŠ‚çœå¯¹è±¡å¼€é”€</p>
</li>
</ul>
<h2 id="å›¾è§£">å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#å›¾è§£">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Strategy%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="ç­–ç•¥æ¨¡å¼ä»£ç å®ç°">ç­–ç•¥æ¨¡å¼ä»£ç å®ç°<a hidden class="anchor" aria-hidden="true" href="#ç­–ç•¥æ¨¡å¼ä»£ç å®ç°">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C++" data-lang="C++"><span style="display:flex;"><span><span style="color:#75715e">//ç­–ç•¥æ¨¡å¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Context</span>{};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TaxStrategy</span>{<span style="color:#75715e">//ç­–ç•¥ç±»åŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">double</span> Calculate(<span style="color:#66d9ef">const</span> Context<span style="color:#f92672">&amp;</span> context)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#75715e">//çº¯è™šå‡½æ•° ä¸åŒçš„ç®—æ³•æŠ½è±¡ è¿è¡Œæ—¶è°ƒç”¨ç›¸åº”çš„ç®—æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>TaxStrategy(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StrategyFactory</span>{<span style="color:#75715e">//å·¥å‚ç±» æ ¹æ®ç°å®æƒ…å†µç”Ÿæˆä¸åŒçš„å­ç±»ï¼Œè§£å†³æƒ³è¦çš„é—®é¢˜
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span> TaxStrategy<span style="color:#f92672">*</span> NewStrategy(){ <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nullptr</span>;}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CNTax</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> TaxStrategy{<span style="color:#75715e">//å­ç±» ç»§æ‰¿ç­–ç•¥åŸºç±» å®ç°è™šæ–¹æ³• ç”¨äºå¤šæ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">double</span> Calculate(<span style="color:#66d9ef">const</span> Context<span style="color:#f92672">&amp;</span> context){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//***********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">USTax</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> TaxStrategy{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">double</span> Calculate(<span style="color:#66d9ef">const</span> Context<span style="color:#f92672">&amp;</span> context){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//***********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DETax</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> TaxStrategy{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">double</span> Calculate(<span style="color:#66d9ef">const</span> Context<span style="color:#f92672">&amp;</span> context){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//***********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//è¿™é‡Œå¦‚æœæ–°å¢ä¸€ä¸ªæ³•å›½çš„ï¼Œå°±æ˜¯æ‰©å±•çš„æ–¹å¼æ”¯æŒ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FRTax</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> TaxStrategy{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">double</span> Calculate(<span style="color:#66d9ef">const</span> Context<span style="color:#f92672">&amp;</span> context){
</span></span><span style="display:flex;"><span>  	<span style="color:#75715e">//.........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SalesOrder</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  TaxStrategy<span style="color:#f92672">*</span> strategy;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  SalesOrder(StrategyFactory<span style="color:#f92672">*</span> strategyFactory){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>strategy <span style="color:#f92672">=</span> strategyFactory<span style="color:#f92672">-&gt;</span>NewStrategy();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">~</span>SalesOrder(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">delete</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>strategy;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">double</span> <span style="color:#a6e22e">CalculateTax</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      Context context;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">double</span> val <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>          strategy<span style="color:#f92672">-&gt;</span>Calculate(context); <span style="color:#75715e">//å¤šæ€è°ƒç”¨ 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h1 id="è§‚å¯Ÿè€…æ¨¡å¼observer---ç»„ä»¶åä½œ">è§‚å¯Ÿè€…æ¨¡å¼Observer&mdash;ç»„ä»¶åä½œ<a hidden class="anchor" aria-hidden="true" href="#è§‚å¯Ÿè€…æ¨¡å¼observer---ç»„ä»¶åä½œ">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯-2">éœ€æ±‚èƒŒæ™¯<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯-2">#</a></h2>
<p>éœ€è¦å®ç°ä¸€ä¸ªæ–‡ä»¶åˆ†å‰²ä¸šåŠ¡ï¼ŒåŒæ—¶éœ€è¦æ˜¾ç¤ºè¿›åº¦æ¡ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶åˆ†å‰²æ—¶å€™è¾¾åˆ°ä¸€å®šçŠ¶æ€éœ€è¦é€šçŸ¥æŸä¸ªç±»ï¼Œåç»­å¾ˆæœ‰å¯èƒ½è¿˜æœ‰é€šçŸ¥å¤šä¸ªç±»</p>
<h2 id="ä¼ ç»Ÿå®ç°-1">ä¼ ç»Ÿå®ç°<a hidden class="anchor" aria-hidden="true" href="#ä¼ ç»Ÿå®ç°-1">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//traditional solutionä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//åˆ†å‰²å¤§æ–‡ä»¶ï¼Œæ˜¾ç¤ºæˆ–è€…æ‰“å°å¤„ç†è¿›åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#include&lt;string&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include&lt;iostream&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;common.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FileSplitter</span><span style="color:#75715e">//è¯¥ç±»æ˜¯è¢«ä¾èµ–çš„å¯¹è±¡ï¼ŒçŠ¶æ€å‘ç”Ÿå˜åŒ–éœ€è¦é€šçŸ¥ProgressBar
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>  string m_filePath;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> m_fileNumber;
</span></span><span style="display:flex;"><span>  ProgressBar<span style="color:#f92672">*</span> m_progressBar;<span style="color:#75715e">//è¯¥ç±»è´Ÿè´£æ”¶åˆ°é€šçŸ¥æ›´æ–°è¿›åº¦æ¡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//å¦‚æœè¦æ–°å¢å…¶å®ƒè§‚å¯Ÿè€…ï¼Œè¿™é‡Œéœ€è¦æ–°å¢å…·ä½“çš„å®ç°ç±»æŒ‡é’ˆ ProgressBar1* æ¯”è¾ƒéº»çƒ¦ï¼Œè¿™ä¸ªä¸šåŠ¡ç±»ä¹Ÿè¦é¢‘ç¹æ”¹å˜
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  FileSplitter(<span style="color:#66d9ef">const</span> string<span style="color:#f92672">&amp;</span> filePath, <span style="color:#66d9ef">int</span> fileNumber, ProgressBar<span style="color:#f92672">*</span> progressBar) <span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  	m_filePath(filePath), 
</span></span><span style="display:flex;"><span>  	m_fileNumber(fileNumber),
</span></span><span style="display:flex;"><span>  	m_progressBar(progressBar){
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">split</span>(){
</span></span><span style="display:flex;"><span>  	<span style="color:#75715e">//1.è¯»å–å¤§æ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	<span style="color:#75715e">//2.åˆ†æ‰¹æ¬¡å‘å°æ–‡ä»¶ä¸­å†™å…¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> m_fileNumber; i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>  		<span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  		<span style="color:#66d9ef">float</span> progressValue <span style="color:#f92672">=</span> m_fileNumber;
</span></span><span style="display:flex;"><span>  		progressValue <span style="color:#f92672">=</span> (i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> progressValue;
</span></span><span style="display:flex;"><span>  		m_progressBar<span style="color:#f92672">-&gt;</span>setValue(progressValue);
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">//ä»ç¼–è¯‘å±‚é¢å¦‚æœProgressBarå‘ç”Ÿå˜åŒ– ä¹Ÿå°±æ˜¯è§‚å¯Ÿè€…å‘ç”Ÿå˜åŒ–ï¼ŒFileSplitterç±»ä¹Ÿéœ€è¦å˜åŒ– é‡æ–°ç¼–è¯‘
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          <span style="color:#75715e">//ä»ä¸šåŠ¡å‘å±•æ¥çœ‹ï¼Œå¦‚æœéœ€è¦æ–°å¢è§‚å¯Ÿè€…ä¹Ÿæ˜¯æ¯”è¾ƒéº»çƒ¦çš„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          <span style="color:#75715e">//è¿™ä¸ªè¿èƒŒäº†ä¾èµ–å€’ç½®åŸåˆ™ï¼Œé«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–æ­¤å±‚æ¨¡å—å˜åŒ–ï¼ŒFileSplitterä¸åº”è¯¥ä¾èµ–ProgressBar
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          <span style="color:#75715e">//ä¸ªäººè§‰å¾—ä¹Ÿè¿èƒŒäº†å¼€é—­åŸåˆ™ï¼Œè¦ç”¨æ‰©å±•çš„æ–¹å¼æ”¯æŒæ–°å¢ï¼Œä¸åº”è¯¥ç›´æ¥ä¿®æ”¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	}
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//traditional solutionä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//åˆ†å‰²å¤§æ–‡ä»¶ï¼Œæ˜¾ç¤ºæˆ–è€…æ‰“å°å¤„ç†è¿›åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;common.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainForm</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Form
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  TextBox<span style="color:#f92672">*</span> txtFilePath;
</span></span><span style="display:flex;"><span>  TextBox<span style="color:#f92672">*</span> txtFileNumber;
</span></span><span style="display:flex;"><span>  ProgressBar<span style="color:#f92672">*</span> progressBar;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> Button1_Click(){
</span></span><span style="display:flex;"><span>  	string filePath <span style="color:#f92672">=</span> txtFilePath<span style="color:#f92672">-&gt;</span>getText();
</span></span><span style="display:flex;"><span>  	<span style="color:#66d9ef">int</span> number <span style="color:#f92672">=</span> atoi(txtFileNumber<span style="color:#f92672">-&gt;</span>getText().c_str());
</span></span><span style="display:flex;"><span>  	FileSplitter <span style="color:#a6e22e">splitter</span>(filePath, number, progressBar);
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//ä»ä¸šåŠ¡å‘å±•æ¥çœ‹ï¼Œå¦‚æœéœ€è¦æ–°å¢è§‚å¯Ÿè€…ä¹Ÿæ˜¯æ¯”è¾ƒéº»çƒ¦çš„ éœ€è¦ä¿®æ”¹FileSplitter æ„é€ æ–¹æ³•ï¼Œä¼ å…¥æ–°å¢çš„è§‚å¯Ÿè€…ç±»æŒ‡é’ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//ä¹Ÿéœ€è¦ä¿®æ”¹FileSplitteré€šçŸ¥é€»è¾‘ å¢åŠ å¯¹æ–°å¢è§‚å¯Ÿè€…çš„å¤„ç†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	splitter.split();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="åŠ¨æœº-2">åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#åŠ¨æœº-2">#</a></h2>
<ul>
<li>
<p>æˆ‘ä»¬è¦ä¸ºæŸäº›å¯¹è±¡ä¹‹é—´å»ºç«‹&quot;é€šçŸ¥ä¾èµ–å…³ç³»&quot;ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå¯¹è±¡çŠ¶æ€å‘ç”Ÿå˜æ›´ï¼Œéœ€è¦è‡ªåŠ¨é€šçŸ¥å…¶å®ƒä¾èµ–ä¸å®ƒçš„å¯¹è±¡ã€‚å¦‚æœè¿™ç§ä¾èµ–å…³ç³»è¿‡äºç´§å¯†ï¼Œå°†ä½¿è½¯ä»¶ä¸èƒ½å¾ˆå¥½çš„æŠµå¾¡å˜åŒ–ã€‚</p>
</li>
<li>
<p>å¯ä»¥ä½¿ç”¨é¢å‘å¯¹è±¡æŠ€æœ¯ï¼Œå°†è¿™ç§ä¾èµ–å…³ç³»å¼±åŒ–ï¼Œå½¢æˆä¸€ç§è¾ƒä¸ºç¨³å®šçš„ä¾èµ–å…³ç³»ï¼Œä»è€Œå®ç°æ¾è€¦åˆã€‚</p>
</li>
<li>
<p>å¤§è‡´å®ç°ï¼Œè¢«ä¾èµ–çš„å¯¹è±¡éœ€è¦åŒ…å«ä¸€ä¸ªé›†åˆ(é“¾è¡¨æˆ–è€…æ•°ç»„éƒ½å¯ä»¥),é›†åˆä¿å­˜çš„æ˜¯æŠ½è±¡æ¥å£åŸºç±»(è§‚å¯Ÿè€…çš„åŸºç±»æŒ‡é’ˆ)ï¼Œå½“è‡ªå·±çŠ¶æ€å˜åŒ–çš„æ—¶å€™éå†é›†åˆï¼Œè°ƒç”¨æŠ½è±¡æ¥å£åŸºç±»çš„é€šçŸ¥å‡½æ•°(å¤šæ€å®ç°è¿è¡Œæ—¶è°ƒç”¨å¤šä¸ªè§‚å¯Ÿè€…çš„ç›¸åº”å¤„ç†å‡½æ•°)ã€‚</p>
</li>
</ul>
<h2 id="æ¨¡å¼çš„å®šä¹‰-1">æ¨¡å¼çš„å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼çš„å®šä¹‰-1">#</a></h2>
<ul>
<li>å®šä¹‰å¯¹è±¡è§çš„ä¸€å¯¹å¤š(å˜åŒ–ä¹Ÿå°±æ˜¯è§‚å¯Ÿè€…)çš„ä¾èµ–å…³ç³»ï¼Œä»¥ä¾¿å½“è¢«ä¾èµ–å¯¹è±¡(Subject)çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰€æœ‰ä¾èµ–ä¸å®ƒçš„å¯¹è±¡(è§‚å¯Ÿè€…)éƒ½èƒ½å¾—åˆ°é€šçŸ¥å¹¶ä¸”è‡ªåŠ¨æ›´æ–°</li>
</ul>
<h2 id="ç»“æ„å›¾è§£">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Observer%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="è¦ç‚¹æ€»ç»“-2">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-2">#</a></h2>
<ul>
<li>ä½¿ç”¨Observerè§‚å¯Ÿè€…æ¨¡å¼å¯ä»¥ç‹¬ç«‹çš„æ”¹å˜ç›®æ ‡å’Œè§‚å¯Ÿè€…ï¼Œå®ç°æ¾è€¦åˆ</li>
<li>ç›®æ ‡å‘é€é€šçŸ¥çš„æ—¶å€™ï¼Œæ— éœ€æŒ‡å®šå…·ä½“çš„è§‚å¯Ÿè€…ï¼Œé€šçŸ¥(ä¹Ÿå¯ä»¥å†™æ€é€šçŸ¥ä¿¡æ¯ä½œä¸ºå‚æ•°)ä¼šè‡ªåŠ¨ä¼ æ’­</li>
<li>è§‚å¯Ÿè€…è‡ªå·±å†³å®šæ˜¯å¦éœ€è¦è®¢é˜…é€šçŸ¥ï¼Œå¦‚æœéœ€è¦è¯·è°ƒç”¨Subjectçš„æ·»åŠ è§‚å¯Ÿè€…APIï¼Œç›®æ ‡å¯¹è±¡å¯¹æ­¤å¯ä»¥æ˜¯é€æ˜çš„</li>
<li>å½“å¬åˆ°çŠ¶æ€å˜æ›´éœ€è¦é€šçŸ¥å¤šä¸ªå¯¹è±¡çš„åœºæ™¯å°±å¾€å¾€å¯ä»¥è€ƒè™‘Observerè§‚å¯Ÿè€…æ¨¡å¼äº†</li>
<li>Observeræ¨¡å¼æ˜¯åŸºäºäº‹ä»¶çš„UIæ¡†æ¶ä¸­éå¸¸å¸¸ç”¨çš„æ¨¡å¼ï¼Œä¹Ÿæ˜¯MVCæ¨¡å¼çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†</li>
</ul>
<h2 id="è§‚å¯Ÿè€…æ¨¡å¼ä»£ç å®ç°">è§‚å¯Ÿè€…æ¨¡å¼ä»£ç å®ç°<a hidden class="anchor" aria-hidden="true" href="#è§‚å¯Ÿè€…æ¨¡å¼ä»£ç å®ç°">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">#include&lt;string&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include&lt;iostream&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;list&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IProgress</span>{<span style="color:#75715e">//è§‚å¯Ÿè€…æŠ½è±¡åŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> DoProgress(<span style="color:#66d9ef">float</span> value)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#75715e">//è§‚å¯Ÿè€…éœ€è¦å®ç°çš„å‡½æ•°(æ”¶åˆ°é€šçŸ¥åè¢«è°ƒç”¨)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>IProgress(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FileSplitter</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  string m_filePath;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> m_fileNumber;
</span></span><span style="display:flex;"><span>  list<span style="color:#f92672">&lt;</span>IProgress<span style="color:#f92672">*&gt;</span>  m_iprogressList; <span style="color:#75715e">// æŠ½è±¡é€šçŸ¥æœºåˆ¶ï¼Œæ”¯æŒå¤šä¸ªè§‚å¯Ÿè€…
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//è¿™ç§æœºåˆ¶å°±ä¸å†ä¾èµ–å…·ä½“çš„è§‚å¯Ÿè€… ä¿è¯FileSplitterç±»å¤„ç†é€»è¾‘ç›¸å¯¹ç¨³å®š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  FileSplitter(<span style="color:#66d9ef">const</span> string<span style="color:#f92672">&amp;</span> filePath, <span style="color:#66d9ef">int</span> fileNumber) <span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  	m_filePath(filePath), 
</span></span><span style="display:flex;"><span>  	m_fileNumber(fileNumber){
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">split</span>(){
</span></span><span style="display:flex;"><span>  	<span style="color:#75715e">//1.è¯»å–å¤§æ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	<span style="color:#75715e">//2.åˆ†æ‰¹æ¬¡å‘å°æ–‡ä»¶ä¸­å†™å…¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> m_fileNumber; i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>  		<span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  		<span style="color:#66d9ef">float</span> progressValue <span style="color:#f92672">=</span> m_fileNumber;
</span></span><span style="display:flex;"><span>  		progressValue <span style="color:#f92672">=</span> (i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> progressValue;
</span></span><span style="display:flex;"><span>  		onProgress(progressValue);<span style="color:#75715e">//å‘é€é€šçŸ¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	}
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">addIProgress</span>(IProgress<span style="color:#f92672">*</span> iprogress){<span style="color:#75715e">//å¢åŠ è§‚å¯Ÿè€…API
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	m_iprogressList.push_back(iprogress);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">removeIProgress</span>(IProgress<span style="color:#f92672">*</span> iprogress){<span style="color:#75715e">//ç§»é™¤è§‚å¯Ÿè€…API
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	m_iprogressList.remove(iprogress);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> onProgress(<span style="color:#66d9ef">float</span> value){<span style="color:#75715e">//é€šçŸ¥å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	list<span style="color:#f92672">&lt;</span>IProgress<span style="color:#f92672">*&gt;::</span>iterator itor<span style="color:#f92672">=</span>m_iprogressList.begin();
</span></span><span style="display:flex;"><span>  	<span style="color:#66d9ef">while</span> (itor <span style="color:#f92672">!=</span> m_iprogressList.end() ){
</span></span><span style="display:flex;"><span>  		(<span style="color:#f92672">*</span>itor)<span style="color:#f92672">-&gt;</span>DoProgress(value); <span style="color:#75715e">//æ›´æ–°è¿›åº¦æ¡ è™šå‡½æ•°å¤šæ€è°ƒç”¨å¤šä¸ªè§‚å¯Ÿè€…çš„å¤„ç†å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  		itor<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>  	}
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;common.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include&lt;string&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainForm</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Form, <span style="color:#66d9ef">public</span> IProgress
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  TextBox<span style="color:#f92672">*</span> txtFilePath;
</span></span><span style="display:flex;"><span>  TextBox<span style="color:#f92672">*</span> txtFileNumber;
</span></span><span style="display:flex;"><span>  ProgressBar<span style="color:#f92672">*</span> progressBar;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> Button1_Click(){
</span></span><span style="display:flex;"><span>  	string filePath <span style="color:#f92672">=</span> txtFilePath<span style="color:#f92672">-&gt;</span>getText();
</span></span><span style="display:flex;"><span>  	<span style="color:#66d9ef">int</span> number <span style="color:#f92672">=</span> atoi(txtFileNumber<span style="color:#f92672">-&gt;</span>getText().c_str());
</span></span><span style="display:flex;"><span>  	ConsoleNotifier cn;
</span></span><span style="display:flex;"><span>  	FileSplitter <span style="color:#a6e22e">splitter</span>(filePath, number);
</span></span><span style="display:flex;"><span>  	splitter.addIProgress(<span style="color:#66d9ef">this</span>); <span style="color:#75715e">//è®¢é˜…é€šçŸ¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	splitter.addIProgress(<span style="color:#f92672">&amp;</span>cn)<span style="color:#960050;background-color:#1e0010">ï¼›</span> <span style="color:#75715e">//è®¢é˜…é€šçŸ¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	splitter.split();
</span></span><span style="display:flex;"><span>  	splitter.removeIProgress(<span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">DoProgress</span>(<span style="color:#66d9ef">float</span> value){
</span></span><span style="display:flex;"><span>  	progressBar<span style="color:#f92672">-&gt;</span>setValue(value);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ConsoleNotifier</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IProgress {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> DoProgress(<span style="color:#66d9ef">float</span> value){
</span></span><span style="display:flex;"><span>  	cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;.&#34;</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h1 id="è£…é¥°æ¨¡å¼decorator---å•ä¸€èŒè´£">è£…é¥°æ¨¡å¼Decorator&mdash;å•ä¸€èŒè´£<a hidden class="anchor" aria-hidden="true" href="#è£…é¥°æ¨¡å¼decorator---å•ä¸€èŒè´£">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯-3">éœ€æ±‚èƒŒæ™¯<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯-3">#</a></h2>
<p>éœ€è¦å®ç°æ–‡ä»¶æµæ“ä½œç®€æ˜“ç³»ç»Ÿï¼Œæ”¯æŒçš„æ“ä½œå¤§æ¦‚å°±å¤šäº› read seek writeï¼Œå­˜åœ¨æ™®é€šæ–‡ä»¶æµï¼Œç½‘ç»œæµï¼Œå†…å­˜æµç­‰ç­‰</p>
<p>éšç€ç³»ç»Ÿçš„å‘å±•ï¼Œéœ€è¦å¢åŠ å„ç§æµçš„åŠ å¯†åŠŸèƒ½</p>
<p>éšç€ç³»ç»Ÿçš„å‘å±•ï¼Œéœ€è¦å¢åŠ å„ç§æµçš„ç¼“å­˜åŠŸèƒ½</p>
<p>éšç€ç³»ç»Ÿçš„å‘å±•ï¼Œéœ€è¦å¢åŠ å„ç§æµçš„åŠ å¯†åŒæ—¶ç¼“å­˜åŠŸèƒ½</p>
<h2 id="ä¼ ç»Ÿå®ç°-2">ä¼ ç»Ÿå®ç°<a hidden class="anchor" aria-hidden="true" href="#ä¼ ç»Ÿå®ç°-2">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//ä¸šåŠ¡æ“ä½œ 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Stream</span>{<span style="color:#75715e">//æµæ“ä½œåŸºç±»ï¼Œå®šä¹‰ç›¸å…³æ¥å£è™šå‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">char</span> Read(<span style="color:#66d9ef">int</span> number)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Seek</span>(<span style="color:#66d9ef">int</span> position)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Write</span>(<span style="color:#66d9ef">char</span> data)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Stream(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ–‡ä»¶æµæ“ä½œä¸»ä½“ç±» åº”è¯¥ç»§æ‰¿StreamåŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FileStream</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Stream{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">char</span> Read(<span style="color:#66d9ef">int</span> number){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//è¯»æ–‡ä»¶æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Seek</span>(<span style="color:#66d9ef">int</span> position){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//å®šä½æ–‡ä»¶æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Write</span>(<span style="color:#66d9ef">char</span> data){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//å†™æ–‡ä»¶æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç½‘ç»œæµæ“ä½œç±» åº”è¯¥ç»§æ‰¿StreamåŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NetworkStream</span> <span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> Stream{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">char</span> Read(<span style="color:#66d9ef">int</span> number){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//è¯»ç½‘ç»œæµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Seek</span>(<span style="color:#66d9ef">int</span> position){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//å®šä½ç½‘ç»œæµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Write</span>(<span style="color:#66d9ef">char</span> data){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//å†™ç½‘ç»œæµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å†…å­˜æµæ“ä½œç±» åº”è¯¥ç»§æ‰¿StreamåŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MemoryStream</span> <span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> Stream{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">char</span> Read(<span style="color:#66d9ef">int</span> number){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//è¯»å†…å­˜æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Seek</span>(<span style="color:#66d9ef">int</span> position){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//å®šä½å†…å­˜æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Write</span>(<span style="color:#66d9ef">char</span> data){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//å†™å†…å­˜æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }  
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ‰©å±•åŠ å¯†çš„åŠŸèƒ½ ä¼ ç»Ÿæ–¹æ¡ˆæ–°å¢å¤šä¸ªç±» åˆ†åˆ«ç»§æ‰¿æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµæ“ä½œç±» å¤§é‡å­ç±»ç”Ÿæˆ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CryptoFileStream</span> <span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> FileStream{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">char</span> Read(<span style="color:#66d9ef">int</span> number){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...  è·Ÿç½‘ç»œæµã€å†…å­˜æµä»£ç å­˜åœ¨å¤§é‡é‡å¤
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      FileStream<span style="color:#f92672">::</span>Read(number);<span style="color:#75715e">//è¯»æ–‡ä»¶æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Seek</span>(<span style="color:#66d9ef">int</span> position){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...  è·Ÿç½‘ç»œæµã€å†…å­˜æµä»£ç å­˜åœ¨å¤§é‡é‡å¤
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      FileStream<span style="color:#f92672">::</span>Seek(position);<span style="color:#75715e">//å®šä½æ–‡ä»¶æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Write</span>(byte data){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      FileStream<span style="color:#f92672">::</span>Write(data);<span style="color:#75715e">//å†™æ–‡ä»¶æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ‰©å±•åŠ å¯†çš„åŠŸèƒ½ ä¼ ç»Ÿæ–¹æ¡ˆæ–°å¢å¤šä¸ªç±» åˆ†åˆ«ç»§æ‰¿æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµæ“ä½œç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CryptoNetworkStream</span> <span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> NetworkStream{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">char</span> Read(<span style="color:#66d9ef">int</span> number){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      NetworkStream<span style="color:#f92672">::</span>Read(number);<span style="color:#75715e">//è¯»ç½‘ç»œæµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Seek</span>(<span style="color:#66d9ef">int</span> position){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      NetworkStream<span style="color:#f92672">::</span>Seek(position);<span style="color:#75715e">//å®šä½ç½‘ç»œæµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Write</span>(byte data){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      NetworkStream<span style="color:#f92672">::</span>Write(data);<span style="color:#75715e">//å†™ç½‘ç»œæµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ‰©å±•åŠ å¯†çš„åŠŸèƒ½ ä¼ ç»Ÿæ–¹æ¡ˆæ–°å¢å¤šä¸ªç±» åˆ†åˆ«ç»§æ‰¿æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµæ“ä½œç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CryptoMemoryStream</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> MemoryStream{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">char</span> Read(<span style="color:#66d9ef">int</span> number){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      MemoryStream<span style="color:#f92672">::</span>Read(number);<span style="color:#75715e">//è¯»å†…å­˜æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Seek</span>(<span style="color:#66d9ef">int</span> position){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      MemoryStream<span style="color:#f92672">::</span>Seek(position);<span style="color:#75715e">//å®šä½å†…å­˜æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Write</span>(byte data){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      MemoryStream<span style="color:#f92672">::</span>Write(data);<span style="color:#75715e">//å†™å†…å­˜æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ‰©å±•ç¼“å­˜çš„åŠŸèƒ½ ä¼ ç»Ÿæ–¹æ¡ˆæ–°å¢å¤šä¸ªç±» åˆ†åˆ«ç»§æ‰¿æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµæ“ä½œç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BufferedFileStream</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> FileStream{
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//é¢å¤–çš„ç¼“å­˜æ“ä½œ...  è·Ÿç½‘ç»œæµã€å†…å­˜æµä»£ç å­˜åœ¨å¤§é‡é‡å¤
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BufferedNetworkStream</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> NetworkStream{
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BufferedMemoryStream</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> MemoryStream{
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ‰©å±•åŠ å¯†+ç¼“å­˜ç»„åˆçš„çš„åŠŸèƒ½ ä¼ ç»Ÿæ–¹æ¡ˆæ–°å¢å¤šä¸ªç±» åˆ†åˆ«ç»§æ‰¿æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµæ“ä½œç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CryptoBufferedFileStream</span> <span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> FileStream{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">char</span> Read(<span style="color:#66d9ef">int</span> number){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//ä»£ç å¤§é‡é‡å¤ ç”Ÿæˆå¤§é‡å­ç±» æ‰©å±•ä¸€ä¸ªåŠŸèƒ½éå¸¸ä¸çµæ´»ï¼Œå¢åŠ ç»´æŠ¤æˆæœ¬
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      FileStream<span style="color:#f92672">::</span>Read(number);<span style="color:#75715e">//è¯»æ–‡ä»¶æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Seek</span>(<span style="color:#66d9ef">int</span> position){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„ç¼“å†²æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      FileStream<span style="color:#f92672">::</span>Seek(position);<span style="color:#75715e">//å®šä½æ–‡ä»¶æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„ç¼“å†²æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Write</span>(byte data){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„ç¼“å†²æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      FileStream<span style="color:#f92672">::</span>Write(data);<span style="color:#75715e">//å†™æ–‡ä»¶æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„ç¼“å†²æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Process</span>(){
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//ç¼–è¯‘æ—¶è£…é… ä¹Ÿå°±æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™å·²ç»å†³å®šäº†è¦ä½¿ç”¨å“ªç§æ‰©å±•åŠŸèƒ½å¯¹åº”çš„å­ç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  CryptoFileStream <span style="color:#f92672">*</span>fs1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> CryptoFileStream();
</span></span><span style="display:flex;"><span>  BufferedFileStream <span style="color:#f92672">*</span>fs2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedFileStream();
</span></span><span style="display:flex;"><span>  CryptoBufferedFileStream <span style="color:#f92672">*</span>fs3 <span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> CryptoBufferedFileStream();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="åŠ¨æœº-3">åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#åŠ¨æœº-3">#</a></h2>
<ul>
<li>æ»¥ç”¨ç»§æ‰¿æ¥æ‰©å±•å¯¹è±¡çš„åŠŸèƒ½ï¼Œç”±äºç»§æ‰¿ä¸ºç±»å‹å¼•å…¥çš„é™æ€ç‰¹è´¨ï¼Œå¯¼è‡´è¿™ç§æ‰©å±•æ–¹å¼å˜å¾—éå¸¸ä¸çµæ´»ï¼Œè€Œä¸”å¦‚æœæ‰©å±•çš„åŠŸèƒ½å¾ˆå¤šæˆ–è€…éœ€è¦ç»„åˆï¼Œå°†ä¼šäº§ç”Ÿå¤§é‡çš„å­ç±»ï¼Œå¯¹é¡¹ç›®çš„ç»´æŠ¤æˆæœ¬å¤§å¹…åº¦å¢åŠ ã€‚</li>
</ul>
<h2 id="æ¨¡å¼çš„å®šä¹‰-2">æ¨¡å¼çš„å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼çš„å®šä¹‰-2">#</a></h2>
<ul>
<li>ä¸ä½¿ç”¨ç»§æ‰¿ï¼Œæ”¹ç”¨ç»„åˆçš„æ–¹å¼åŠ¨æ€çš„ç»™å¯¹è±¡å¢åŠ ä¸€äº›æ‰©å±•åŠŸèƒ½ã€‚å¯¹äºæ–°å¢æ‰©å±•åŠŸèƒ½è€Œè¨€ï¼ŒDecoratorè£…é¥°æ¨¡å¼æ¯”æ»¥ç”¨ç»§æ‰¿çš„æ–¹å¼æ›´åŠ çµæ´»(å› ä¸ºå¯ä»¥æ¶ˆé™¤å¤§é‡çš„é‡å¤ä»£ç åŒæ—¶å‡å°‘å­ç±»çš„æ•°é‡ï¼Œå‡å°‘ç»´æŠ¤çš„æˆæœ¬)</li>
</ul>
<h2 id="ç»“æ„å›¾è§£-1">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-1">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_%e6%bb%a5%e7%94%a8%e7%bb%a7%e6%89%bf%e4%b8%8d%e4%bd%bf%e7%94%a8%e8%a3%85%e9%a5%b0%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_%e8%a3%85%e9%a5%b0%e6%a8%a1%e5%bc%8f%e7%ae%80%e5%8d%95%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Decorator%e6%a8%a1%e5%bc%8f%e7%bb%93%e6%9e%84%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="è¦ç‚¹æ€»ç»“-3">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-3">#</a></h2>
<ul>
<li>é‡‡ç”¨ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿çš„æ–¹å¼ï¼ŒDecoratorè£…é¥°æ¨¡å¼å®ç°äº†åœ¨è¿è¡Œæ—¶åŠ¨æ€æ‰©å±•å¯¹è±¡åŠŸèƒ½çš„èƒ½åŠ›ï¼Œè€Œä¸”å¯ä»¥æ ¹æ®éœ€è¦æ‰©å±•å¤šä¸ªåŠŸèƒ½ï¼Œé¿å…äº†å¤§é‡çš„é‡å¤ä»£ç ï¼ŒåŒæ—¶å¤§é‡çš„å­ç±»äº§ç”Ÿçš„é—®é¢˜</li>
<li>è£…é¥°ç±»åœ¨æ¥å£ä¸Šå˜ç°ä¸ºis-aå…³ç³»ï¼Œä¹Ÿå°±æ˜¯ç»§æ‰¿ä¸šåŠ¡æ“ä½œç»„ä»¶åŸºç±»ï¼Œä½†åœ¨å®ç°ä¸Šåˆæ˜¯has-aç»„åˆçš„å…³ç³»ï¼Œæˆå‘˜æ‹¥æœ‰ä¸šåŠ¡æ“ä½œç»„ä»¶åŸºç±»æŒ‡é’ˆï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€çš„ä¼ å…¥ä¸åŒç±»åˆ«çš„ä¸šåŠ¡æ“ä½œå­ç±»ï¼Œæ¥å®ç°ç›¸åº”æ“ä½œï¼ŒåŒæ—¶æ‰©å±•åŠŸèƒ½</li>
<li>Decoratorè£…é¥°æ¨¡å¼çš„ç›®çš„å¹¶ä¸æ˜¯è§£å†³â€œå¤šå­ç±»è¡ç”Ÿçš„å¤šç»§æ‰¿é—®é¢˜â€ï¼Œé‡è¦æ˜¯åœ¨è§£å†³â€œä¸»ä½“ç±»åœ¨å¤šä¸ªæ–¹å‘ä¸Šçš„æ‰©å±•é—®é¢˜â€</li>
</ul>
<h2 id="ç®€æ˜“ä»£ç ">ç®€æ˜“ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ç®€æ˜“ä»£ç ">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//ä¸šåŠ¡æ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Stream</span>{<span style="color:#75715e">//æµæ“ä½œåŸºç±»ï¼Œå®šä¹‰ç›¸å…³æ¥å£è™šå‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#960050;background-color:#1e0010">ï¼š</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">char</span> Read(<span style="color:#66d9ef">int</span> number)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Seek</span>(<span style="color:#66d9ef">int</span> position)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Write</span>(<span style="color:#66d9ef">char</span> data)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Stream(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ–‡ä»¶æµæ“ä½œä¸»ä½“ç±» åº”è¯¥ç»§æ‰¿StreamåŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FileStream</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Stream{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">char</span> Read(<span style="color:#66d9ef">int</span> number){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//è¯»æ–‡ä»¶æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Seek</span>(<span style="color:#66d9ef">int</span> position){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//å®šä½æ–‡ä»¶æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Write</span>(<span style="color:#66d9ef">char</span> data){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//å†™æ–‡ä»¶æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç½‘ç»œæµæ“ä½œç±» åº”è¯¥ç»§æ‰¿StreamåŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NetworkStream</span> <span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> Stream{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">char</span> Read(<span style="color:#66d9ef">int</span> number){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//è¯»ç½‘ç»œæµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Seek</span>(<span style="color:#66d9ef">int</span> position){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//å®šä½ç½‘ç»œæµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Write</span>(<span style="color:#66d9ef">char</span> data){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//å†™ç½‘ç»œæµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å†…å­˜æµæ“ä½œç±» åº”è¯¥ç»§æ‰¿StreamåŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MemoryStream</span> <span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> Stream{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">char</span> Read(<span style="color:#66d9ef">int</span> number){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//è¯»å†…å­˜æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Seek</span>(<span style="color:#66d9ef">int</span> position){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//å®šä½å†…å­˜æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Write</span>(<span style="color:#66d9ef">char</span> data){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//å†™å†…å­˜æµ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ‰©å±•åŠŸèƒ½è£…é¥°åŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>DecoratorStream: <span style="color:#66d9ef">public</span> Stream{<span style="color:#75715e">//ç»§æ‰¿ä¸šåŠ¡ç»„ä»¶æ“ä½œåŸºç±» ä¸»è¦æ˜¯ç”¨äºå®ç°ç›¸å…³æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Stream<span style="color:#f92672">*</span> stream;<span style="color:#75715e">//ä¿å­˜ä¸šåŠ¡ç»„ä»¶æ“ä½œåŸºç±»æŒ‡é’ˆï¼Œè¿è¡Œæ—¶åŠ¨æ€çš„ä¼ å…¥ç›¸åº”çš„ä¸šåŠ¡æ“ä½œä¸»ä½“å­ç±»å®ç°ç›¸å…³æ“ä½œå¹¶æ‰©å±•åŠŸèƒ½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  DecoratorStream(Stream <span style="color:#f92672">*</span> stm)<span style="color:#f92672">:</span>stream(stm){
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//åŠ å¯†æ‰©å±•åŠŸèƒ½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CryptoStream</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> DecoratorStream {<span style="color:#75715e">//ç»§æ‰¿è£…é¥°åŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  CryptoStream(Stream<span style="color:#f92672">*</span> stm)<span style="color:#f92672">:</span>DecoratorStream(stm){
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">char</span> <span style="color:#a6e22e">Read</span>(<span style="color:#66d9ef">int</span> number){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      stream<span style="color:#f92672">-&gt;</span>Read(number);<span style="color:#75715e">//è¿™é‡Œä¼šå¤šæ€çš„è°ƒç”¨ä¸åŒçš„æµæ“ä½œ(æ–‡ä»¶ã€ç½‘ç»œã€å†…å­˜) æ²¡æœ‰é‡å¤ä»£ç 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Seek</span>(<span style="color:#66d9ef">int</span> position){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      stream<span style="color:#f92672">::</span>Seek(position);<span style="color:#75715e">//è¿™é‡Œä¼šå¤šæ€çš„è°ƒç”¨ä¸åŒçš„æµæ“ä½œ(æ–‡ä»¶ã€ç½‘ç»œã€å†…å­˜)æ²¡æœ‰é‡å¤ä»£ç 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Write</span>(byte data){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      stream<span style="color:#f92672">::</span>Write(data);<span style="color:#75715e">//è¿™é‡Œä¼šå¤šæ€çš„è°ƒç”¨ä¸åŒçš„æµæ“ä½œ(æ–‡ä»¶ã€ç½‘ç»œã€å†…å­˜)æ²¡æœ‰é‡å¤ä»£ç 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é¢å¤–çš„åŠ å¯†æ“ä½œ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ä¸åŒæµæ“ä½œå¢åŠ ç¼“å­˜åŠŸèƒ½ è·Ÿå¢åŠ åŠ å¯†åŠŸèƒ½ä¸€æ · åªç”Ÿæˆäº†ä¸€ä¸ªç±» åŒæ—¶åœ¨è¿è¡Œæ—¶å¤šæ€çš„è°ƒç”¨ä¸åŒçš„æµæ“ä½œ(æ–‡ä»¶ã€ç½‘ç»œã€å†…å­˜)æ²¡æœ‰é‡å¤ä»£ç 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BufferedStream</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> DecoratorStream{
</span></span><span style="display:flex;"><span>  Stream<span style="color:#f92672">*</span> stream;<span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  BufferedStream(Stream<span style="color:#f92672">*</span> stm)<span style="color:#f92672">:</span>DecoratorStream(stm){
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Process</span>(){
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//è¿è¡Œæ—¶è£…é… 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  FileStream<span style="color:#f92672">*</span> s1<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> FileStream();
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//è¿™é‡Œs1å¯ä»¥åŠ¨æ€çš„ä¼ å…¥æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµï¼Œæ¥å®ç°ä¸åŒç±»åˆ«æµæ“ä½œçš„åŠ å¯†æ‰©å±•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  CryptoStream<span style="color:#f92672">*</span> s2<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> CryptoStream(s1);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//è¿™é‡Œs1å¯ä»¥åŠ¨æ€çš„ä¼ å…¥æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµï¼Œæ¥å®ç°ä¸åŒç±»åˆ«æµæ“ä½œçš„ç¼“å­˜æ‰©å±•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  BufferedStream<span style="color:#f92672">*</span> s3<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> BufferedStream(s1);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//è¿™é‡Œs2å¯ä»¥åŠ¨æ€çš„ä¼ å…¥æ–‡ä»¶æµã€ç½‘ç»œæµã€å†…å­˜æµï¼Œæ¥å®ç°ä¸åŒç±»åˆ«æµæ“ä½œçš„åŠ å¯†ç¼“å­˜æ‰©å±•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  BufferedStream<span style="color:#f92672">*</span> s4<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> BufferedStream(s2);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="æ¡¥æ¨¡å¼bridge---å•ä¸€èŒè´£">æ¡¥æ¨¡å¼Bridge&mdash;å•ä¸€èŒè´£<a hidden class="anchor" aria-hidden="true" href="#æ¡¥æ¨¡å¼bridge---å•ä¸€èŒè´£">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯-4">éœ€æ±‚èƒŒæ™¯<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯-4">#</a></h2>
<p>éœ€è¦å®ç°å¤šå¹³å°(pcã€mobileã€padï¼Œtv)ç­‰ç­‰ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªçº¬åº¦ï¼ŒåŒæ—¶ä¹Ÿè¦å‘å¸ƒä¸€ä¸ªç»å…¸è½»é‡ç‰ˆæœ¬å’Œå®Œç¾å¤æ‚ç‰ˆæœ¬(æ¯”å¦‚å‘æ–‡å­—æ¶ˆæ¯çš„æ—¶å€™ä¹Ÿæ’­æ”¾å£°éŸ³)ï¼Œè¿™åˆæ˜¯ä¸€ä¸ªçº¬åº¦çš„å˜åŒ– ä¸‹é¢çœ‹çœ‹ç»å…¸çš„å®ç°</p>
<h2 id="ä¼ ç»Ÿå®ç°-3">ä¼ ç»Ÿå®ç°<a hidden class="anchor" aria-hidden="true" href="#ä¼ ç»Ÿå®ç°-3">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Messager</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//ä¸‹é¢æ˜¯ä¸‰ä¸ªé€šç”¨æ¥å£æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> Login(string username, string password)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendMessage</span>(string message)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendPicture</span>(Image image)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//ä¸‹é¢æ˜¯æ¶‰åŠä¸åŒçš„å¹³å°éœ€è¦å®ç°ä¸åŒçš„æ–¹æ³• PlaySoundæ–¹æ³•åªæœ‰å®Œç¾ç‰ˆç”¨åˆ°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">PlaySound</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">DrawShape</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">WriteText</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Connect</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Messager(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//PCå¹³å°å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PCMessagerBase</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Messager{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> PlaySound(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//**********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">DrawShape</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//**********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">WriteText</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//**********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Connect</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//**********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ‰‹æœºå¹³å°å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MobileMessagerBase</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Messager{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> PlaySound(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//==========
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">DrawShape</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//==========
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">WriteText</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//==========
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Connect</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//==========
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ä¸šåŠ¡æŠ½è±¡ ç»å…¸è½»é‡å‘å¸ƒç‰ˆæœ¬ æœ¬èº«æ˜¯ä¸šåŠ¡æŠ½è±¡çº¬åº¦ï¼Œä½†å› ä¸ºå¦å¤–ä¸€ä¸ªçº¬åº¦ä¹Ÿè¦å˜åŒ–(å¹³å°çº¬åº¦) æ‰€ä»¥ç»å…¸å‘å¸ƒç‰ˆæœ¬ä¹Ÿè¦æœ‰å¤šä¸ªå¹³å°ç±»çš„å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PCMessagerLite</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> PCMessagerBase {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> Login(string username, string password){
</span></span><span style="display:flex;"><span>      PCMessagerBase<span style="color:#f92672">::</span>Connect();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendMessage</span>(string message){ 
</span></span><span style="display:flex;"><span>      PCMessagerBase<span style="color:#f92672">::</span>WriteText();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendPicture</span>(Image image){
</span></span><span style="display:flex;"><span>      PCMessagerBase<span style="color:#f92672">::</span>DrawShape();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ä¸šåŠ¡æŠ½è±¡ å®Œç¾å¤æ‚ç‰ˆæœ¬ æœ¬èº«æ˜¯ä¸šåŠ¡æŠ½è±¡çº¬åº¦ï¼Œä½†å› ä¸ºå¦å¤–ä¸€ä¸ªçº¬åº¦ä¹Ÿè¦å˜åŒ–(å¹³å°çº¬åº¦) æ‰€ä»¥å®Œç¾å¤æ‚ç‰ˆæœ¬ä¹Ÿè¦æœ‰å¤šä¸ªå¹³å°ç±»çš„å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PCMessagerPerfect</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> PCMessagerBase {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> Login(string username, string password){
</span></span><span style="display:flex;"><span>      PCMessagerBase<span style="color:#f92672">::</span>PlaySound();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      PCMessagerBase<span style="color:#f92672">::</span>Connect();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendMessage</span>(string message){
</span></span><span style="display:flex;"><span>      PCMessagerBase<span style="color:#f92672">::</span>PlaySound();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      PCMessagerBase<span style="color:#f92672">::</span>WriteText();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendPicture</span>(Image image){
</span></span><span style="display:flex;"><span>      PCMessagerBase<span style="color:#f92672">::</span>PlaySound();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      PCMessagerBase<span style="color:#f92672">::</span>DrawShape();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MobileMessagerLite</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> MobileMessagerBase {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> Login(string username, string password){   
</span></span><span style="display:flex;"><span>      MobileMessagerBase<span style="color:#f92672">::</span>Connect();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendMessage</span>(string message){
</span></span><span style="display:flex;"><span>      MobileMessagerBase<span style="color:#f92672">::</span>WriteText();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendPicture</span>(Image image){
</span></span><span style="display:flex;"><span>      MobileMessagerBase<span style="color:#f92672">::</span>DrawShape();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ä¸šåŠ¡æŠ½è±¡ ç»å…¸è½»é‡å‘å¸ƒç‰ˆæœ¬ æœ¬èº«æ˜¯ä¸šåŠ¡æŠ½è±¡çº¬åº¦ï¼Œä½†å› ä¸ºå¦å¤–ä¸€ä¸ªçº¬åº¦ä¹Ÿè¦å˜åŒ–(å¹³å°çº¬åº¦) æ‰€ä»¥ç»å…¸å‘å¸ƒç‰ˆæœ¬ä¹Ÿè¦æœ‰å¤šä¸ªå¹³å°ç±»çš„å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//è¿™é‡Œæ˜¯æ‰‹æœºå¹³å°å®ç° è·Ÿpcå¹³å°å­˜åœ¨å¤§é‡ç±»ä¼¼é‡å¤ä»£ç 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MobileMessagerPerfect</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> MobileMessagerBase {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> Login(string username, string password){
</span></span><span style="display:flex;"><span>      MobileMessagerBase<span style="color:#f92672">::</span>PlaySound();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      MobileMessagerBase<span style="color:#f92672">::</span>Connect();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendMessage</span>(string message){
</span></span><span style="display:flex;"><span>      MobileMessagerBase<span style="color:#f92672">::</span>PlaySound();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      MobileMessagerBase<span style="color:#f92672">::</span>WriteText();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendPicture</span>(Image image){
</span></span><span style="display:flex;"><span>      MobileMessagerBase<span style="color:#f92672">::</span>PlaySound();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      MobileMessagerBase<span style="color:#f92672">::</span>DrawShape();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å®é™…è°ƒç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Process</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//ç¼–è¯‘æ—¶è£…é… éœ€è¦æŒ‡å®šä¸åŒå¹³å°çš„ä¸ç”¨ä¸šåŠ¡æŠ½è±¡ æ¯”å¦‚æ‰‹æœºå¹³å°ç»å…¸ç‰ˆæœ¬ æ‰‹æœºå¹³å°å®Œç¾ç‰ˆæœ¬ç­‰ç­‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//æ‰€ä»¥è¿™é‡Œå¦‚æœ‰ä¸€ä¸ªçº¬åº¦å˜åŒ–--ä¸šåŠ¡æŠ½è±¡æœ‰Mä¸ª(ç»å…¸ç‰ˆæœ¬ã€å®Œç¾ç‰ˆæœ¬...),å¦å¤–ä¸€ä¸ªçº¬åº¦å˜åŒ–å¹³å°å®ç°æœ‰Nä¸ª(pcã€mobileã€padã€tv...)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//é‚£ä¹ˆç±»è‡³å°‘éœ€è¦1(messager)+N(å¹³å°å®ç°åŸºç±»)+M*N(æœ€ç»ˆç”¨äºç”¨äºå‘å¸ƒçš„ç±» æ¯”å¦‚ä¸‹é¢çš„æ‰‹æœºå¹³å°å®Œç¾ç‰ˆæœ¬ç±»)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      Messager <span style="color:#f92672">*</span>m <span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> MobileMessagerPerfect();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="åŠ¨æœº-4">åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#åŠ¨æœº-4">#</a></h2>
<p>æŸäº›ç±»å‹çš„å›ºæœ‰å®ç°é€»è¾‘ï¼Œä½¿å¾—å®ƒä»¬æœ‰2ä¸ªçº¬åº¦çš„å˜åŒ–ï¼Œæˆ–è€…å¤šä¸ªçº¬åº¦çš„å˜åŒ–</p>
<ul>
<li>
<p>æ‰€ä»¥è¦åˆ©ç”¨é¢å‘å¯¹è±¡æŠ€æœ¯ä½¿å¾—ç±»å‹å¯ä»¥è½»æ¾çš„æ²¿ç€2ä¸ªæˆ–è€…å¤šä¸ªæ–¹å‘å˜åŒ–</p>
</li>
<li>
<p>å‡è®¾éœ€è¦å®ç°ä¸€ä¸ªå‘æ¶ˆæ¯çš„ä¸šåŠ¡ï¼Œå¤§è‡´æœ‰ä¸‰ä¸ªæ–¹æ³•loginç™»å½•ï¼ŒsendMessageå‘æ–‡å­—æ¶ˆæ¯ sendPictureå‘å›¾ç‰‡</p>
</li>
</ul>
<h2 id="æ¨¡å¼å®šä¹‰-1">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-1">#</a></h2>
<ul>
<li>å°†æŠ½è±¡éƒ¨åˆ†(ä¸šåŠ¡åŠŸèƒ½)ä¸å®ç°éƒ¨åˆ†(å¹³å°å®ç°)åˆ†ç¦»ï¼Œä½¿å®ƒä»¬ éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–</li>
</ul>
<h2 id="ç»“æ„å›¾è§£-2">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-2">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Bridge%e6%a1%a5%e6%a8%a1%e5%bc%8f%e7%bb%93%e6%9e%84%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="è¦ç‚¹æ€»ç»“-4">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-4">#</a></h2>
<ul>
<li>
<p>Bridgeæ¨¡å¼ä½¿ç”¨â€œå¯¹è±¡é—´çš„ç»„åˆå…³ç³»â€è§£è€¦äº†æŠ½è±¡å’Œå®ç°ä¹‹é—´å›ºæœ‰çš„ç»‘å®šå…³ç³»ï¼Œä½¿å¾—æŠ½è±¡å’Œå®ç°å¯ä»¥æ²¿ç€å„è‡ªçš„ç»´åº¦æ¥å˜åŒ–ã€‚æ‰€è°“ æŠ½è±¡å’Œå®ç°æ²¿ç€å„è‡ªçº¬åº¦çš„å˜åŒ–ï¼Œå³â€œå­ç±»åŒ–â€å®ƒä»¬ã€‚</p>
</li>
<li>
<p>Bridgeæ¨¡å¼æœ‰æ—¶å€™ç±»ä¼¼äºå¤šç»§æ‰¿æ–¹æ¡ˆï¼Œä½†æ˜¯å¤šç»§æ‰¿æ–¹æ¡ˆå¾€å¾€è¿èƒŒ å•ä¸€èŒè´£åŸåˆ™(å³ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå˜åŒ–çš„åŸå› )ï¼Œå¤ç”¨æ€§æ¯”è¾ƒå·®ã€‚ Bridgeæ¨¡å¼æ˜¯æ¯”å¤šç»§æ‰¿æ–¹æ¡ˆæ›´å¥½çš„è§£å†³æ–¹æ³•ã€‚</p>
</li>
<li>
<p>Bridgeæ¨¡å¼çš„åº”ç”¨ä¸€èˆ¬åœ¨â€œä¸¤ä¸ªéå¸¸å¼ºçš„å˜åŒ–ç»´åº¦â€ï¼Œæœ‰æ—¶ä¸€ä¸ª ç±»ä¹Ÿæœ‰å¤šäºä¸¤ä¸ªçš„å˜åŒ–ç»´åº¦ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨Bridgeçš„æ‰©å±•æ¨¡å¼</p>
</li>
</ul>
<h2 id="ä»£ç å®ç°">ä»£ç å®ç°<a hidden class="anchor" aria-hidden="true" href="#ä»£ç å®ç°">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//ä¸šåŠ¡æŠ½è±¡åŸºç±» å®šä¹‰ç›¸å…³æ¥å£æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Messager</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>   MessagerImp<span style="color:#f92672">*</span> messagerImp;<span style="color:#75715e">//ç”¨äºå¹³å°å®ç°åŸºç±»æŒ‡é’ˆ åœ¨å¹³å°åˆ‡æ¢æ–¹é¢å¯ä»¥è¿è¡Œæ—¶çµæ´»å˜åŒ–
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> Login(string username, string password)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendMessage</span>(string message)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendPicture</span>(Image image)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Messager(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å¹³å°å®ç°åŸºç±» å®šä¹‰ç›¸å…³æ¥å£æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MessagerImp</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> PlaySound()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">DrawShape</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">WriteText</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Connect</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#a6e22e">MessagerImp</span>(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ä¸åŒå¹³å°å®ç°å­ç±» è¿™é‡Œæ˜¯pc
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PCMessagerImp</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> MessagerImp{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> PlaySound(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//**********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">DrawShape</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//**********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">WriteText</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//**********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Connect</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//**********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ä¸åŒå¹³å°å®ç°å­ç±» è¿™é‡Œæ˜¯mobile
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MobileMessagerImp</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> MessagerImp{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> PlaySound(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//==========
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">DrawShape</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//==========
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">WriteText</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//==========
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Connect</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//==========
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ä¸šåŠ¡æŠ½è±¡å­ç±»å®ç° è¿™é‡Œæ˜¯ç»å…¸ç‰ˆæœ¬  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MessagerLite</span> <span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> Messager {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> Login(string username, string password){
</span></span><span style="display:flex;"><span>      messagerImp<span style="color:#f92672">-&gt;</span>Connect();<span style="color:#75715e">//é€šè¿‡åŸºç±»æ‹¥æœ‰çš„å¹³å°å®ç°åŸºç±»æŒ‡é’ˆ åœ¨ä¸åŒå¹³å°é—´çµæ´»åˆ‡æ¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendMessage</span>(string message){
</span></span><span style="display:flex;"><span>      messagerImp<span style="color:#f92672">-&gt;</span>WriteText();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendPicture</span>(Image image){
</span></span><span style="display:flex;"><span>      messagerImp<span style="color:#f92672">-&gt;</span>DrawShape();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ä¸šåŠ¡æŠ½è±¡å­ç±»å®ç° è¿™é‡Œæ˜¯å®Œç¾ç‰ˆæœ¬ 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MessagerPerfect</span>  <span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> Messager {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> Login(string username, string password){
</span></span><span style="display:flex;"><span>      messagerImp<span style="color:#f92672">-&gt;</span>PlaySound();<span style="color:#75715e">//é€šè¿‡åŸºç±»æ‹¥æœ‰çš„å¹³å°å®ç°åŸºç±»æŒ‡é’ˆ åœ¨ä¸åŒå¹³å°é—´çµæ´»åˆ‡æ¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      messagerImp<span style="color:#f92672">-&gt;</span>Connect();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendMessage</span>(string message){
</span></span><span style="display:flex;"><span>      messagerImp<span style="color:#f92672">-&gt;</span>PlaySound();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      messagerImp<span style="color:#f92672">-&gt;</span>WriteText();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendPicture</span>(Image image){
</span></span><span style="display:flex;"><span>      messagerImp<span style="color:#f92672">-&gt;</span>PlaySound();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      messagerImp<span style="color:#f92672">-&gt;</span>DrawShape();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Process</span>(){
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//è¿è¡Œæ—¶è£…é…  ç±»çš„æ•°é‡å¤§å¹…å‡å°‘ ä½†æ˜¯å®ç°å¹¶æ²¡æœ‰æ‰“æŠ˜æ‰£ï¼Œè¿™é‡Œåœ¨è¿è¡Œæ˜¯åˆå§‹åŒ–æƒ³è¦çš„å¹³å°å®ç°å­ç±»å°±å¯ä»¥åŠ¨æ€çµæ´»å˜åŒ–
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  MessagerImp<span style="color:#f92672">*</span> mImp<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> PCMessagerImp();
</span></span><span style="display:flex;"><span>  Messager <span style="color:#f92672">*</span>m <span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> MessagerPerfect(mImp);<span style="color:#75715e">//ä¼ å…¥pcå¹³å°å­ç±» å®ç°pcå®Œç¾ç‰ˆæœ¬
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><h1 id="å·¥å‚æ¨¡å¼factory---å¯¹è±¡åˆ›å»º">å·¥å‚æ¨¡å¼factory&mdash;å¯¹è±¡åˆ›å»º<a hidden class="anchor" aria-hidden="true" href="#å·¥å‚æ¨¡å¼factory---å¯¹è±¡åˆ›å»º">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯-5">éœ€æ±‚èƒŒæ™¯<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯-5">#</a></h2>
<p>æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªæ–‡ä»¶åˆ†å‰²å™¨ï¼Œæ”¯æŒåˆ†å‰²å¤šç§ç±»å‹æ–‡ä»¶(æ–‡æœ¬æ–‡ä»¶ã€æ™®é€šäºŒè¿›åˆ¶æ–‡ä»¶ã€å›¾ç‰‡ã€è§†é¢‘ç­‰ç­‰)ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦æ ¹æ®éœ€æ±‚åˆ›å»ºå¯¹è±¡</p>
<h2 id="ä¼ ç»Ÿå®ç°-4">ä¼ ç»Ÿå®ç°<a hidden class="anchor" aria-hidden="true" href="#ä¼ ç»Ÿå®ç°-4">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//æ–‡ä»¶åˆ†å‰²åŸºç±» æ–‡ä»¶åˆ†å‰²å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ISplitter</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> split()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>ISplitter(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ–‡ä»¶åˆ†å‰²å­ç±» äºŒè¿›åˆ¶æ–‡ä»¶ã€æ–‡æœ¬æ–‡ä»¶ã€å›¾ç‰‡ã€è§†é¢‘
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BinarySplitter</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISplitter{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TxtSplitter</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISplitter{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PictureSplitter</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISplitter{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">VideoSplitter</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISplitter{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//  ---------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//é«˜å±‚è°ƒç”¨æ¨¡å—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainForm</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Form
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> Button1_Click(){
</span></span><span style="display:flex;"><span>  	ISplitter <span style="color:#f92672">*</span> splitter<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> BinarySplitter();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//ä¾èµ–å…·ä½“ç±» è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™ é«˜å±‚ç¨³å®šæ¨¡å—åº”è¯¥ä¾èµ–æŠ½è±¡è€Œä¸åº”è¯¥ä¾èµ–å…·ä½“çš„å®ç°ç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//è¿™é‡Œçš„ä¾èµ–ä¸ºç¼–è¯‘æ—¶ä¾èµ– å…·ä½“çš„å®ç°ç±»å¯èƒ½åå¤å˜åŒ–å°±ä¼šå¯¼è‡´é«˜å±‚æ¨¡å—ä¹Ÿéœ€è¦è·Ÿç€ç¼–è¯‘ç”šè‡³ä¿®æ”¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      splitter<span style="color:#f92672">-&gt;</span>split();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="åŠ¨æœº-5">åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#åŠ¨æœº-5">#</a></h2>
<ul>
<li>åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œç»å¸¸é¢ä¸´ç€åˆ›å»ºå¯¹è±¡çš„å·¥ä½œ;ç”±äºéœ€æ±‚çš„å˜åŒ–ï¼Œ éœ€è¦åˆ›å»ºçš„å¯¹è±¡çš„å…·ä½“ç±»å‹ç»å¸¸å˜åŒ–</li>
<li>å› ä¸ºç›´æ¥newä¼šä¾èµ–å…·ä½“çš„å®ç°ç±» æ‰€ä»¥è¦æƒ³åŠæ³•ç»•è¿‡new è¿è¡Œæ—¶åŠ¨æ€çš„newå‡ºç›¸åº”çš„ç±»</li>
<li>ä¸€èˆ¬æ˜¯æ¥å£æŠ½è±¡ä¹‹åçš„ç¬¬ä¸€æ­¥å·¥ä½œ</li>
</ul>
<h2 id="æ¨¡å¼å®šä¹‰-2">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-2">#</a></h2>
<ul>
<li>å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚</li>
<li>Factory Methodä½¿å¾—ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿ(ç›®çš„:è§£è€¦ï¼Œ æ‰‹æ®µ:è™šå‡½æ•°)åˆ°å­ç±»</li>
</ul>
<h2 id="å·¥å‚æ¨¡å¼ä»£ç å®ç°">å·¥å‚æ¨¡å¼ä»£ç å®ç°<a hidden class="anchor" aria-hidden="true" href="#å·¥å‚æ¨¡å¼ä»£ç å®ç°">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//ä¸šåŠ¡æŠ½è±¡åŸºç±» ä¸å·¥å‚æŠ½è±¡åŸºç±»å¯ä»¥æ”¾åœ¨ä¸€èµ·
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ISplitter</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> split()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>ISplitter(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å·¥å‚æŠ½è±¡åŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SplitterFactory</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> ISplitter<span style="color:#f92672">*</span> CreateSplitter()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>SplitterFactory(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//é«˜å±‚è°ƒç”¨æ¨¡å—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainForm</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Form
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  SplitterFactory<span style="color:#f92672">*</span>  factory;<span style="color:#75715e">//å·¥å‚æŠ½è±¡åŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  MainForm(SplitterFactory<span style="color:#f92672">*</span>  factory){<span style="color:#75715e">//é€šè¿‡æ„é€ æ–¹æ³• è®©æ›´é«˜å±‚å®é™…ä½¿ç”¨è€… ä¼ å…¥å…·ä½“çš„å·¥å‚å­ç±» 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>factory<span style="color:#f92672">=</span>factory;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Button1_Click</span>(){
</span></span><span style="display:flex;"><span>  	ISplitter <span style="color:#f92672">*</span> splitter<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>          factory<span style="color:#f92672">-&gt;</span>CreateSplitter(); 
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å¤šæ€new é€šè¿‡å…·ä½“çš„å·¥å‚å­ç±»å®ä¾‹åŒ–å…·ä½“çš„ä¸šåŠ¡å­ç±» è¿™é‡Œä¸å†ä¾èµ–å…·ä½“çš„ä¸šåŠ¡å­ç±» ä¾èµ–çš„æ˜¯å·¥å‚åŸºç±» å…·ä½“çš„å·¥å‚å­ç±»å˜åŒ–æˆ–è€…ä¸šåŠ¡å¤„ç†å­ç±»å˜åŒ–å¯¹è¿™ä¸ªç±»æ²¡æœ‰ç¼–è¯‘æ—¶çš„å½±å“ï¼Œç›¸å¯¹ç¨³å®šï¼Œå˜åŒ–å°‘ä¸€èˆ¬é—®é¢˜ä¹Ÿå°‘ï¼Œæœ‰å˜åŒ–å°±å¸¦æ¥äº†æµ‹è¯•å·¥ä½œé‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      splitter<span style="color:#f92672">-&gt;</span>split();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//-------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//å…·ä½“å®ç°ç±»å’Œå·¥å‚å­ç±»æ”¾åˆ°åŒä¸€ä¸ªæ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BinarySplitter</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISplitter{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TxtSplitter</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISplitter{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PictureSplitter</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISplitter{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">VideoSplitter</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISplitter{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å…·ä½“å·¥å‚å­ç±» è´Ÿè´£åˆ›å»ºå…·ä½“çš„ä¸šåŠ¡å¤„ç†å­ç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BinarySplitterFactory</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> SplitterFactory{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> ISplitter<span style="color:#f92672">*</span> CreateSplitter(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">BinarySplitter</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TxtSplitterFactory</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> SplitterFactory{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> ISplitter<span style="color:#f92672">*</span> CreateSplitter(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">TxtSplitter</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PictureSplitterFactory</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> SplitterFactory{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> ISplitter<span style="color:#f92672">*</span> CreateSplitter(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">PictureSplitter</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">VideoSplitterFactory</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> SplitterFactory{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> ISplitter<span style="color:#f92672">*</span> CreateSplitter(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">VideoSplitter</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="ç»“æ„å›¾è§£-3">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-3">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Factory%e5%b7%a5%e5%8e%82%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="è¦ç‚¹æ€»ç»“-5">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-5">#</a></h2>
<ul>
<li>
<p>Factory Methodæ¨¡å¼ç”¨äºéš”ç¦»ç±»å¯¹è±¡çš„ä½¿ç”¨è€…å’Œå…·ä½“ç±»å‹ä¹‹é—´çš„ è€¦åˆå…³ç³»ã€‚é¢å¯¹ä¸€ä¸ªç»å¸¸å˜åŒ–çš„å…·ä½“ç±»å‹ï¼Œç´§è€¦åˆå…³ç³»(new)ä¼šå¯¼ è‡´è½¯ä»¶çš„è„†å¼±ã€‚</p>
</li>
<li>
<p>Factory Methodæ¨¡å¼é€šè¿‡é¢å‘å¯¹è±¡çš„æ‰‹æ³•ï¼Œå°†æ‰€è¦åˆ›å»ºçš„å…·ä½“å¯¹ è±¡å·¥ä½œå»¶è¿Ÿåˆ°å­ç±»ï¼Œä»è€Œå®ç°ä¸€ç§æ‰©å±•(è€Œéæ›´æ”¹)çš„ç­–ç•¥ï¼Œè¾ƒå¥½ åœ°è§£å†³äº†è¿™ç§ç´§è€¦åˆå…³ç³»ï¼Œåªéœ€è¦å¢åŠ ç›¸åº”çš„ä¸šåŠ¡å­ç±»å’Œå¯¹åº”çš„å·¥å‚å­ç±» ä½¿ç”¨è€…MainFromæ— éœ€æ›´æ”¹</p>
</li>
<li>
<p>Factory Methodæ¨¡å¼è§£å†³â€œå•ä¸ªå¯¹è±¡â€çš„éœ€æ±‚å˜åŒ–ã€‚ç¼ºç‚¹åœ¨äºè¦ æ±‚åˆ›å»ºæ–¹æ³•/å‚æ•°ç›¸åŒã€‚</p>
</li>
</ul>
<h1 id="æŠ½è±¡å·¥å‚abstractfactory---å¯¹è±¡åˆ›å»º">æŠ½è±¡å·¥å‚AbstractFactory&mdash;å¯¹è±¡åˆ›å»º<a hidden class="anchor" aria-hidden="true" href="#æŠ½è±¡å·¥å‚abstractfactory---å¯¹è±¡åˆ›å»º">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯-6">éœ€æ±‚èƒŒæ™¯<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯-6">#</a></h2>
<p>éœ€è¦å†™ä¸€ä¸ªDaoæ•°æ®è®¿é—®å±‚ï¼Œåˆšå¼€å§‹åªæœ‰oracleï¼Œåé¢è¦æ”¯æŒmysqlï¼Œsqlserver db2ç­‰ç­‰,æ¯ä¸ªæ•°æ®åº“ç³»åˆ—éƒ½æœ‰ç›¸å…³çš„å¤šä¸ªå¯¹è±¡(connectionã€commandã€dataReader&hellip;)ï¼Œè¿™äº›å¯¹è±¡æ—¶ç›¸å…³çš„ï¼Œæœ‰ä¾èµ–çš„ï¼Œä¸èƒ½ä¼ ä¸€ä¸ªoracleçš„connectionç»™mysqlçš„command</p>
<h2 id="ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ">ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ<a hidden class="anchor" aria-hidden="true" href="#ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EmployeeDAO</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  vector<span style="color:#f92672">&lt;</span>EmployeeDO<span style="color:#f92672">&gt;</span> GetEmployees(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//åˆšå¼€å§‹åªæœ‰ä¸€ç§æ•°æ®åº“ åé¢å¯èƒ½è¦æ–°å¢å…¶å®ƒæ•°æ®åº“ æ‰€ä»¥è¿™é‡Œå¯èƒ½ä¼šå†™æˆif elseæ¥åˆ›å»ºå¯¹è±¡ ç»™ä¸ªå…¥å‚æ¥åˆ¤æ–­ä¸åŒçš„ç±»å‹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//è¿™å°±æ˜¯ä¾èµ–äº†åº•å±‚å…·ä½“çš„å¯¹è±¡ è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™DIP åº”è¯¥ä¾èµ–æŠ½è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      SqlConnection<span style="color:#f92672">*</span> connection <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">new</span> SqlConnection();
</span></span><span style="display:flex;"><span>      connection<span style="color:#f92672">-&gt;</span>ConnectionString <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;...&#34;</span>;
</span></span><span style="display:flex;"><span>      SqlCommand<span style="color:#f92672">*</span> command <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">new</span> SqlCommand();
</span></span><span style="display:flex;"><span>      command<span style="color:#f92672">-&gt;</span>CommandText<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;...&#34;</span>;
</span></span><span style="display:flex;"><span>      command<span style="color:#f92672">-&gt;</span>SetConnection(connection);
</span></span><span style="display:flex;"><span>      SqlDataReader<span style="color:#f92672">*</span> reader <span style="color:#f92672">=</span> command<span style="color:#f92672">-&gt;</span>ExecuteReader();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">while</span> (reader<span style="color:#f92672">-&gt;</span>Read()){
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="ç”¨åŸå§‹å·¥å‚æ–¹æ³•æ¨¡å¼æ”¹é€ ">ç”¨åŸå§‹å·¥å‚æ–¹æ³•æ¨¡å¼æ”¹é€ <a hidden class="anchor" aria-hidden="true" href="#ç”¨åŸå§‹å·¥å‚æ–¹æ³•æ¨¡å¼æ”¹é€ ">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//æ•°æ®åº“è®¿é—®æœ‰å…³çš„åŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IDBConnection</span>{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IDBConnectionFactory</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> IDBConnection<span style="color:#f92672">*</span> CreateDBConnection()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IDBCommand</span>{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IDBCommandFactory</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> IDBCommand<span style="color:#f92672">*</span> CreateDBCommand()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IDataReader</span>{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IDataReaderFactory</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> IDataReader<span style="color:#f92672">*</span> CreateDataReader()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ”¯æŒSQL Server
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SqlConnection</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IDBConnection{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SqlConnectionFactory</span><span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> IDBConnectionFactory{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SqlCommand</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IDBCommand{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SqlCommandFactory</span><span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> IDBCommandFactory{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SqlDataReader</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IDataReader{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SqlDataReaderFactory</span><span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> IDataReaderFactory{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ”¯æŒOracle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OracleConnection</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IDBConnection{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OracleCommand</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IDBCommand{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OracleDataReader</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IDataReader{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å¦‚æœç³»åˆ—å¯¹è±¡(æœ‰ç›¸å…³æ€§çš„å¤šä¸ªå¯¹è±¡)æœ‰3ä¸ª ä½¿ç”¨è€…å°±æ‹¥æœ‰3ä¸ªå¯¹åº”çš„å·¥å‚åŸºç±»å¯¹è±¡æŒ‡é’ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EmployeeDAO</span>{
</span></span><span style="display:flex;"><span>  IDBConnectionFactory<span style="color:#f92672">*</span> dbConnectionFactory;
</span></span><span style="display:flex;"><span>  IDBCommandFactory<span style="color:#f92672">*</span> dbCommandFactory;
</span></span><span style="display:flex;"><span>  IDataReaderFactory<span style="color:#f92672">*</span> dataReaderFactory;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  vector<span style="color:#f92672">&lt;</span>EmployeeDO<span style="color:#f92672">&gt;</span> GetEmployees(){
</span></span><span style="display:flex;"><span>      IDBConnection<span style="color:#f92672">*</span> connection <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>          dbConnectionFactory<span style="color:#f92672">-&gt;</span>CreateDBConnection();
</span></span><span style="display:flex;"><span>      connection<span style="color:#f92672">-&gt;</span>ConnectionString(<span style="color:#e6db74">&#34;...&#34;</span>);
</span></span><span style="display:flex;"><span>      IDBCommand<span style="color:#f92672">*</span> command <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>          dbCommandFactory<span style="color:#f92672">-&gt;</span>CreateDBCommand();
</span></span><span style="display:flex;"><span>      command<span style="color:#f92672">-&gt;</span>CommandText(<span style="color:#e6db74">&#34;...&#34;</span>);
</span></span><span style="display:flex;"><span>      command<span style="color:#f92672">-&gt;</span>SetConnection(connection); <span style="color:#75715e">//å…³è”æ€§ 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//è¿™é‡Œæ²¡æ³•ä¿è¯ä¼ ç»™oracleçš„commandçš„connectionæ˜¯mysqlç±»å‹çš„å·¥å‚åˆå§‹åŒ–çš„ è¿™ä¸ªæ—¶å€™å°±ä¼šå‡ºç°é”™è¯¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      IDBDataReader<span style="color:#f92672">*</span> reader <span style="color:#f92672">=</span> command<span style="color:#f92672">-&gt;</span>ExecuteReader(); <span style="color:#75715e">//å…³è”æ€§
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">while</span> (reader<span style="color:#f92672">-&gt;</span>Read()){
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>å› ä¸ºç³»åˆ—å¯¹è±¡å½¼æ­¤é—´æœ‰ç›¸å…³æ€§ï¼Œä¼šäº§ç”Ÿä¾èµ–ï¼Œæ‰€ä»¥ç›´æ¥å¤šä¸ªå·¥å‚åŸºç±»çš„æ–¹æ³•ï¼Œæ— æ³•å»ºç«‹å…¶ç›¸å…³æ€§ï¼Œæ‹¿è¿™é‡Œçš„ä¾‹å­æ¥è¯´ï¼Œæ³•ä¿è¯ä¼ ç»™oracleçš„commandçš„connectionæ˜¯mysqlç±»å‹çš„å·¥å‚åˆå§‹åŒ–çš„ è¿™ä¸ªæ—¶å€™å°±ä¼šå‡ºç°é”™è¯¯ã€‚</p>
<h2 id="åŠ¨æœº-6">åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#åŠ¨æœº-6">#</a></h2>
<ul>
<li>åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œç»å¸¸é¢ä¸´ç€â€œä¸€ç³»åˆ—ç›¸äº’ä¾èµ–çš„å¯¹è±¡â€çš„åˆ›å»ºå·¥ ä½œ;åŒæ—¶ï¼Œç”±äºéœ€æ±‚çš„å˜åŒ–ï¼Œå¾€å¾€å­˜åœ¨æ›´å¤šç³»åˆ—å¯¹è±¡çš„åˆ›å»ºå·¥ä½œ</li>
</ul>
<h2 id="æ¨¡å¼å®šä¹‰-3">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-3">#</a></h2>
<ul>
<li>ä¾›ä¸€ä¸ªæ¥å£ï¼Œè®©è¯¥æ¥å£è´Ÿè´£åˆ›å»ºä¸€ç³»åˆ—â€œç›¸å…³æˆ–è€…ç›¸äº’ä¾ èµ–çš„å¯¹è±¡â€ï¼Œæ— éœ€æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»</li>
</ul>
<h2 id="ç»“æ„å›¾è§£-4">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-4">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_AbstractFactory%e6%8a%bd%e8%b1%a1%e5%b7%a5%e5%8e%82%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="è¦ç‚¹æ€»ç»“-6">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-6">#</a></h2>
<ul>
<li>
<p>å¦‚æœæ²¡æœ‰åº”å¯¹â€œå¤šç³»åˆ—å¯¹è±¡æ„å»ºâ€çš„éœ€æ±‚å˜åŒ–ï¼Œåˆ™æ²¡æœ‰å¿…è¦ä½¿ç”¨ Abstract Factoryæ¨¡å¼ï¼Œè¿™æ—¶å€™ä½¿ç”¨ç®€å•çš„å·¥å‚å®Œå…¨å¯ä»¥ã€‚</p>
</li>
<li>
<p>â€œç³»åˆ—å¯¹è±¡â€æŒ‡çš„æ˜¯åœ¨æŸä¸€ç‰¹å®šç³»åˆ—ä¸‹çš„å¯¹è±¡ä¹‹é—´æœ‰ç›¸äº’ä¾èµ–ã€ æˆ–ä½œç”¨çš„å…³ç³»ã€‚ä¸åŒç³»åˆ—çš„å¯¹è±¡ä¹‹é—´ä¸èƒ½ç›¸äº’ä¾èµ–ã€‚</p>
</li>
<li>
<p>Abstract Factoryæ¨¡å¼ä¸»è¦åœ¨äºåº”å¯¹â€œæ–°ç³»åˆ—â€çš„éœ€æ±‚å˜åŠ¨ã€‚å…¶ç¼º ç‚¹åœ¨äºéš¾ä»¥åº”å¯¹â€œæ–°å¯¹è±¡â€çš„éœ€æ±‚å˜åŠ¨</p>
</li>
</ul>
<h2 id="ä»£ç å®ç°-1">ä»£ç å®ç°<a hidden class="anchor" aria-hidden="true" href="#ä»£ç å®ç°-1">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//æ•°æ®åº“è®¿é—®æœ‰å…³çš„åŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IDBConnection</span>{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IDBCommand</span>{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IDataReader</span>{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ”¯æŒSQL Server
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SqlConnection</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IDBConnection{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SqlCommand</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IDBCommand{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SqlDataReader</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IDataReader{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SqlDBFactory</span><span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> IDBFactory{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> IDBConnection<span style="color:#f92672">*</span> CreateDBConnection()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> IDBCommand<span style="color:#f92672">*</span> <span style="color:#a6e22e">CreateDBCommand</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> IDataReader<span style="color:#f92672">*</span> <span style="color:#a6e22e">CreateDataReader</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IDBFactory</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> IDBConnection<span style="color:#f92672">*</span> CreateDBConnection()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> IDBCommand<span style="color:#f92672">*</span> <span style="color:#a6e22e">CreateDBCommand</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> IDataReader<span style="color:#f92672">*</span> <span style="color:#a6e22e">CreateDataReader</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ”¯æŒOracle ç±»ä¼¼æ“ä½œ å¢åŠ ç›¸å…³ç±»å³å¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OracleConnection</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IDBConnection{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OracleCommand</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IDBCommand{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OracleDataReader</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IDataReader{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EmployeeDAO</span>{
</span></span><span style="display:flex;"><span>  IDBFactory<span style="color:#f92672">*</span> dbFactory;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  vector<span style="color:#f92672">&lt;</span>EmployeeDO<span style="color:#f92672">&gt;</span> GetEmployees(){
</span></span><span style="display:flex;"><span>      IDBConnection<span style="color:#f92672">*</span> connection <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>          dbFactory<span style="color:#f92672">-&gt;</span>CreateDBConnection();
</span></span><span style="display:flex;"><span>      connection<span style="color:#f92672">-&gt;</span>ConnectionString(<span style="color:#e6db74">&#34;...&#34;</span>);
</span></span><span style="display:flex;"><span>      IDBCommand<span style="color:#f92672">*</span> command <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>          dbFactory<span style="color:#f92672">-&gt;</span>CreateDBCommand();
</span></span><span style="display:flex;"><span>      command<span style="color:#f92672">-&gt;</span>CommandText(<span style="color:#e6db74">&#34;...&#34;</span>);
</span></span><span style="display:flex;"><span>      command<span style="color:#f92672">-&gt;</span>SetConnection(connection); <span style="color:#75715e">//å…³è”æ€§è§£å†³äº†å¤šå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³» å› ä¸ºæ˜¯åŒä¸€ä¸ªå·¥å‚åˆ›å»ºçš„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      IDBDataReader<span style="color:#f92672">*</span> reader <span style="color:#f92672">=</span> command<span style="color:#f92672">-&gt;</span>ExecuteReader(); <span style="color:#75715e">//å…³è”æ€§
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">while</span> (reader<span style="color:#f92672">-&gt;</span>Read()){
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h1 id="åŸå‹æ¨¡å¼-prototype---å¯¹è±¡åˆ›å»º">åŸå‹æ¨¡å¼ prototype&mdash;å¯¹è±¡åˆ›å»º<a hidden class="anchor" aria-hidden="true" href="#åŸå‹æ¨¡å¼-prototype---å¯¹è±¡åˆ›å»º">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯åŠåŠ¨æœº">éœ€æ±‚èƒŒæ™¯åŠåŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯åŠåŠ¨æœº">#</a></h2>
<p>â€‹	å¦‚æœéœ€è¦åˆå§‹åŒ–ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åˆšå¼€å§‹åˆå§‹åŒ–çš„çŠ¶æ€ä¸æ˜¯ä½ æƒ³è¦çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™ç”¨åŸå§‹å·¥å‚æ¨¡å¼åˆå§‹åŒ–å°±æ¯”è¾ƒå°´å°¬äº†ï¼Œæˆ–è€…æ›´ç›´ç™½çš„è¯´å°±æ˜¯éœ€è¦ä¸€ä¸ªå¯¹è±¡è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œè¾¾åˆ°äº†æŸç§çŠ¶æ€åï¼Œæˆ‘æ‰è¦è¿™ä¸ªå¯¹è±¡å»åšä¸€äº›å¤„ç†ï¼Œå°±å¯ä»¥ç”¨åŸå‹æ¨¡å¼ï¼Œç”¨æ‹·è´å¯¹è±¡çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚</p>
<p>â€‹	 å¦‚æœåˆ›å»ºå¯¹è±¡åªæ˜¯éå¸¸ç®€å•åŸå§‹çš„newå³å¯ï¼Œé‚£åŸå§‹å·¥å‚æ¨¡å¼è¶³å¤Ÿäº†ï¼Œå¦‚æœåœ¨æœ€å¼€å§‹å¾ˆéš¾åˆ›å»ºå‡ºæ¥æˆ–è€…ä½ å¸Œæœ›å¯¹è±¡è¿è¡Œåˆ°ä¸€å®šçŠ¶æ€åè¦ä¿ç•™è¿™ä¸ªçŠ¶æ€å°±å¯ä»¥è€ƒè™‘åŸå‹æ¨¡å¼</p>
<h2 id="æ¨¡å¼å®šä¹‰-4">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-4">#</a></h2>
<p>ä½¿ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œç„¶åé€šè¿‡æ‹·è´è¿™äº›åŸå‹æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œè¾¾åˆ°ä¿å­˜æŸç§çŠ¶æ€çš„ç›®çš„ã€‚</p>
<p>æ˜¯ä¸“é—¨ç”¨æ¥åˆå§‹åŒ–ç›¸å¯¹å¾ˆå¤æ‚çš„å¯¹è±¡çš„æ—¶å€™ç”¨çš„ï¼Œæ˜¯å·¥å‚æ¨¡å¼çš„å˜å½¢ã€‚</p>
<p>ç°å®é¡¹ç›®ç”¨çš„ä¸å¤š</p>
<h2 id="ç»“æ„å›¾è§£-5">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-5">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_%e5%8e%9f%e5%9e%8bprototype%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="è¦ç‚¹æ€»ç»“-7">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-7">#</a></h2>
<ul>
<li>åŒæ ·ç”¨äºéš”ç¦»ç±»å¯¹è±¡çš„ä½¿ç”¨è€…å’Œå…·ä½“ç±»å‹(æ˜“å˜ç±»)ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼ŒåŒæ ·è¦æ±‚è¿™äº›â€œæ˜“å˜ç±»â€æ‹¥æœ‰â€œç¨³å®šçš„æ¥å£â€</li>
<li>ä½¿ç”¨åŸå‹å…‹éš†çš„æ–¹æ³•æ¥å®ç°åˆ›å»ºä¸€ä¸ªåŒ…å«æœ‰ä¸­é—´çŠ¶æ€çš„å¯¹è±¡</li>
<li>Cloneæ–¹æ³•è¦æ˜¯æ·±æ‹·è´ c++å¯ä»¥ç”¨æ‹·è´æ„é€ å‡½æ•°å®ç°</li>
</ul>
<h2 id="ä»£ç å®ç°-å¯¹æ¯”å·¥å‚æ¨¡å¼çœ‹">ä»£ç å®ç° å¯¹æ¯”å·¥å‚æ¨¡å¼çœ‹<a hidden class="anchor" aria-hidden="true" href="#ä»£ç å®ç°-å¯¹æ¯”å·¥å‚æ¨¡å¼çœ‹">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//åŸå‹åŸºç±»åŒ…å«å…‹éš†å…·ä½“å­ç±»çš„è™šå‡½æ•° ä¹ŸåŒ…æ‹¬å…¶å®ƒä¸€äº›ä¸šåŠ¡å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ISplitter</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> split()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#75715e">//å®é™…ä¸šåŠ¡è™šå‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">virtual</span> ISplitter<span style="color:#f92672">*</span> <span style="color:#a6e22e">clone</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; <span style="color:#75715e">//é€šè¿‡å…‹éš†è‡ªå·±æ¥åˆ›å»ºå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>ISplitter(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å…·ä½“çš„ä¸šåŠ¡å­ç±» ç»§æ‰¿åŸå‹åŸºç±» è¦å®ç°cloneè‡ªå·±çš„è™šå‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BinarySplitter</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISplitter{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> ISplitter<span style="color:#f92672">*</span> clone(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">BinarySplitter</span>(<span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TxtSplitter</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISplitter{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> ISplitter<span style="color:#f92672">*</span> clone(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">TxtSplitter</span>(<span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PictureSplitter</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISplitter{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> ISplitter<span style="color:#f92672">*</span> clone(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">PictureSplitter</span>(<span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">VideoSplitter</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISplitter{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> ISplitter<span style="color:#f92672">*</span> clone(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">VideoSplitter</span>(<span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ä½¿ç”¨è€…-----------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainForm</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Form{
</span></span><span style="display:flex;"><span>  ISplitter<span style="color:#f92672">*</span>  prototype;<span style="color:#75715e">//åŸå‹åŸºç±»æŒ‡é’ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  MainForm(ISplitter<span style="color:#f92672">*</span>  prototype){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>prototype<span style="color:#f92672">=</span>prototype;<span style="color:#75715e">//ä¼ å…¥å«æœ‰ä¸­é—´çŠ¶æ€çš„å­ç±»å¯¹è±¡(æˆ–è€…æœ¬èº«å¾ˆéš¾åˆå§‹åŒ–å®Œå…¨)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Button1_Click</span>(){
</span></span><span style="display:flex;"><span>  	ISplitter <span style="color:#f92672">*</span> splitter<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>          prototype<span style="color:#f92672">-&gt;</span>clone(); <span style="color:#75715e">//å…‹éš†åŸå‹ æ·±æ‹·è´ä¸€ä¸ªå·²ç»è¿è¡Œäº†ä¸€æ®µæ—¶é—´çš„å¯¹è±¡ ä¿å­˜å…¶ä¸­é—´çŠ¶æ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      splitter<span style="color:#f92672">-&gt;</span>split();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h1 id="æ„å»ºå™¨æ¨¡å¼builder---å¯¹è±¡åˆ›å»º">æ„å»ºå™¨æ¨¡å¼Builder&mdash;å¯¹è±¡åˆ›å»º<a hidden class="anchor" aria-hidden="true" href="#æ„å»ºå™¨æ¨¡å¼builder---å¯¹è±¡åˆ›å»º">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯-7">éœ€æ±‚èƒŒæ™¯<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯-7">#</a></h2>
<p>//æ”¯æŒå»ºä¸åŒæˆ¿å­ éƒ½éœ€è¦å‡ ä¸ªå…±åŒçš„æ­¥éª¤ï¼Œä½†æ˜¯ä¸åŒæˆ¿å­æ¯ä¸ªæ­¥éª¤å®ç°ä¸ä¸€æ ·</p>
<p>//æˆ‘ä»¬å¯ä»¥å°†è¿™äº›ç¨³å®šçš„æ­¥éª¤æŠ½è±¡å‡ºæ¥ï¼Œä¸‹é¢çš„initå‡½æ•°å°±æ˜¯è¿™æ ·</p>
<h2 id="ä¼ ç»Ÿå®ç°-5">ä¼ ç»Ÿå®ç°<a hidden class="anchor" aria-hidden="true" href="#ä¼ ç»Ÿå®ç°-5">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//æ”¯æŒå»ºä¸åŒæˆ¿å­ éƒ½éœ€è¦å‡ ä¸ªå…±åŒçš„æ­¥éª¤ï¼Œä½†æ˜¯ä¸åŒæˆ¿å­æ¯ä¸ªæ­¥éª¤å®ç°ä¸ä¸€æ · 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//æˆ‘ä»¬å¯ä»¥å°†è¿™äº›ç¨³å®šçš„æ­¥éª¤æŠ½è±¡å‡ºæ¥ï¼Œä¸‹é¢çš„initå‡½æ•°å°±æ˜¯è¿™æ ·
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">House</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> init(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>BuildPart1();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">4</span>; i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>BuildPart2();
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">bool</span> flag<span style="color:#f92672">=</span><span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>BuildPart3();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span>(flag){
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>BuildPart4();
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>BuildPart5();
</span></span><span style="display:flex;"><span>  }   
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>House(){}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>    
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> BuildPart1()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BuildPart2</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">BuildPart3</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BuildPart4</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BuildPart5</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//....
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å»ºé€ çŸ³å¤´æˆ¿å­ override5ä¸ªå»ºé€ æˆ¿å­çš„æ­¥éª¤
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StoneHouse</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> House{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> BuildPart1(){}
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BuildPart2</span>(){}
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">BuildPart3</span>(){}
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BuildPart4</span>(){}
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BuildPart5</span>(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>  House <span style="color:#f92672">*</span>p<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> StoneHouse();
</span></span><span style="display:flex;"><span>  p<span style="color:#f92672">-&gt;</span>init();
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//pçš„å…¶å®ƒæ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p>ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆï¼Œå°†æ„å»ºæˆ¿å­çš„æ–¹æ³•éƒ½å†™åˆ°æˆ¿å­ç±»æœ¬èº«ä¸­ï¼Œå¦‚æœæ„å»ºæˆ¿å­çš„æ–¹æ³•ç»å¸¸æ”¹å˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥å°†æ„å»ºéƒ¨åˆ†æ‹†åˆ†å‡ºå»ï¼Œå¦åˆ™ä¿®æ”¹åŸå…ˆçš„ä»£ç å¾ˆæœ‰å¯èƒ½å¯¼è‡´æˆ¿å­æœ¬èº«é™¤äº†æ„å»ºçš„å…¶å®ƒé€»è¾‘å‡ºç°bugã€‚</p>
<p>æœ‰æ—¶å€™æ„å»ºä¸€ä¸ªå¯¹è±¡éœ€è¦çš„ä¼ å…¥å¤§é‡çš„å‚æ•°ï¼Œç„¶ååˆè¦æ‰§è¡Œå¾ˆå¤æ‚çš„å¤šä¸ªæ–¹æ³•è°ƒç”¨ï¼Œè€Œä¸”è¿˜ç»å¸¸å˜åŒ–ï¼Œè¿™ä¸ªæ—¶å€™åº”è¯¥æ”¹è€ƒè™‘å°†æ„å»ºå¯¹è±¡çš„å·¥ä½œå•ç‹¬æ‹†åˆ†å‡ºå»ã€‚</p>
<h2 id="åŠ¨æœº-7">åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#åŠ¨æœº-7">#</a></h2>
<p>è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œæœ‰æ—¶å€™é¢ä¸´ç€â€œä¸€ä¸ªå¤æ‚å¯¹è±¡â€çš„åˆ›å»ºå·¥ä½œï¼Œå…¶ é€šå¸¸ç”±å„ä¸ªéƒ¨åˆ†çš„å­å¯¹è±¡ç”¨ä¸€å®šçš„ç®—æ³•æ„æˆ;ç”±äºéœ€æ±‚çš„å˜åŒ–ï¼Œè¿™ ä¸ªå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨åˆ†ç»å¸¸é¢ä¸´ç€å‰§çƒˆçš„å˜åŒ–ï¼Œä½†æ˜¯å°†å®ƒä»¬ç»„åˆåœ¨ ä¸€èµ·çš„ç®—æ³•å´ç›¸å¯¹ç¨³å®š</p>
<p>æ¯”å¦‚ç›–æˆ¿å­çš„å¤§è‡´æµç¨‹å›ºå®šï¼Œä½†æ˜¯ç›–ä¸åŒçš„æˆ¿å­æ¯ä¸ªå­æµç¨‹çš„å®ç°å„ä¸ç›¸åŒï¼Œè¿˜å¯èƒ½ç»å¸¸å˜åŒ–ã€‚</p>
<h2 id="æ¨¡å¼å®šä¹‰-5">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-5">#</a></h2>
<p>å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å…¶è¡¨ç¤ºç›¸åˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ ç¨‹(ç¨³å®š)å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤º(å˜åŒ–)</p>
<h2 id="ç»“æ„å›¾è§£-6">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-6">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Builder%e6%9e%84%e5%bb%ba%e5%99%a8%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="ä»£ç å®ç°-2">ä»£ç å®ç°<a hidden class="anchor" aria-hidden="true" href="#ä»£ç å®ç°-2">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  //äº§å“åŸºç±» å®šä¹‰æˆ¿å­é™¤äº†æ„å»ºæœ¬èº«çš„å…¶å®ƒæ¥å£
</span></span><span style="display:flex;"><span>class House{
</span></span><span style="display:flex;"><span>    //....
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>//äº§å“æ„å»ºå™¨åŸºç±» è´Ÿè´£å®šä¹‰ç›¸å…³å…±æœ‰å­æ¥å£ ä¸å®ç°
</span></span><span style="display:flex;"><span>class HouseBuilder {
</span></span><span style="display:flex;"><span>public:
</span></span><span style="display:flex;"><span>    House* GetResult(){
</span></span><span style="display:flex;"><span>        return pHouse;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    virtual ~HouseBuilder(){}
</span></span><span style="display:flex;"><span>protected:
</span></span><span style="display:flex;"><span>    House* pHouse;
</span></span><span style="display:flex;"><span>	virtual void BuildPart1()=0;
</span></span><span style="display:flex;"><span>    virtual void BuildPart2()=0;
</span></span><span style="display:flex;"><span>    virtual void BuildPart3()=0;
</span></span><span style="display:flex;"><span>    virtual void BuildPart4()=0;
</span></span><span style="display:flex;"><span>    virtual void BuildPart5()=0;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>//çŸ³å¤´æˆ¿å­ ç»§æ‰¿æˆ¿å­ï¼Œå®ç°é™¤äº†æ„å»ºå·¥ä½œå¤–çš„çš„å…¶å®ƒæ–¹æ³•
</span></span><span style="display:flex;"><span>class StoneHouse: public House{
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>//çŸ³å¤´æˆ¿å­æ„å»ºå™¨ å®ç°æ„å»ºæˆ¿å­å¯¹è±¡éœ€è¦çš„å‡ ä¸ªå…±æœ‰çš„æŠ½è±¡æ¥å£ï¼Œå±Šæ—¶ä¼šç»„åˆè¿™äº›æ¥å£ç”ŸæˆçŸ³å¤´æˆ¿å­
</span></span><span style="display:flex;"><span>class StoneHouseBuilder: public HouseBuilder{
</span></span><span style="display:flex;"><span>protected:
</span></span><span style="display:flex;"><span>    virtual void BuildPart1(){
</span></span><span style="display:flex;"><span>        //pHouse-&gt;Part1 = ...;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    virtual void BuildPart2(){  
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    virtual void BuildPart3(){
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    virtual void BuildPart4(){
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    virtual void BuildPart5(){
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>//ç›‘å·¥ å«æœ‰äº§å“builderåŸºç±»æŒ‡é’ˆ ä¼ å…¥ä¸åŒäº§å“çš„builderå­ç±»ï¼Œå°±ä¼šæ„å»ºå‡ºæ¥ä¸åŒçš„äº§å“
</span></span><span style="display:flex;"><span>//å½“ç„¶è¿™é‡Œä¹Ÿè¦å®šä¹‰å®ç°å…±ç”¨çš„æ„å»ºç®—æ³•(ä¸åŒæˆ¿å­çš„å»ºé€ æµç¨‹æ˜¯ä¸€ç›´çš„ éƒ½è¦å…ˆæ‰“åœ°åŸº ç„¶å....)
</span></span><span style="display:flex;"><span>//å¦‚æœé¡¹ç›®å‘å±•åæœŸéœ€è¦å»ºé€ ä¸€ä¸ªæ›´æ–°å¥‡çš„æˆ¿å­ ä¸éœ€è¦å…ˆæ‰“åœ°åŸºï¼Œè€Œæ˜¯å…ˆç­‘åœ°æ¢ é‚£å°±æä¸€ä¸ªæ–°çš„ç›‘å·¥å®ç°ä¸åŒçš„æ„å»ºç®—æ³•
</span></span><span style="display:flex;"><span>class HouseDirector{
</span></span><span style="display:flex;"><span>public:
</span></span><span style="display:flex;"><span>    HouseBuilder* pHouseBuilder;//åŸºç±»builderæŒ‡é’ˆ
</span></span><span style="display:flex;"><span>    HouseDirector(HouseBuilder* pHouseBuilder){
</span></span><span style="display:flex;"><span>        this-&gt;pHouseBuilder=pHouseBuilder;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    //ç»Ÿä¸€çš„æ„å»ºæ–¹æ³•
</span></span><span style="display:flex;"><span>    House* Construct(){
</span></span><span style="display:flex;"><span>        pHouseBuilder-&gt;BuildPart1();
</span></span><span style="display:flex;"><span>        for (int i = 0; i &lt; 4; i++){
</span></span><span style="display:flex;"><span>            pHouseBuilder-&gt;BuildPart2();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        bool flag=pHouseBuilder-&gt;BuildPart3();
</span></span><span style="display:flex;"><span>        if(flag){
</span></span><span style="display:flex;"><span>            pHouseBuilder-&gt;BuildPart4();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        pHouseBuilder-&gt;BuildPart5();
</span></span><span style="display:flex;"><span>        return pHouseBuilder-&gt;GetResult();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="è¦ç‚¹æ€»ç»“-8">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-8">#</a></h2>
<ul>
<li>builder æ¨¡å¼ä¸»è¦ç”¨äºâ€œåˆ†æ­¥éª¤æ„å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡â€ã€‚åœ¨è¿™å…¶ä¸­ â€œåˆ†æ­¥éª¤â€æ˜¯ä¸€ä¸ªç¨³å®šçš„ç®—æ³•ï¼Œè€Œå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨åˆ†åˆ™ç»å¸¸å˜åŒ–</li>
<li>å˜åŒ–ç‚¹åœ¨å“ªé‡Œï¼Œå°è£…å“ªé‡Œâ€”â€” Builderæ¨¡å¼ä¸»è¦åœ¨äºåº”å¯¹â€œå¤æ‚å¯¹ è±¡å„ä¸ªéƒ¨åˆ†â€çš„é¢‘ç¹éœ€æ±‚å˜åŠ¨ã€‚å…¶ç¼ºç‚¹åœ¨äºéš¾ä»¥åº”å¯¹â€œåˆ†æ­¥éª¤æ„å»º ç®—æ³•â€çš„éœ€æ±‚å˜åŠ¨</li>
<li>builderæ¨¡å¼è·Ÿæ¨¡ç‰ˆæ–¹æ³•æœ‰ç‚¹ç±»ä¼¼ï¼Œä½†builderæ¨¡å¼å¾€å¾€åªæ˜¯ä¸ºäº†è§£å†³æ„å»ºå¯¹è±¡å›°éš¾è€Œäº§ç”Ÿçš„ï¼Œè€Œä¸”builderæ¨¡å¼æœ‰ä¸€ä¸ªç›‘å·¥ï¼Œæ¨¡ç‰ˆæ–¹æ³•çš„ç›‘å·¥å…¶å®æ˜¯çˆ¶ç±»ã€‚</li>
</ul>
<h1 id="å•ä¾‹æ¨¡å¼singleton---æ€§èƒ½é—®é¢˜">å•ä¾‹æ¨¡å¼singleton&mdash;æ€§èƒ½é—®é¢˜<a hidden class="anchor" aria-hidden="true" href="#å•ä¾‹æ¨¡å¼singleton---æ€§èƒ½é—®é¢˜">#</a></h1>
<h2 id="åŠ¨æœº-8">åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#åŠ¨æœº-8">#</a></h2>
<p>å®é™…å¼€å‘é¡¹ç›®ä¸­ä¸­å°±æ˜¯éœ€è¦ä¸€äº›è¿™æ ·çš„ç±»ï¼Œä¿è¯å®ƒä»¬åœ¨ç³»ç»Ÿä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ ï¼Œæ‰èƒ½ä¿è¯é€»è¾‘æ­£ç¡®æ€§ï¼Œæˆ–è€…å¤§éƒ¨åˆ†æ—¶å€™ä¹Ÿæ˜¯ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå› ä¸ºé¢‘ç¹çš„äº§ç”Ÿå¤šä¸ªå®ä¾‹ï¼Œä¼šå¸¦æ¥æ€§èƒ½ä¸‹é™ï¼Œå†…å­˜æ¶ˆè€—ç­‰ç­‰</p>
<h2 id="ä»£ç å®ç°-3">ä»£ç å®ç°<a hidden class="anchor" aria-hidden="true" href="#ä»£ç å®ç°-3">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Singleton</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Singleton() {cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Singleton construct</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;}
</span></span><span style="display:flex;"><span>  Singleton(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>; <span style="color:#75715e">// ç¦ç”¨æ‹·è´æ„é€ å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  Singleton<span style="color:#f92672">&amp;</span> <span style="color:#66d9ef">operator</span><span style="color:#f92672">=</span>(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>; <span style="color:#75715e">// ç¦ç”¨æ‹·è´èµ‹å€¼æ“ä½œç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">static</span> Singleton m_singleton;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">static</span> Singleton<span style="color:#f92672">*</span> getInstance(){
</span></span><span style="display:flex;"><span>  	<span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span>m_singleton;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//è¿™ç§æ¨¡å¼ç»å¯¹æ˜¯okçš„ï¼Œåªæ˜¯æœ‰äº›äººä¼šè¯´æœ‰ä¸€å®šçš„å†…å­˜æµªè´¹ï¼Œå› ä¸ºå³ä½¿åé¢ä¸ä½¿ç”¨ä¹Ÿä¼šç”Ÿæˆç›¸åº”å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//ç±»çš„é™æ€å˜é‡åœ¨ç±»å¤–éƒ¨åˆå§‹åŒ– è€Œä¸”æ˜¯å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒº è¿›å…¥mainå‡½æ•°ä¹‹å‰å°±å·²ç»æ‰§è¡Œäº†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Singleton Singleton<span style="color:#f92672">::</span>m_singleton;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>  Singleton <span style="color:#f92672">*</span>a<span style="color:#f92672">=</span>Singleton<span style="color:#f92672">::</span>getInstance();
</span></span><span style="display:flex;"><span>  Singleton <span style="color:#f92672">*</span>b<span style="color:#f92672">=</span>Singleton<span style="color:#f92672">::</span>getInstance();
</span></span><span style="display:flex;"><span>  Singleton <span style="color:#f92672">*</span>c<span style="color:#f92672">=</span>Singleton<span style="color:#f92672">::</span>getInstance();
</span></span><span style="display:flex;"><span>  Singleton <span style="color:#f92672">*</span>d<span style="color:#f92672">=</span>Singleton<span style="color:#f92672">::</span>getInstance();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Singleton</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">static</span> Singleton<span style="color:#f92672">*</span> getInstance(){
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">//å¦‚æœçº¿ç¨‹1 æ‰§è¡Œåˆ°ä¸‹é¢ä¸€è¡Œ(è¿˜æ²¡æœ‰newå‡ºæ¥) cpuè®©ç»™çº¿ç¨‹2ï¼Œçº¿ç¨‹2ä¹Ÿåˆ°è¿™è¡Œ æœ€å2ä¸ªçº¿ç¨‹éƒ½ä¼šnewå‡ºæ¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	<span style="color:#66d9ef">if</span> ( m_singleton<span style="color:#f92672">==</span><span style="color:#66d9ef">nullptr</span>){ <span style="color:#75715e">//çº¿ç¨‹ä¸å®‰å…¨ å¯èƒ½ä¼šå‡ºç°newå‡ºå¤šä¸ªçš„æƒ…å†µ  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Singleton</span>();
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> m_singleton;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Singleton() {cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Singleton construct</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;}
</span></span><span style="display:flex;"><span>  Singleton(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>; <span style="color:#75715e">// ç¦ç”¨æ‹·è´æ„é€ å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  Singleton<span style="color:#f92672">&amp;</span> <span style="color:#66d9ef">operator</span><span style="color:#f92672">=</span>(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>; <span style="color:#75715e">// ç¦ç”¨æ‹·è´èµ‹å€¼æ“ä½œç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">static</span> Singleton <span style="color:#f92672">*</span>m_singleton;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç±»çš„é™æ€å˜é‡åœ¨ç±»å¤–éƒ¨åˆå§‹åŒ– è€Œä¸”æ˜¯å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒº è¿›å…¥mainå‡½æ•°ä¹‹å‰å°±å·²ç»æ‰§è¡Œäº†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Singleton<span style="color:#f92672">*</span> Singleton<span style="color:#f92672">::</span>m_singleton<span style="color:#f92672">=</span><span style="color:#66d9ef">nullptr</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Singleton</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">static</span> Singleton<span style="color:#f92672">*</span> getInstance(){
</span></span><span style="display:flex;"><span>      m_lock.lock();  <span style="color:#75715e">//è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„è¿™ä¸ªåœ°æ–¹æ˜¯è¦åŠ é”çš„ ä½†æ˜¯å¦‚æœå·²ç»newå‡ºæ¥äº†  å¤šä¸ªçº¿ç¨‹æ¯æ¬¡è°ƒç”¨éƒ½è¦åŠ é”å°±ä¼šå½±å“æ€§èƒ½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	   <span style="color:#66d9ef">if</span> ( m_singleton<span style="color:#f92672">==</span><span style="color:#66d9ef">nullptr</span>){
</span></span><span style="display:flex;"><span>          m_singleton<span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Singleton();
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      m_lock.unlock();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> m_singleton;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Singleton() {cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Singleton construct</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;}
</span></span><span style="display:flex;"><span>  Singleton(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>; <span style="color:#75715e">// ç¦ç”¨æ‹·è´æ„é€ å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  Singleton<span style="color:#f92672">&amp;</span> <span style="color:#66d9ef">operator</span><span style="color:#f92672">=</span>(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>; <span style="color:#75715e">// ç¦ç”¨æ‹·è´èµ‹å€¼æ“ä½œç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">static</span> Singleton <span style="color:#f92672">*</span>m_singleton;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">static</span> mutex m_lock;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç±»çš„é™æ€å˜é‡åœ¨ç±»å¤–éƒ¨åˆå§‹åŒ– è€Œä¸”æ˜¯å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒº è¿›å…¥mainå‡½æ•°ä¹‹å‰å°±å·²ç»æ‰§è¡Œäº†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Singleton<span style="color:#f92672">*</span> Singleton<span style="color:#f92672">::</span>m_singleton<span style="color:#f92672">=</span><span style="color:#66d9ef">nullptr</span>;
</span></span><span style="display:flex;"><span>mutex Singleton<span style="color:#f92672">::</span>m_lock;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Singleton</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">static</span> Singleton<span style="color:#f92672">*</span> getInstance(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> ( m_singleton<span style="color:#f92672">==</span><span style="color:#66d9ef">nullptr</span>){<span style="color:#75715e">//å¦‚æœå·²ç»åˆå§‹åŒ– åˆ™ç›´æ¥è¿”å›å³å¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      m_lock.lock();  <span style="color:#75715e">//è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„è¿™ä¸ªåœ°æ–¹æ˜¯è¦åŠ é”çš„ 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//å†æ¬¡æ£€æŸ¥æ˜¯å¦newè¿‡äº† ä¸‹é¢åˆ¤ç©ºé€»è¾‘ä¸èƒ½å»æ‰ å»æ‰äº†è¿˜æ˜¯ä¼šnewå‡ºå¤šä¸ªå®ä¾‹ å› ä¸ºå¦‚æœ2ä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥ä¸Šé¢çš„ç›¼ç©ºå å°±ä¼šå‡ºç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	    <span style="color:#66d9ef">if</span> ( m_singleton<span style="color:#f92672">==</span><span style="color:#66d9ef">nullptr</span>){
</span></span><span style="display:flex;"><span>        m_singleton<span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Singleton();
</span></span><span style="display:flex;"><span>				<span style="color:#75715e">// å¯¹è±¡çš„newä¸æ˜¯åŸå­æ“ä½œ 1ã€åˆ†é…å†…å­˜ï¼Œ2 è°ƒç”¨æ„é€ ï¼Œ3 èµ‹å€¼æ“ä½œï¼Œåˆ°ç¬¬3æ­¥çš„æ—¶å€™æ‰æ˜¯m_singletonéç©º
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> 				<span style="color:#75715e">//1ã€åˆ†é…å†…å­˜ï¼Œ2 èµ‹å€¼æ“ä½œ 3 è°ƒç”¨æ„é€ ï¼Œåˆ°ç¬¬2æ­¥çš„æ—¶å€™æ‰æ˜¯m_singletonéç©º
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">//å¦‚æœé¡ºåºæ˜¯å…ˆ2åœ¨3 2åšå®Œå å¦å¤–ä¸€ä¸ªçº¿ç¨‹å°±åˆ¤æ–­éç©º ç›´æ¥ä½¿ç”¨ä½†è¿˜æ²¡æœ‰è°ƒç”¨æ„é€ å‡½æ•°è¿™ä¸ªæ—¶å€™å°±ä¼šè®©å¦å¤–çº¿ç¨‹å‡ºé”™
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      }
</span></span><span style="display:flex;"><span>     m_lock.unlock();
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> m_singleton;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Singleton() {cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Singleton construct</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;}
</span></span><span style="display:flex;"><span>  Singleton(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>; <span style="color:#75715e">// ç¦ç”¨æ‹·è´æ„é€ å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  Singleton<span style="color:#f92672">&amp;</span> <span style="color:#66d9ef">operator</span><span style="color:#f92672">=</span>(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>; <span style="color:#75715e">// ç¦ç”¨æ‹·è´èµ‹å€¼æ“ä½œç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">static</span> Singleton <span style="color:#f92672">*</span>m_singleton;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">static</span> mutex m_lock;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç±»çš„é™æ€å˜é‡åœ¨ç±»å¤–éƒ¨åˆå§‹åŒ– è€Œä¸”æ˜¯å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒº è¿›å…¥mainå‡½æ•°ä¹‹å‰å°±å·²ç»æ‰§è¡Œäº†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Singleton<span style="color:#f92672">*</span> Singleton<span style="color:#f92672">::</span>m_singleton<span style="color:#f92672">=</span><span style="color:#66d9ef">nullptr</span>;
</span></span><span style="display:flex;"><span>mutex Singleton<span style="color:#f92672">::</span>m_lock;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//å¤šçº¿ç¨‹å®‰å…¨ç‰ˆæœ¬ åŒæ£€æŸ¥ä¸ºç©ºå¹¶åŠ é” åˆ©ç”¨atomicåº“æ¶ˆé™¤å†…å­˜è¯»å†™reorderé—®é¢˜ ç›¸å¯¹å®ç°å¤æ‚ å¯ä»¥ä½¿ç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Singleton</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">static</span> Singleton<span style="color:#f92672">*</span> getInstance(){
</span></span><span style="display:flex;"><span>      Singleton<span style="color:#f92672">*</span> tmp <span style="color:#f92672">=</span> m_singleton.load(std<span style="color:#f92672">::</span>memory_order_relaxed);
</span></span><span style="display:flex;"><span>      std<span style="color:#f92672">::</span>atomic_thread_fence(std<span style="color:#f92672">::</span>memory_order_acquire);<span style="color:#75715e">//è·å–å†…å­˜fence 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">if</span> ( tmp<span style="color:#f92672">==</span><span style="color:#66d9ef">nullptr</span>){<span style="color:#75715e">//å¦‚æœå·²ç»åˆå§‹åŒ– åˆ™ç›´æ¥è¿”å›å³å¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          std<span style="color:#f92672">::</span>lock_guard<span style="color:#f92672">&lt;</span>std<span style="color:#f92672">::</span>mutex<span style="color:#f92672">&gt;</span> lock(m_lock);;  <span style="color:#75715e">//è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„è¿™ä¸ªåœ°æ–¹æ˜¯è¦åŠ é”çš„ 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	    <span style="color:#66d9ef">if</span> ( tmp<span style="color:#f92672">==</span><span style="color:#66d9ef">nullptr</span>){<span style="color:#75715e">//å†æ¬¡æ£€æŸ¥æ˜¯å¦newè¿‡äº† è¿™è¡Œä¸èƒ½å»æ‰ å»æ‰äº†è¿˜æ˜¯ä¼šnewå‡ºå¤šä¸ªå®ä¾‹ å› ä¸ºå¦‚æœ2ä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥67è¡Œä»£ç  å°±ä¼šå‡ºç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>              tmp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Singleton();  <span style="color:#75715e">// 1ã€åˆ†é…å†…å­˜ï¼Œ2 è°ƒç”¨æ„é€ ï¼Œ3 èµ‹å€¼æ“ä½œ è¿™é‡Œä¸ä¼šå†å‡ºç°å†…å­˜è¯»å†™reorderé—®é¢˜
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>              std<span style="color:#f92672">::</span>atomic_thread_fence(std<span style="color:#f92672">::</span>memory_order_release);<span style="color:#75715e">//é‡Šæ”¾å†…å­˜fence
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>              m_singleton.store(tmp, std<span style="color:#f92672">::</span>memory_order_relaxed);
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> tmp;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Singleton() {cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Singleton construct</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;}
</span></span><span style="display:flex;"><span>  Singleton(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>; <span style="color:#75715e">// ç¦ç”¨æ‹·è´æ„é€ å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  Singleton<span style="color:#f92672">&amp;</span> <span style="color:#66d9ef">operator</span><span style="color:#f92672">=</span>(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>; <span style="color:#75715e">// ç¦ç”¨æ‹·è´èµ‹å€¼æ“ä½œç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">static</span> std<span style="color:#f92672">::</span>atomic<span style="color:#f92672">&lt;</span>Singleton<span style="color:#f92672">*&gt;</span> m_singleton;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">static</span> mutex m_lock;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç±»çš„é™æ€å˜é‡åœ¨ç±»å¤–éƒ¨åˆå§‹åŒ– è€Œä¸”æ˜¯å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒº è¿›å…¥mainå‡½æ•°ä¹‹å‰å°±å·²ç»æ‰§è¡Œäº†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>std<span style="color:#f92672">::</span>atomic<span style="color:#f92672">&lt;</span>Singleton<span style="color:#f92672">*&gt;</span> Singleton<span style="color:#f92672">::</span>m_singleton;
</span></span><span style="display:flex;"><span>mutex Singleton<span style="color:#f92672">::</span>m_lock;
</span></span></code></pre></div><ul>
<li>
<p>é€šè¿‡è¿”å›å±€éƒ¨é™æ€å˜é‡æ–¹å¼å®ç° çº¿ç¨‹å®‰å…¨ å†™æ³•ç®€å• æ¨èä½¿ç”¨</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Singleton</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">static</span> Singleton<span style="color:#f92672">*</span> getInstance(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">static</span> Singleton instance;
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">//è¿™ç§ç›¸å¯¹äºä½¿ç”¨atomicçš„å†™æ³•æ›´ç®€æ´  è€Œä¸”åˆæ˜¯æ‡’æ±‰æ¨¡å¼ ä½¿ç”¨çš„æ—¶å€™æ‰ç”Ÿæˆ æ¨èä½¿ç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//å±€éƒ¨é™æ€å˜é‡åˆå§‹åŒ–æ˜¯ä¼šåŠ é”çš„ ä¹Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„,è€Œä¸”æ˜¯c++å’Œç¼–è¯‘å™¨ä¿è¯çš„ æ¨èä½¿ç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span>instance;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Singleton() {cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Singleton construct</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;}
</span></span><span style="display:flex;"><span>  Singleton(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>; <span style="color:#75715e">// ç¦ç”¨æ‹·è´æ„é€ å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  Singleton<span style="color:#f92672">&amp;</span> <span style="color:#66d9ef">operator</span><span style="color:#f92672">=</span>(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>; <span style="color:#75715e">// ç¦ç”¨æ‹·è´èµ‹å€¼æ“ä½œç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">static</span> Singleton<span style="color:#f92672">*</span> m_singleton;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç±»çš„é™æ€å˜é‡åœ¨ç±»å¤–éƒ¨åˆå§‹åŒ– è€Œä¸”æ˜¯å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒº è¿›å…¥mainå‡½æ•°ä¹‹å‰å°±å·²ç»æ‰§è¡Œäº†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Singleton<span style="color:#f92672">*</span> Singleton<span style="color:#f92672">::</span>m_singleton<span style="color:#f92672">=</span><span style="color:#66d9ef">nullptr</span>;
</span></span></code></pre></div></li>
</ul>
<h1 id="äº«å…ƒæ¨¡å¼flyweight---æ€§èƒ½é—®é¢˜">äº«å…ƒæ¨¡å¼FlyWeight&mdash;æ€§èƒ½é—®é¢˜<a hidden class="anchor" aria-hidden="true" href="#äº«å…ƒæ¨¡å¼flyweight---æ€§èƒ½é—®é¢˜">#</a></h1>
<h2 id="åŠ¨æœº-9">åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#åŠ¨æœº-9">#</a></h2>
<p>å¦‚æœä¸€åˆ‡çš†å¯¹è±¡ï¼Œæœ‰äº›å¯¹è±¡åœ¨ç³»ç»Ÿä¸­å¤§é‡å­˜åœ¨(ä¸‡ã€åä¸‡ã€ç™¾ä¸‡ã€åƒä¸‡ç­‰)ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå¸¦æ¥å¤§é‡çš„è¿è¡Œæ—¶å¼€é”€ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹å¯èƒ½æ˜¯å†…å­˜æµªè´¹ã€‚æ¯”å¦‚è®¾è®¡å›´æ£‹æ¸¸æˆï¼Œæ¯ä¸€ä¸ªé»‘æ——ã€ç™½æ£‹éƒ½ææˆå¯¹è±¡ï¼Œæˆåƒä¸Šä¸‡çš„äººåœ¨ç©ï¼Œé‚£å°±æ˜¯åä¸‡ç”šè‡³ç™¾ä¸‡ä¸ªå¯¹è±¡ï¼Œæ¯”å¦‚è®¾è®¡å­—ä½“å¤„ç†è½¯ä»¶ï¼Œæ¯ä¸ªæœ‰å¤§é‡çš„å­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦åˆæœ‰å¤§é‡çš„å­—ä½“ï¼Œæ¯ä¸ªå­—ç¬¦æ¯ä¸ªå­—ä½“éƒ½ç”Ÿæˆ1ä¸ªå¯¹è±¡ï¼Œæœ€ç»ˆå ç”¨å†…å­˜å°†æ˜¯éå¸¸å¤¸å¼ çš„ï¼Œè€Œå¤§éƒ¨åˆ†æ—¶å€™æ˜¯ä¸éœ€è¦ï¼Œå› ä¸ºè¿™äº›å¯¹è±¡éƒ½æ˜¯åªè¯»çš„ï¼Œå®Œå…¨å¯ä»¥ç”¨æ± çš„æ¦‚å¿µæ¥å…±äº«ï¼Œå¦‚æœå·²ç»åˆ›å»ºè¿‡äº†ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ ä¸å†åˆ›å»ºï¼Œå¦åˆ™å°±åˆ›å»ºå¹¶ä¸”åŠ åˆ°å…±äº«æ± ä¸­ã€‚</p>
<h2 id="æ¨¡å¼å®šä¹‰-6">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-6">#</a></h2>
<p>é€šè¿‡å…±äº«æŠ€æœ¯æœ‰æ•ˆæ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚</p>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_FlyWeight%e4%ba%ab%e5%85%83%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="ä»£ç ">ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ä»£ç ">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Font</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//unique object key
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  string key;
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//object state
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//....
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Font(<span style="color:#66d9ef">const</span> string<span style="color:#f92672">&amp;</span> key){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å¯¹è±¡ç”Ÿæˆå·¥å‚ ç”¨mapå®ç°å…±äº«æ± 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FontFactory</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  map<span style="color:#f92672">&lt;</span>string,Font<span style="color:#f92672">*</span> <span style="color:#f92672">&gt;</span> fontPool;  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Font<span style="color:#f92672">*</span> GetFont(<span style="color:#66d9ef">const</span> string<span style="color:#f92672">&amp;</span> key){
</span></span><span style="display:flex;"><span>      map<span style="color:#f92672">&lt;</span>string,Font<span style="color:#f92672">*&gt;::</span>iterator item<span style="color:#f92672">=</span>fontPool.find(key);    
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span>(item<span style="color:#f92672">!=</span>footPool.end()){
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">return</span> fontPool[key];
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span>{
</span></span><span style="display:flex;"><span>          Font<span style="color:#f92672">*</span> font <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Font(key);
</span></span><span style="display:flex;"><span>          fontPool[key]<span style="color:#f92672">=</span> font;
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">return</span> font;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">clear</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="è¦ç‚¹æ€»ç»“-9">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-9">#</a></h2>
<p>äº«å…ƒæ¨¡å¼ä¸»è¦æ˜¯è§£å†³å¤§é‡å¯¹è±¡å¸¦æ¥çš„å†…å­˜æ¶ˆè€—é—®é¢˜ï¼Œå¦‚æœè¯„ä¼°ä¸å¯èƒ½å‘ç”Ÿï¼Œä¹Ÿæ²¡æœ‰å¿…è¦ä½¿ç”¨ã€‚</p>
<h1 id="é—¨é¢æ¨¡å¼-facade---æ¥å£éš”ç¦»">é—¨é¢æ¨¡å¼ facade&mdash;æ¥å£éš”ç¦»<a hidden class="anchor" aria-hidden="true" href="#é—¨é¢æ¨¡å¼-facade---æ¥å£éš”ç¦»">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯ä¸åŠ¨æœº">éœ€æ±‚èƒŒæ™¯ä¸åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯ä¸åŠ¨æœº">#</a></h2>
<p>é¡¹ç›®ä¸­ç”¨åˆ°äº†å¤šç§æ•°æ®åº“ï¼Œæ¯”å¦‚mysqlã€oracleã€DB2ã€Timestenç­‰ç­‰ï¼Œå¦‚æœå¤šä¸ªç¨‹åºç›´æ¥ä¸è¿™äº›æ•°æ®åº“æ‰“äº¤é“ï¼Œæ¯ä¸ªç¨‹åºéƒ½ä¼šéå¸¸å¤æ‚ï¼ŒäºŒæœŸå¦‚æœæ•°æ®åº“å‡çº§ï¼Œæ•°æ®åº“æ¥å£å˜åŠ¨ï¼Œç›¸å…³çš„ç¨‹åºéƒ½éœ€è¦æ”¹åŠ¨ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä¸€ä¸ªæ•°æ®è®¿é—®å±‚(æä¾›å›ºå®šçš„æ•°æ®è®¿é—®æ¥å£)ï¼Œç»™å¤–éƒ¨æä¾›ç»Ÿä¸€çš„è®¿é—®æ¥å£ï¼Œå°†å„ä¸ªæ•°æ®åº“çš„å¤„ç†ç»†èŠ‚å±è”½ï¼Œå³ä½¿æ•°æ®åº“å‡çº§æ”¹åŠ¨ï¼Œåªä¿®æ”¹æ¥å£å®ç°ï¼Œå¤–éƒ¨ç¨‹åºä¸ç”¨æ”¹åŠ¨ã€‚</p>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_facade%e9%97%a8%e9%9d%a2%e6%a8%a1%e5%bc%8f%e7%b3%bb%e7%bb%9f%e5%a4%8d%e6%9d%82%e5%ba%a6%e5%9b%be%e8%a7%a3.png" alt=""  />
</p>
<h2 id="æ¨¡å¼å®šä¹‰-7">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-7">#</a></h2>
<p>ä¸ºç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´ç¨³å®šçš„ç•Œé¢ï¼Œfacadeæ¨¡å¼å®šä¹‰ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œä½¿å¾—ç³»ç»Ÿå¤–éƒ¨ä½¿ç”¨è€…æ›´åŠ æ˜“ç”¨ï¼Œç¨³å®šï¼Œä¸ç”¨é¢‘ç¹å˜åŒ–ã€‚</p>
<h2 id="è¦ç‚¹æ€»ç»“-10">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-10">#</a></h2>
<ul>
<li>facadeæ¨¡å¼æ²¡æœ‰å›ºå®šçš„ä»£ç æ¨¡å¼ï¼Œæ›´å¤šçš„æ˜¯ä¸€ç§æ¶æ„æ€ç»´</li>
<li>facadeæ¨¡å¼å†…éƒ¨å¿…é¡»æ˜¯é«˜ç›¸å…³çš„ç»„ä»¶ï¼Œä¸èƒ½ä»€ä¹ˆéƒ½æ”¾</li>
</ul>
<h1 id="ä»£ç†æ¨¡å¼proxy---æ¥å£éš”ç¦»">ä»£ç†æ¨¡å¼Proxy&mdash;æ¥å£éš”ç¦»<a hidden class="anchor" aria-hidden="true" href="#ä»£ç†æ¨¡å¼proxy---æ¥å£éš”ç¦»">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº">éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº">#</a></h2>
<p>ç”±äºä¸€äº›å®é™…çš„ç°å®åŸå› ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨æŸä¸ªå¯¹è±¡(æ¯”å¦‚ä½¿ç”¨ä¹‹å‰è¦åšä¸€äº›å®‰å…¨æ§åˆ¶ï¼Œæˆ–è€…è¯´ç›´æ¥åˆ›å»ºæŸä¸ªå¯¹è±¡çš„å¼€é”€å¤ªå¤§ï¼Œåˆæˆ–è€…æ ¹æœ¬æ— æ³•ç›´æ¥åˆ›å»º[è®¿é—®ä¸€äº›åˆ†å¸ƒå¼æœºå™¨ä¸Šçš„èµ„æº])ï¼Œæ‰€ä»¥ç›´æ¥è®¿é—®ä¼šç»™ä½¿ç”¨è€…æˆ–è€…ç³»ç»Ÿæ¶æ„çš„è®¾è®¡ä»£ç éº»çƒ¦ï¼Œæ‰€ä»¥å°±éœ€è¦ä¸€ç§ä»£ç†ï¼Œå°±åƒç°å®ä¸–ç•Œçš„ä»£ç†ä¸€æ ·ï¼Œä¸ç”¨ç®¡ä¸€äº›ç»†èŠ‚ï¼Œåªè¦å®ƒä»¬æä¾›ç›¸åº”çš„æœåŠ¡å³å¯(è½¯ä»¶å±‚é¢å¯èƒ½å°±æ˜¯æä¾›ä¸€äº›å¯ç”¨çš„æ¥å£)ã€‚</p>
<p>ä»£ç†çš„æ“ä½œå¾€å¾€è·Ÿç›´æ¥æ“ä½œå¯¹è±¡ä¸€è‡´ï¼Œå¯ä»¥ç†è§£å¢åŠ äº†ä¸€ä¸ªé—´æ¥å±‚ä¹Ÿå°±æ˜¯ä»£ç†ï¼Œæ¥å®ç°æ§åˆ¶è¿™äº›å¯¹è±¡ã€‚</p>
<h2 id="æ¨¡å¼å®šä¹‰-8">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-8">#</a></h2>
<p>ä¸ºå…¶å®ƒå¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶(éš”ç¦»ï¼Œä½¿ç”¨æ¥å£)å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚</p>
<p>æˆ‘çš„ç†è§£å°±æ˜¯å¢åŠ ä¸€ä¸ªé—´æ¥å±‚ ä¸è®©ç›´æ¥ä½¿ç”¨ï¼Œè¿™ä¸ªæœ‰å¾ˆå¤šå¥½å¤„ï¼Œè·Ÿé—¨é¢æ¨¡å¼ä¸€æ ·ï¼Œå¯ä»¥éš”ç¦»å¾ˆå¤šå˜åŒ–ã€‚</p>
<h2 id="ç»“æ„å›¾è§£-7">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-7">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Proxy%e4%bb%a3%e7%90%86%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="ä»£ç -1">ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ä»£ç -1">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ISubject</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> process();
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RealSubject</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISubject{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> process(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//....
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å®¢æˆ·ç«¯ç›´æ¥ä½¿ç”¨æŸä¸ªå¯¹è±¡ å¦‚æœç°å®ä¸­ä¸èƒ½è®©ç›´æ¥ä½¿ç”¨ æ¯”å¦‚è¦å¢åŠ å®‰å…¨æ§åˆ¶ 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//åˆæ³•çš„clientæ‰èƒ½ä½¿ç”¨å°±è¦è€ƒè™‘æ”¹é€ äº† è€Œä¸”ä¸èƒ½å¯¹æ¯ä¸ªclientéƒ½æ”¹é€  æ‰€ä»¥æœ€åå®ç°èµ·å¯èƒ½æ¯”è¾ƒå¤æ‚æ··ä¹±
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ClientApp</span>{
</span></span><span style="display:flex;"><span>  ISubject<span style="color:#f92672">*</span> subject;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  ClientApp(){
</span></span><span style="display:flex;"><span>      subject<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> RealSubject();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">DoTask</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      subject<span style="color:#f92672">-&gt;</span>process();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//....
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ISubject</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> process();
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RealSubject</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISubject{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> process(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//....
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//Proxyçš„è®¾è®¡ ç»§æ‰¿ISubjectå®ç° ä¸€è‡´æ€§çš„æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SubjectProxy</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ISubject{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> process(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//å¯¹RealSubjectçš„ä¸€ç§é—´æ¥è®¿é—® æ¯”å¦‚è°ƒç”¨å‰åšå®‰å…¨æ§åˆ¶ ç»Ÿè®¡ä¸‹è°ƒç”¨æ¬¡æ•°ï¼Œä½¿ç”¨rpcè®¿é—®åˆ«çš„æœºå™¨ç­‰ç­‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//....
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å®¢æˆ·ç«¯ä½¿ç”¨ä»£ç†è·Ÿç›´æ¥ä½¿ç”¨RealSubjectæ²¡æœ‰å¤ªå¤§åŒºåˆ«
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ClientApp</span>{
</span></span><span style="display:flex;"><span>  ISubject<span style="color:#f92672">*</span> subject;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  ClientApp(){
</span></span><span style="display:flex;"><span>      subject<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> SubjectProxy();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">DoTask</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      subject<span style="color:#f92672">-&gt;</span>process();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//....
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="è¦ç‚¹æ€»ç»“-11">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-11">#</a></h2>
<ul>
<li>â€œå¢åŠ ä¸€ä¸ªä¸­é—´å±‚â€æ˜¯è½¯ä»¶ç³»ç»Ÿå¯¹è®¸å¤šå¤æ‚é—®é¢˜çš„ä¸€ç§å¸¸è§è§£å†³æ–¹æ¡ˆï¼Œå¦‚æœç›´æ¥ä½¿ç”¨æŸä¸ªå¯¹è±¡ä¼šå¸¦æ¥å¾ˆå¤šéº»çƒ¦ï¼Œå°±å°è¯•ä½¿ç”¨ä»£ç†æ¨¡å¼</li>
<li>å…·ä½“proxyè®¾è®¡æ¨¡å¼çš„å®ç°æ–¹æ³•ï¼Œåƒå·®ä¸‡åˆ«ã€‚</li>
</ul>
<h1 id="é€‚é…å™¨æ¨¡å¼adapter---æ¥å£éš”ç¦»">é€‚é…å™¨æ¨¡å¼Adapter&mdash;æ¥å£éš”ç¦»<a hidden class="anchor" aria-hidden="true" href="#é€‚é…å™¨æ¨¡å¼adapter---æ¥å£éš”ç¦»">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯åŠ¨æœº">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯åŠ¨æœº">#</a></h2>
<p>â€‹	ç°å®é¡¹ç›®ä¸­ç”±äºåº”ç”¨ç¯å¢ƒçš„å˜åŒ–ï¼Œå¸¸å¸¸éœ€è¦å°†â€œä¸€äº›ç°å­˜çš„å¯¹è±¡â€æ”¾åœ¨æ–°ç¯å¢ƒä½¿ç”¨ï¼Œä½†æ˜¯æ–°ç¯å¢ƒè¦æ±‚çš„æ¥å£åˆæ˜¯ä¸€äº›è€å¯¹è±¡æ‰€ä¸èƒ½ç›´æ¥æ»¡è¶³çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šæƒ³åˆ°é€‚é…å™¨æ¨¡å¼ï¼Œç®€å•æ¥è¯´å°±æ˜¯å®šä¹‰ä¸€ä¸ªé€‚é…å™¨ç±»ç»§æ‰¿æ–°æ¥å£çš„åŸºç±»ï¼Œä½†æ˜¯ç”¨å¯¹è±¡ç»„åˆçš„æ–¹å¼æ‹¥æœ‰è€å¯¹è±¡çš„åŸºç±»æˆ–è€…å­ç±»ï¼Œç”¨è€å¯¹è±¡çš„æŸäº›æ–¹æ³•å®ç°æ–°çš„æ¥å£ã€‚</p>
<p>â€‹	ç°å®ç”Ÿæ´»ä¸­ä¹Ÿæœ‰å¾ˆå¤šé€‚é…å™¨ï¼Œæ¯”å¦‚ç”µæºçš„é€‚é…å™¨ï¼ŒHTMIè½¬VGAç­‰ç­‰ï¼Œè¯´ç™½äº†å°±æ˜¯æŠŠä¸€ä¸ªè€çš„æ¥å£è½¬æˆæ–°çš„æ¥å£ã€‚</p>
<h2 id="æ¨¡å¼å®šä¹‰-9">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-9">#</a></h2>
<p>å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ–°æ¥å£ã€‚Adapteræ¨¡å¼ä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚</p>
<h2 id="ç»“æ„å›¾è§£-8">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-8">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Adapter%e9%80%82%e9%85%8d%e5%99%a8%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="è¦ç‚¹æ€»ç»“-12">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-12">#</a></h2>
<ul>
<li>Adapteræ¨¡å¼ä¸»è¦åº”ç”¨äºâ€œå¸Œæœ›å¤ç”¨ä¸€äº›ç°å­˜çš„ç±»â€ï¼Œä½†æ¥å£åˆä¸å¤ç”¨ç¯å¢ƒè¦æ±‚çš„ä¸ä¸€è‡´ï¼Œåœ¨é—ç•™ä»£ç å¤ç”¨ï¼Œç±»åº“è¿ç§»ç­‰æ–¹é¢éå¸¸æœ‰ç”¨ã€‚</li>
<li>GoF23å®šä¹‰çš„é€‚é…å™¨æœ‰2ç§ï¼Œå¯¹è±¡é€‚é…å™¨(ä¸Šå›¾çš„è¿™ç§)å’Œç±»é€‚é…å™¨(ç›´æ¥å¤šç»§æ‰¿è€å¯¹è±¡)ï¼Œç±»é€‚é…å™¨ä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºä½¿ç”¨äº†å¤šç»§æ‰¿ï¼Œä¸€èˆ¬éƒ½æ˜¯è¢«æ‘’å¼ƒçš„ã€‚å¯¹è±¡ç»„åˆçš„æ–¹å¼æ›´ç¬¦åˆæ¾è€¦åˆç²¾ç¥</li>
<li>å…¶å®å®é™…é¡¹ç›®ä¸­å®Œå…¨ä¹Ÿä¸ç”¨æ‹˜æ³¥äºä¹¦ä¸­å®šä¹‰çš„ç»“æ„ï¼Œå³ä½¿æŠŠè€å¯¹è±¡ä½œä¸ºæ–°å¯¹è±¡æ–°æ¥å£çš„å‚æ•°ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</li>
</ul>
<h2 id="ä»£ç -2">ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ä»£ç -2">#</a></h2>
<p>Adapteré€‚é…å™¨æ¨¡å¼ c++</summary></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//ç›®æ ‡æ¥å£ï¼ˆæ–°æ¥å£ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ITarget</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> process()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//é—ç•™æ¥å£ï¼ˆè€æ¥å£ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IAdaptee</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> foo(<span style="color:#66d9ef">int</span> data)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">bar</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//é—ç•™ç±»å‹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OldClass</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> IAdaptee{
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//....
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å¯¹è±¡é€‚é…å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Adapter</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ITarget{ <span style="color:#75715e">//ç»§æ‰¿æ–°æ¥å£åŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  IAdaptee<span style="color:#f92672">*</span> pAdaptee;<span style="color:#75715e">//ç»„åˆæ–¹å¼æ‹¥æœ‰è€å¯¹è±¡ è¿™æ ·å°±å¯ä»¥é€šè¿‡åŠ å·¥è€å¯¹è±¡çš„æ–¹æ³•å®ç°æ–°æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Adapter(IAdaptee<span style="color:#f92672">*</span> pAdaptee){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>pAdaptee<span style="color:#f92672">=</span>pAdaptee;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">process</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">int</span> data<span style="color:#f92672">=</span>pAdaptee<span style="color:#f92672">-&gt;</span>bar();
</span></span><span style="display:flex;"><span>      pAdaptee<span style="color:#f92672">-&gt;</span>foo(data);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç±»é€‚é…å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Adapter</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ITarget,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">protected</span> OldClass{ <span style="color:#75715e">//å¤šç»§æ‰¿ ä¸æ¨èä½¿ç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>  IAdaptee<span style="color:#f92672">*</span> pAdaptee<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> OldClass();
</span></span><span style="display:flex;"><span>  ITarget<span style="color:#f92672">*</span> pTarget<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> Adapter(pAdaptee);
</span></span><span style="display:flex;"><span>  pTarget<span style="color:#f92672">-&gt;</span>process();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">//stlçš„æ ˆå’Œé˜Ÿåˆ— å¤§è‡´ä¹Ÿæ˜¯é€šè¿‡å¯¹è±¡ç»„åˆçš„æ–¹å¼å®ç°çš„ ä¹Ÿå¯ä»¥ç†è§£ä¸ºAdapteræ¨¡å¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">stack</span>{
</span></span><span style="display:flex;"><span>  deqeue container;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">queue</span>{
</span></span><span style="display:flex;"><span>  deqeue container;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h1 id="ä¸­ä»‹è€…mediator---æ¥å£éš”ç¦»">ä¸­ä»‹è€…Mediator&mdash;æ¥å£éš”ç¦»<a hidden class="anchor" aria-hidden="true" href="#ä¸­ä»‹è€…mediator---æ¥å£éš”ç¦»">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº-1">éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº-1">#</a></h2>
<ul>
<li>
<p>å¦‚æœç°å®é¡¹ç›®ä¸­å‡ºç°äº†å¤šä¸ªå¯¹è±¡äº’ç›¸å…³è”äº¤äº’çš„æƒ…å†µï¼Œå®ƒä»¬å½¼æ­¤ä¹‹é—´å¾å¥¥ç»´æŒä¸€ç§å¤æ‚çš„å¼•ç”¨å…³ç³»ï¼ŒAå˜äº† BCä¹Ÿè¦å˜ï¼ŒCå˜äº†Dä¹Ÿè¦å˜ï¼ŒDå˜äº†å¯èƒ½Aåˆè¦è·Ÿç€åšç›¸åº”å˜åŒ–ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœé‡åˆ°éœ€æ±‚å˜æ›´ï¼Œæ”¹åŠ¨èµ·æ¥å°†ä¼šéå¸¸éº»çƒ¦ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚</p>
</li>
<li>
<p>è¿™ä¸ªæ—¶å€™å°±å¯ä»¥è€ƒè™‘å¼•å…¥ä¸€ä¸ªä¸­ä»‹è€…ï¼Œè®©å®ƒä»¬å½¼æ­¤çš„å¼•ç”¨æ‹†å¼€ï¼Œå˜æˆéƒ½ç»™ä¸­ä»‹è€…æ‰“äº¤é“ï¼ŒAå˜äº†å¦‚æœè¦æ”¹å˜Bæˆ–è€…Cï¼Œå°±é€šçŸ¥ä¸­ä»‹è€…ï¼Œç„¶åä¸­ä»‹å»é€šçŸ¥BCåšæ”¹å˜ï¼Œå½“ç„¶è¦å»ºç«‹è‰¯å¥½çš„é€šçŸ¥æœºåˆ¶å’Œåè®®ã€‚</p>
</li>
<li>
<p>å¦‚æœä¸­ä»‹è€…æœ€åéå¸¸åºå¤§æˆ–è€…å¤æ‚ï¼Œä¹Ÿè¦è€ƒè™‘ç»§ç»­æ‹†åˆ†ä¸­ä»‹è€…</p>
</li>
</ul>
<h2 id="æ¨¡å¼å®šä¹‰-10">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-10">#</a></h2>
<p>ç”¨ä¸­ä»‹å¯¹è±¡æ¥å°è£…(å˜åŒ–)ä¸€äº›åˆ—çš„å¯¹è±¡äº¤äº’ï¼Œè®©åŸå…ˆå„ä¸ªå¯¹è±¡ä¸éœ€è¦æ˜¾ç¤ºç›¸äº’å¼•ç”¨(ç¼–è¯‘æ—¶ä¾èµ–&mdash;&gt;è¿è¡Œæ—¶ä¾èµ–)ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œä¾¿äºç®¡ç†å˜åŒ–ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹çš„æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚</p>
<h2 id="ç»“æ„å›¾è§£-9">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-9">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Mediator%e4%b8%ad%e4%bb%8b%e8%80%85%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="è¦ç‚¹æ€»ç»“-13">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-13">#</a></h2>
<ul>
<li>å°†å¤šä¸ªå¯¹è±¡å¤æ‚çš„å…³è”å…³ç³»è§£è€¦ï¼ŒMediatoræ¨¡å¼å°†å¤šä¸ªå¯¹è±¡é—´çš„æ§åˆ¶é€»è¾‘è¿›è¡Œç»Ÿä¸€ç®¡ç†ï¼Œå°†â€œå¤šä¸ªå¯¹è±¡äº’ç›¸å…³è”â€å˜æˆäº†&quot;å¤šä¸ªå¯¹è±¡éƒ½å’Œä¸­ä»‹è€…å…³è”â€œï¼Œç®€åŒ–äº†ç³»ç»Ÿçš„ç»´æŠ¤ï¼ŒæŠµå¾¡äº†å¯èƒ½çš„å˜åŒ–ã€‚</li>
<li>å¦‚æœMediatorå˜å¾—å¤ªå¤šå¤æ‚ä¹Ÿè¦å¯¹å…¶æ‹†åˆ†å¤„ç†</li>
<li>facadeæ¨¡å¼æ˜¯è§£è€¦ç³»ç»Ÿé—´(å•å‘)çš„å¯¹è±¡å…³è”å…³ç³»ï¼Œä½†Mediatoræ¨¡å¼æ˜¯è§£è€¦ç³»ç»Ÿå†…å„ä¸ªå¯¹è±¡ä¹‹é—´çš„(åŒå‘)å…³è”å…³ç³»ã€‚</li>
</ul>
<h1 id="çŠ¶æ€æ¨¡å¼state---çŠ¶æ€å˜åŒ–">çŠ¶æ€æ¨¡å¼State&mdash;çŠ¶æ€å˜åŒ–<a hidden class="anchor" aria-hidden="true" href="#çŠ¶æ€æ¨¡å¼state---çŠ¶æ€å˜åŒ–">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯åŠ¨æœº-1">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯åŠ¨æœº-1">#</a></h2>
<ul>
<li>
<p>åœ¨è½¯ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼ŒæŸäº›å¯¹è±¡çš„çŠ¶æ€å¦‚æœæ”¹å˜ï¼Œå…¶è¡Œä¸ºä¹Ÿä¼šéšä¹‹å‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚æ–‡æ¡£å¤„äºåªè¯»çŠ¶æ€ï¼Œåˆ™æ”¯æŒè¡Œä¸ºå’Œè¯»å†™çŠ¶æ€çš„è¡Œä¸ºå¯èƒ½å°±å®Œå…¨ä¸åŒäº†</p>
</li>
<li>
<p>å¦‚ä½•åœ¨è¿è¡Œæ—¶æ ¹æ®å¯¹è±¡çš„çŠ¶æ€æ¥é€æ˜çš„æ›´æ”¹å¯¹è±¡çš„è¡Œä¸ºï¼Ÿè€Œä¸”ä¸ä¼šä¸ºå¯¹è±¡æ“ä½œå’ŒçŠ¶æ€è½¬åŒ–ä¹‹é—´å¼•å…¥è€¦åˆï¼Ÿ</p>
</li>
</ul>
<h2 id="ä¾‹å­">ä¾‹å­<a hidden class="anchor" aria-hidden="true" href="#ä¾‹å­">#</a></h2>
<p>å‡è®¾æœ‰ä¸€ä¸ªç½‘ç»œçŠ¶æ€å¤„ç†ç±»ï¼Œå¤§è‡´æœ‰3ç§æ“ä½œï¼Œä½†æ˜¯å¯¹äºæ¯ç§æ“ä½œï¼Œä¸åŒçš„çŠ¶æ€æœ‰ä¸åŒçš„å¤„ç†ï¼Œè€Œä¸”å¤„ç†åè¦åˆ‡æ¢åˆ°å¯¹åº”çš„çŠ¶æ€</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//æšä¸¾å€¼ å®šä¹‰ç½‘ç»œçš„å¤šç§çŠ¶æ€ æœªæ¥å¯èƒ½ä¼šæ–°å¢çŠ¶æ€çš„å¤„ç†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">enum</span> <span style="color:#a6e22e">NetworkState</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  Network_Open,
</span></span><span style="display:flex;"><span>  Network_Close,
</span></span><span style="display:flex;"><span>  Network_Connect,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç½‘ç»œå¤„ç†ç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NetworkProcessor</span>{
</span></span><span style="display:flex;"><span>  NetworkState state;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//é’ˆå¯¹æ“ä½œ1 ä¸åŒçš„çŠ¶æ€ä¼šå‘ç”Ÿä¸åŒçš„è¡Œä¸ºï¼ŒåŒæ—¶æ“ä½œåçŠ¶æ€è¦åˆ‡æ¢ è¿™é‡Œé¢åç»­å¯èƒ½è¿˜è¦å¢åŠ çŠ¶æ€ ä¸€æ¥ä¿®æ”¹å¯èƒ½å¼•å…¥bugï¼ŒäºŒæ¥ä¿®æ”¹èµ·æ¥å¾€å¾€æ¯”è¾ƒå›°éš¾ï¼Œå› ä¸ºå¤ªå¤šifelseäº†å®¹æ˜“æ™•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> Operation1(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (state <span style="color:#f92672">==</span> Network_Open){
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">//**********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          state <span style="color:#f92672">=</span> Network_Close;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (state <span style="color:#f92672">==</span> Network_Close){
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">//..........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          state <span style="color:#f92672">=</span> Network_Connect;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (state <span style="color:#f92672">==</span> Network_Connect){
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">//$$$$$$$$$$
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          state <span style="color:#f92672">=</span> Network_Open;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//é’ˆå¯¹æ“ä½œ2 ä¸åŒçš„çŠ¶æ€ä¼šå‘ç”Ÿä¸åŒçš„è¡Œä¸ºï¼ŒåŒæ—¶æ“ä½œåçŠ¶æ€è¦åˆ‡æ¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Operation2</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (state <span style="color:#f92672">==</span> Network_Open){
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">//**********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          state <span style="color:#f92672">=</span> Network_Connect;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (state <span style="color:#f92672">==</span> Network_Close){
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">//.....
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          state <span style="color:#f92672">=</span> Network_Open;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (state <span style="color:#f92672">==</span> Network_Connect){
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">//$$$$$$$$$$
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          state <span style="color:#f92672">=</span> Network_Close;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//é’ˆå¯¹æ“ä½œ3 ä¸åŒçš„çŠ¶æ€ä¼šå‘ç”Ÿä¸åŒçš„è¡Œä¸ºï¼ŒåŒæ—¶æ“ä½œåçŠ¶æ€è¦åˆ‡æ¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Operation3</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//ã€‚ã€‚ã€‚ã€‚ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="æ¨¡å¼å®šä¹‰-11">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-11">#</a></h2>
<ul>
<li>å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜çš„æ—¶å€™æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œä»è€Œä½¿å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å…¶è¡Œä¸ºã€‚</li>
</ul>
<h2 id="ç»“æ„å›¾è§£-10">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-10">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_State%e7%8a%b6%e6%80%81%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="è¦ç‚¹æ€»ç»“-14">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-14">#</a></h2>
<ul>
<li>Stateæ¨¡å¼æ ¸å¿ƒæ˜¯å°†æ‰€æœ‰ä¸ä¸€ä¸ªç‰¹å®šçŠ¶æ€ç›¸å…³çš„è¡Œä¸ºéƒ½æ”¾å…¥ä¸€ä¸ªStateçš„å­ç±»å¯¹è±¡ä¸­ï¼Œåœ¨å¯¹è±¡çŠ¶æ€åˆ‡æ¢çš„æ—¶å€™ï¼Œå…¶å®æ˜¯åˆ‡æ¢äº†ä¸åŒçš„å­ç±»å¯¹è±¡æŒ‡å‘ï¼Œä½†åŒæ—¶ç»´æŒStateçš„æ¥å£(éƒ½ç»§æ‰¿åŒä¸€ä¸ªåŸºç±»)ï¼Œè¿™æ ·å°±å®ç°äº†å…·ä½“çš„æ“ä½œå’ŒçŠ¶æ€è½¬æ¢ä¹‹é—´çš„è§£è€¦ã€‚</li>
<li>ä¸ºä¸åŒçš„çŠ¶æ€å¼•å…¥ä¸åŒçš„å¯¹è±¡ä½¿å¾—çŠ¶æ€è½¬æ¢å˜å¾—æ›´åŠ æ˜ç¡®ï¼Œè€Œä¸”å¯ä»¥ä¿è¯ä¸ä¼šå‡ºç°çŠ¶æ€ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå› ä¸ºè½¬æ¢æ˜¯æºè‡ªè¡Œçš„ï¼Œè¦ä¹ˆå½»åº•è½¬æ¢è¿‡æ¥ï¼Œè¦ä¹ˆä¸è½¬æ¢ã€‚</li>
<li>å¦‚æœStateå¯¹è±¡æ²¡æœ‰å®ä¾‹å˜é‡ï¼Œå¯ä»¥ç”¨singetoneæ¨¡å¼å…±äº«åŒä¸€ä¸ªå¯¹è±¡ï¼Œä»è€ŒèŠ‚çœå¯¹è±¡å¼€é”€</li>
</ul>
<h2 id="ä»£ç -3">ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ä»£ç -3">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//çŠ¶æ€åŸºç±»ï¼Œå°†ä¸åŒçš„çŠ¶æ€æ”¹ä¸ºä¸åŒçš„ç±»(å¯¹è±¡)ï¼Œå®ç°åŒæ ·çš„æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NetworkState</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  NetworkState<span style="color:#f92672">*</span> pNext;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Operation1</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Operation2</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Operation3</span>()<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>NetworkState(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ‰“å¼€çŠ¶æ€ç±» è¦å®ç°ä¸åŒçš„æ“ä½œå¯¹åº”åº”è¯¥æ€ä¹ˆå¤„ç† åŒæ—¶æ“ä½œååº”è¯¥åˆ‡æ¢åˆ°ä»€ä¹ˆçŠ¶æ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OpenState</span> <span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> NetworkState{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">static</span> NetworkState<span style="color:#f92672">*</span> m_instance;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">static</span> NetworkState<span style="color:#f92672">*</span> getInstance(){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (m_instance <span style="color:#f92672">==</span> <span style="color:#66d9ef">nullptr</span>) {
</span></span><span style="display:flex;"><span>          m_instance <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> OpenState();
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> m_instance;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//è¿™é‡Œå°†åªå…³æ³¨æ‰“å¼€çŠ¶æ€åœ¨Operation1æ—¶å¦‚ä½•å¤„ç†ï¼Œä¸å®¹æ˜“æ··æ·†ï¼ŒåŒæ—¶åˆ‡æ¢çŠ¶æ€å…¶å®æ˜¯åˆ‡æ¢å­ç±»æŒ‡é’ˆæŒ‡å‘ï¼Œæ˜¯æœ‰åŸå­æ€§çš„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Operation1</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//**********
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      pNext <span style="color:#f92672">=</span> CloseState<span style="color:#f92672">::</span>getInstance();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Operation2</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//..........
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      pNext <span style="color:#f92672">=</span> ConnectState<span style="color:#f92672">::</span>getInstance();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Operation3</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//$$$$$$$$$$
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      pNext <span style="color:#f92672">=</span> OpenState<span style="color:#f92672">::</span>getInstance();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å…³é—­çŠ¶æ€ç±» è¦å®ç°ä¸åŒçš„æ“ä½œå¯¹åº”åº”è¯¥æ€ä¹ˆå¤„ç† åŒæ—¶æ“ä½œååº”è¯¥åˆ‡æ¢åˆ°ä»€ä¹ˆçŠ¶æ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CloseState</span><span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> NetworkState{ };
</span></span><span style="display:flex;"><span><span style="color:#75715e">//..
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NetworkProcessor</span>{
</span></span><span style="display:flex;"><span>  NetworkState<span style="color:#f92672">*</span> pState;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//çŠ¶æ€ç±»åˆå§‹åŒ–å é’ˆå¯¹ä¸åŒçš„çŠ¶æ€ æ“ä½œæ¥å£æ˜¯ç±»ä¼¼çš„ï¼Œé‚£å°±æ˜¯æ‰§è¡Œæƒ³è¦çš„æ“ä½œï¼Œåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//ä»£ç ä¿æŒç¨³å®šï¼Œå³ä½¿æ–°å¢çŠ¶æ€ï¼Œå¦‚æœæ¥å£ä¸æ”¹å˜ NetworkProcessorç±»ä»£ç æ— éœ€æ”¹å˜
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  NetworkProcessor(NetworkState<span style="color:#f92672">*</span> pState){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>pState <span style="color:#f92672">=</span> pState;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Operation1</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      pState<span style="color:#f92672">-&gt;</span>Operation1();
</span></span><span style="display:flex;"><span>      pState <span style="color:#f92672">=</span> pState<span style="color:#f92672">-&gt;</span>pNext;
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Operation2</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      pState<span style="color:#f92672">-&gt;</span>Operation2();
</span></span><span style="display:flex;"><span>      pState <span style="color:#f92672">=</span> pState<span style="color:#f92672">-&gt;</span>pNext;
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Operation3</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      pState<span style="color:#f92672">-&gt;</span>Operation3();
</span></span><span style="display:flex;"><span>      pState <span style="color:#f92672">=</span> pState<span style="color:#f92672">-&gt;</span>pNext;
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h1 id="å¤‡å¿˜å½•memento----çŠ¶æ€å˜åŒ–">å¤‡å¿˜å½•Memento&mdash;-çŠ¶æ€å˜åŒ–<a hidden class="anchor" aria-hidden="true" href="#å¤‡å¿˜å½•memento----çŠ¶æ€å˜åŒ–">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯åŠ¨æœº-2">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯åŠ¨æœº-2">#</a></h2>
<ul>
<li>ç°å®è½¯ä»¶ç³»ç»Ÿæœ‰æ—¶å€™éœ€è¦ä¿å­˜æŸä¸ªå¯¹è±¡çš„çŠ¶æ€ï¼Œç›¸å½“äºç»™å½“ä¸‹çš„å¯¹è±¡æ¥ä¸ªå¿«ç…§ä¿å­˜èµ·æ¥ï¼Œä»¥ä¾¿æœªæ¥æŸä¸ªæ—¶é—´æ¢å¤è¿™ä¸ªçŠ¶æ€åšç›¸åº”çš„å¤„ç†ï¼Œåˆä¸èƒ½ç ´åå¯¹è±¡çš„å°è£…æ€§ï¼Œä¸èƒ½æš´æ¼å…¬å…±æ¥å£ç»™å¤–éƒ¨ã€‚</li>
<li>æœ€å¼€å§‹çš„æ—¶å€™å°±æƒ³åˆ°äº†å¤‡å¿˜å½•æ¨¡å¼ï¼Œæ‰€è°“å¤‡å¿˜å½•ç®€å•ç†è§£å°±æ˜¯æ·±æ‹·è´ä¸€ä¸ªå¯¹è±¡ï¼Œä¿å­˜èµ·æ¥ï¼Œæœªæ¥æŸä¸ªæ—¶é—´å†æ‹¿è¿™ä¸ªå¤‡å¿˜å½•é‡å»ºå¯¹è±¡ï¼Œå®ç°æŸäº›ç‰¹å®šçš„åŠŸèƒ½ã€‚</li>
</ul>
<h2 id="æ¨¡å¼å®šä¹‰-12">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-12">#</a></h2>
<ul>
<li>ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™æ ·ä»¥åå°±å¯ä»¥å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ï¼Œä»¥å®ç°ç‰¹å®šçš„åŠŸèƒ½ã€‚</li>
</ul>
<h2 id="ç»“æ„å›¾è§£-11">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-11">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Memento%e5%a4%87%e5%bf%98%e5%bd%95%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="è¦ç‚¹æ€»ç»“-15">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-15">#</a></h2>
<ul>
<li>å¤‡å¿˜å½•Mementoéœ€è¦å­˜å‚¨åŸå‘å™¨Originatorå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œä»¥å¤‡éœ€è¦æ—¶æ¢å¤åŸå‘å™¨Originatorçš„çŠ¶æ€</li>
<li>Mementoçš„æ ¸å¿ƒæ˜¯ä¿¡æ¯éšè—</li>
<li>å› ä¸ºè®¾è®¡æ¨¡å¼æ˜¯94å¹´æå‡ºäº†ï¼Œç°åœ¨è¿™ä¸ªæ¨¡å¼æœ‰ç‚¹è¿‡æ—¶ï¼Œå› ä¸ºå¾ˆå¤šé«˜çº§è¯­è¨€éƒ½æä¾›äº†åºåˆ—åŒ–ã€ååºåˆ—åŒ–çš„æŠ€æœ¯ï¼Œä½†æ˜¯æ€æƒ³æ˜¯ä¸€æ ·çš„ã€‚</li>
</ul>
<h2 id="ä»£ç -4">ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ä»£ç -4">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//å¤‡å¿˜å½•ç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Memento</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  string state;
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//.. è¿™é‡Œä¸ºäº†ä¿å­˜å†…éƒ¨çš„çŠ¶æ€ å¯èƒ½å®ç°æ¯”è¾ƒå¤æ‚ ä»…ä¸ºç¤ºæ„ä»£ç 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Memento(<span style="color:#66d9ef">const</span> string <span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">:</span> state(s) {}
</span></span><span style="display:flex;"><span>  string <span style="color:#a6e22e">getState</span>() <span style="color:#66d9ef">const</span> { <span style="color:#66d9ef">return</span> state; }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setState</span>(<span style="color:#66d9ef">const</span> string <span style="color:#f92672">&amp;</span> s) { state <span style="color:#f92672">=</span> s; }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//åŸå‘å™¨ç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Originator</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  string state;
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//....
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Originator() {}
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//åˆ›å»ºå¤‡å¿˜å½•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  Memento <span style="color:#a6e22e">createMomento</span>() {
</span></span><span style="display:flex;"><span>      Memento m(state);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> m;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//ç”¨å¤‡å¿˜å½•æ¢å¤åŸå§‹çŠ¶æ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setMomento</span>(<span style="color:#66d9ef">const</span> Memento <span style="color:#f92672">&amp;</span> m) {
</span></span><span style="display:flex;"><span>      state <span style="color:#f92672">=</span> m.getState();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  Originator orginator;
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//..åšç›¸åº”å¤„ç† æ”¹å˜çŠ¶æ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//æ•è·å¯¹è±¡çŠ¶æ€ï¼Œå­˜å‚¨åˆ°å¤‡å¿˜å½•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  Memento mem <span style="color:#f92672">=</span> orginator.createMomento();
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//... æ”¹å˜orginatorçŠ¶æ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//ä»å¤‡å¿˜å½•ä¸­æ¢å¤
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  orginator.setMomento(mem);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="ç»„åˆæ¨¡å¼composit---æ•°æ®ç»“æ„">ç»„åˆæ¨¡å¼Composit&mdash;æ•°æ®ç»“æ„<a hidden class="anchor" aria-hidden="true" href="#ç»„åˆæ¨¡å¼composit---æ•°æ®ç»“æ„">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº-2">éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº-2">#</a></h2>
<ul>
<li>å¦‚ä½•å®¢æˆ·ä»£ç è¿‡å¤šçš„ä¾èµ–å¯¹è±¡å®¹å™¨å¤æ‚çš„å†…éƒ¨å®ç°çš„æ•°æ®ç»“æ„ï¼Œå¯¹è±¡å®¹å™¨å†…éƒ¨çš„å®ç°ç»“æ„(ä¸æ˜¯æŠ½è±¡æ¥å£)å¦‚æœå‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆå®¢æˆ·ä»£ç ä¹Ÿä¼šé¢‘ç¹å˜åŒ–ï¼Œå°±å¸¦æ¥äº†ä»£ç çš„ç»´æŠ¤æ€§ï¼Œæ‰©å±•æ€§ç­‰å¼Šç«¯</li>
<li>æ‰€ä»¥éœ€è¦å°†å®¢æˆ·ä»£ç ä¸å¤æ‚çš„å¯¹è±¡å®¹å™¨ç»“æ„è§£è€¦ï¼Œè®©å®¢æˆ·ä¸ç®¡æ˜¯å¤„ç†ä»€ä¹ˆæ ·çš„ç»“æ„éƒ½è°ƒç”¨ç»Ÿä¸€çš„æ¥å£ç®€å•å¤„ç†ï¼Œä¸ä¼šå› ä¸ºå¯¹è±¡å†…éƒ¨æ•°æ®ç»“æ„çš„å˜åŒ–è€Œå‘ç”Ÿå˜åŒ–</li>
<li>å‡è®¾æœ‰ä¸€ä¸ªéœ€æ±‚éœ€è¦å¤„ç†å•ä¸ªå¶å­èŠ‚ç‚¹ï¼Œä¹Ÿè¦å¤æ‚èŠ‚ç‚¹(listé›†åˆ è£…æœ‰å¤šä¸ªèŠ‚ç‚¹)</li>
</ul>
<h2 id="æ¨¡å¼å®šä¹‰-13">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-13">#</a></h2>
<p>â€‹	å°†å¯¹è±¡ç¥–è¾ˆæˆå±æ€§ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ï¼ŒCompositeæ˜¯çš„ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡è¿˜æ˜¯ç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§(ç¨³å®š)ã€‚</p>
<ul>
<li>å…¶å®å°±æ˜¯å•ä¸ªå¯¹è±¡ ç»„åˆå¯¹è±¡éƒ½ç»§æ‰¿åŒä¸€ä¸ªåŸºç±»ï¼Œå®ç°åŒä¸€ä¸ªå…¬å…±æ¥å£ï¼Œè¿™æ ·ç”¨å¤šæ€å®ç°ï¼Œå®¢æˆ·ç«¯çš„è°ƒç”¨å°±æ˜¯ä¸€è‡´çš„ï¼Œä¸ç”¨é¢‘ç¹æ”¹å˜ã€‚</li>
</ul>
<h2 id="ç»“æ„å›¾è§£-12">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-12">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Composite%e7%bb%84%e5%90%88%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="ä»£ç -5">ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ä»£ç -5">#</a></h2>
<p>Compositeç»„åˆæ¨¡å¼c++</summary></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;list&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;algorithm&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç»„ä»¶åŸºç±» å®šä¹‰å…¬ç”¨æ¥å£ è¿™äº›æ¥å£å¾€å¾€æ˜¯ç›´æ¥æš´æ¼ç»™å®¢æˆ·çš„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Component</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> process() <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Component(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ”¯æŒå¤æ‚ç»“æ„çš„å¤„ç† ç»§æ‰¿ç»„ä»¶åŸºç±» å®ç°processå…¬å…±å¤–éƒ¨æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Composite</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Component{
</span></span><span style="display:flex;"><span>  string name;
</span></span><span style="display:flex;"><span>  list<span style="color:#f92672">&lt;</span>Component<span style="color:#f92672">*&gt;</span> elements;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Composite(<span style="color:#66d9ef">const</span> string <span style="color:#f92672">&amp;</span> s) <span style="color:#f92672">:</span> name(s) {}
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//å› ä¸ºå†…éƒ¨æ˜¯ä¸€ä¸ªlisté›†åˆï¼Œæ‰€ä»¥éœ€è¦add removeæ–¹æ³• addçš„å¯ä»¥æ˜¯ç®€å•èŠ‚ç‚¹ ä¹Ÿå¯ä»¥è¿˜æ˜¯ä¸€ä¸ªlist
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">add</span>(Component<span style="color:#f92672">*</span> element) {
</span></span><span style="display:flex;"><span>      elements.push_back(element);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">remove</span>(Component<span style="color:#f92672">*</span> element){
</span></span><span style="display:flex;"><span>      elements.remove(element);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//å®ç°å…¬å…±å¤–éƒ¨æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">process</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//1. process current node
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//2. process leaf nodes å¾ªç¯å¯¹listå†…éƒ¨çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½å¤„ç†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> <span style="color:#f92672">&amp;</span>e : elements)
</span></span><span style="display:flex;"><span>          e<span style="color:#f92672">-&gt;</span>process(); <span style="color:#75715e">//å¤šæ€è°ƒç”¨    
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å¶å­èŠ‚ç‚¹ ç®€å•èŠ‚ç‚¹ ä¹Ÿå®ç°processå…¬å…±æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Leaf</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Component{
</span></span><span style="display:flex;"><span>  string name;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Leaf(string s) <span style="color:#f92672">:</span> name(s) {}
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//å®ç°å…¬å…±processæ¥å£         
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">process</span>(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//process current node
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//  å®¢æˆ·ç«¯çš„è°ƒç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Invoke</span>(Component <span style="color:#f92672">&amp;</span> c){
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  c.process();<span style="color:#75715e">//è¿™é‡Œå®¢æˆ·ç«¯ä¸ç”¨å…³å¿ƒç»„ä»¶åˆ°åº•æ˜¯ç®€å•èŠ‚ç‚¹è¿˜æ˜¯é›†åˆå¤æ‚èŠ‚ç‚¹ ç”¨å¤šæ€å®ç°äº†ç»Ÿä¸€çš„å¤„ç†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//å¦‚æœè¿™é‡Œä¸ç”¨å¤šæ€ï¼Œå®¢æˆ·å°±è¦åŒºåˆ†åˆ°åº•æ˜¯ç®€å•èŠ‚ç‚¹è¿˜æ˜¯listé›†åˆï¼Œé’ˆå¯¹listé›†åˆè¦åšæƒ³è¦çš„å¾ªç¯éå†å¤„ç†ï¼ŒæŠŠå¯¹è±¡çš„æ›´å¤šç»†èŠ‚æš´æ¼ç»™å®¢æˆ·
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//åŒæ—¶å¦‚æœlistæ•°æ®ç»“æ„å‘ç”Ÿäº†å˜åŒ– æ¯”å¦‚æ”¹ä¸ºäº†setå®ç°ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯çš„ä»£ç ä¹Ÿè¦è·Ÿç€æ”¹å˜ è¿™æ˜¯éå¸¸ç³Ÿç³•çš„ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  Composite root(<span style="color:#e6db74">&#34;root&#34;</span>);
</span></span><span style="display:flex;"><span>  Composite treeNode1(<span style="color:#e6db74">&#34;treeNode1&#34;</span>);
</span></span><span style="display:flex;"><span>  Composite treeNode2(<span style="color:#e6db74">&#34;treeNode2&#34;</span>);
</span></span><span style="display:flex;"><span>  Composite treeNode3(<span style="color:#e6db74">&#34;treeNode3&#34;</span>);
</span></span><span style="display:flex;"><span>  Composite treeNode4(<span style="color:#e6db74">&#34;treeNode4&#34;</span>);
</span></span><span style="display:flex;"><span>  Leaf leat1(<span style="color:#e6db74">&#34;left1&#34;</span>);
</span></span><span style="display:flex;"><span>  Leaf leat2(<span style="color:#e6db74">&#34;left2&#34;</span>);
</span></span><span style="display:flex;"><span>  root.add(<span style="color:#f92672">&amp;</span>treeNode1);
</span></span><span style="display:flex;"><span>  treeNode1.add(<span style="color:#f92672">&amp;</span>treeNode2);
</span></span><span style="display:flex;"><span>  treeNode2.add(<span style="color:#f92672">&amp;</span>leaf1);
</span></span><span style="display:flex;"><span>  root.add(<span style="color:#f92672">&amp;</span>treeNode3);
</span></span><span style="display:flex;"><span>  treeNode3.add(<span style="color:#f92672">&amp;</span>treeNode4);
</span></span><span style="display:flex;"><span>  treeNode4.add(<span style="color:#f92672">&amp;</span>leaf2);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//å®¢æˆ·ç«¯ä¸è®ºæ˜¯å¤„ç†å¤æ‚èŠ‚ç‚¹è¿˜æ˜¯å¶å­èŠ‚ç‚¹ ä»£ç ä¿æŒä¸€ç›´ç¨³å®š ä¸ç”¨ç†ä¼šç»„ä»¶å¯¹è±¡å†…éƒ¨æ•°æ®ç»“æ„å®¹å™¨å®ç°çš„å˜åŒ–
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  Invoke(root);
</span></span><span style="display:flex;"><span>  Invoke(leaf2);
</span></span><span style="display:flex;"><span>  Invoke(treeNode3);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="è¦ç‚¹æ€»ç»“-16">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-16">#</a></h2>
<ul>
<li>Compositeæ¨¡å¼é‡‡ç”¨æ ‘å½¢ç»“æ„å®ç°éƒ¨ç‰‡å­˜åœ¨çš„å¯¹è±¡å®¹å™¨ï¼Œä»è€Œå°†<strong>ä¸€å¯¹å¤š</strong> å˜ä¸ºâ€œ<strong>ä¸€å¯¹ä¸€</strong>â€ï¼Œå…¶å®ä¹Ÿå°±æ˜¯åŸå…ˆå¯¹å¤šä¸ªå¯¹è±¡ï¼Œç°åœ¨å˜ä¸ºå¯¹ä¸€ä¸ªåŸºç±»ï¼Œè®©åŸå…ˆçš„å¤šä¸ªå¯¹è±¡éƒ½ç»§æ‰¿åŒä¸€ä¸ªåŸºç±»((æ‹¥æœ‰åŒæ ·çš„å…¬å…±æ¥å£))ï¼Œè¿™æ ·å®¢æˆ·å°±ä¸ç”¨å…³å¿ƒæŸä¸ªå¤æ‚å¯¹è±¡å†…éƒ¨çš„æ•°æ®ç»“æ„å®ç°ï¼Œä¹Ÿä¸ä¼šå› ä¸ºå…¶æ•°æ®ç»“æ„çš„å˜åŠ¨è€Œå¯¼è‡´å®¢æˆ·ç«¯ä»£ç ä¿®æ”¹ã€‚</li>
<li>Compositeæ¨¡å¼åœ¨å…·ä½“å®ç°ä¸­ï¼Œå¯ä»¥è®©è´Ÿå¯¹è±¡ä¸­çš„å­å¯¹è±¡åå‘è¿½æº¯ï¼Œå¦‚æœè´Ÿå¯¹è±¡æœ‰é¢‘ç¹çš„éå†éœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ç¼“å­˜æ¥æ”¹å–„æ•ˆç‡</li>
</ul>
<h1 id="è¿­ä»£å™¨æ¨¡å¼iterator---æ•°æ®ç»“æ„">è¿­ä»£å™¨æ¨¡å¼Iterator&mdash;æ•°æ®ç»“æ„<a hidden class="anchor" aria-hidden="true" href="#è¿­ä»£å™¨æ¨¡å¼iterator---æ•°æ®ç»“æ„">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº-3">éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯å’ŒåŠ¨æœº-3">#</a></h2>
<ul>
<li>è½¯ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼Œé›†åˆå¯¹è±¡å†…éƒ¨ç»“æ„å¸¸å¸¸å˜åŒ–å„å¼‚ï¼Œä½†å¯¹äºè¿™äº›é›†åˆå¯¹è±¡ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æš´æ¼å…¶å†…éƒ¨æ•°æ®ç»“æ„ï¼Œè€Œä¸”å¸Œæœ›æä¾›ä¸€ä¸ªä¸€è‡´çš„æ¥å£è®©å®¢æˆ·è®¿é—®ï¼ŒåŒæ—¶å¦‚æœæä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œå°±æœ‰å¯èƒ½æä¾›ç»Ÿä¸€çš„ç®—æ³•</li>
<li>ä½¿ç”¨é¢å‘å¯¹è±¡æŠ€æœ¯(ä¹Ÿå°±æ˜¯å¤šæ€ æœ‰ä¸ªè¿­ä»£å™¨åŸºç±»ï¼Œå®šä¹‰ç»Ÿä¸€çš„å‡ ä¸ªæ¥å£ï¼Œè®©ä¸åŒçš„é›†åˆè¿­ä»£å™¨å¯¹è±¡éƒ½ç»§æ‰¿è¿™ä¸ªåŸºç±»ï¼Œå®ç°å…¶æ–¹æ³•å³å¯)</li>
</ul>
<h2 id="æ¨¡å¼å®šä¹‰-14">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-14">#</a></h2>
<ul>
<li>æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œä¸æš´æ¼(ç¨³å®š)è¯¥å¯¹è±¡å†…éƒ¨çš„è¡¨ç¤º(å®ç°ç»†èŠ‚ æ¯”å¦‚æŸäº›æ•°æ®ç»“æ„)</li>
</ul>
<h2 id="ç»“æ„å›¾è§£-13">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-13">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Iterator%e8%bf%ad%e4%bb%a3%e5%99%a8%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="ä»£ç -6">ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ä»£ç -6">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//è¿­ä»£å™¨åŸºç±» å®šä¹‰å…¬å…±æ“ä½œæ¥å£ å¯¹å®¢æˆ·æš´æ¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Iterator</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> first() <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">next</span>() <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">isDone</span>() <span style="color:#66d9ef">const</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> T<span style="color:#f92672">&amp;</span> current() <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç”ŸæˆæŸä¸€ä¸ªç±»å‹çš„è¿­ä»£å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyCollection</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Iterator<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> GetIterator(){
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å…·ä½“çš„è¿­ä»£å…¶å­ç±»å®ç° ç»§æ‰¿è¿­ä»£å™¨åŸºç±» å®ç°å…¬å…±æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CollectionIterator</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Iterator<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span>{
</span></span><span style="display:flex;"><span>  MyCollection<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> mc;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  CollectionIterator(<span style="color:#66d9ef">const</span> MyCollection<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span> c)<span style="color:#f92672">:</span> mc(c){ }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">first</span>() <span style="color:#66d9ef">override</span> {
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">next</span>() <span style="color:#66d9ef">override</span> {
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">isDone</span>() <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">override</span>{
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  T<span style="color:#f92672">&amp;</span> current() <span style="color:#66d9ef">override</span>{
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//è°ƒç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">MyAlgorithm</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  MyCollection<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> mc;<span style="color:#75715e">//æŸä¸€ä¸ªé›†åˆ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  Iterator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> iter<span style="color:#f92672">=</span> mc.GetIterator();<span style="color:#75715e">//é’ˆå¯¹æŸä¸€ä¸ªé›†åˆåˆ›å»ºè¿­ä»£å™¨å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">for</span> (iter.first(); <span style="color:#f92672">!</span>iter.isDone(); iter.next()){<span style="color:#75715e">//éå†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      cout <span style="color:#f92672">&lt;&lt;</span> iter.current() <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//è¿™é‡Œæ¯æ¬¡è°ƒç”¨éƒ½æ˜¯å¤šæ€ å°±è¦æ‰¾åˆ°è™šå‡½æ•°æŒ‡é’ˆ å¦‚æœé‡å¤ªå¤§ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//è¿™ä¸ªæ•ˆç‡å°±ä¼šæœ‰é—®é¢˜ æ‰€ä»¥c++ STLçš„è¿­ä»£å™¨éƒ½æ˜¯ç”¨æ¨¡ç‰ˆå®ç°äº† ä¹Ÿå°±æ˜¯ç¼–è¯‘æ—¶å¤šæ€ï¼Œè€Œä¸æ˜¯è¿è¡Œæ—¶å¤šæ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><h2 id="è¦ç‚¹æ€»ç»“-17">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-17">#</a></h2>
<ul>
<li>å› ä¸ºè™šå‡½æ•°åœ¨æ€§èƒ½ä¸Šçš„æ¶ˆè€—ï¼Œç°ä»£c++ STLåº“çš„è¿­ä»£å™¨éƒ½æ˜¯ç”¨æ¨¡ç‰ˆå®ç°çš„ï¼Œä¹Ÿå°±æ˜¯ç¼–è¯‘æ—¶å¤šæ€ï¼Œè€Œä¸æ˜¯è¿è¡Œæ—¶å¤šæ€ ä½†æ€æƒ³æ—¶ä¸€è‡´çš„</li>
<li>è¿­ä»£å¤šæ€ä¸ºéå†ä¸åŒçš„é›†åˆç»“æ„æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œä»è€Œæ”¯æŒåŒæ ·çš„ç®—æ³•åœ¨ä¸åŒå’Œé›†åˆç»“æ„ä¸Šæ“ä½œ</li>
<li>ä½¿ç”¨è¿­ä»£å™¨ä¸€å®šè¦è€ƒè™‘å¥å£®æ€§ï¼Œéå†çš„åŒæ—¶å¦‚æœæ›´æ”¹äº†æ‰€åœ¨çš„é›†åˆç»“æ„ï¼Œå¾ˆå¯èƒ½å‡ºé—®é¢˜ï¼Œå› ä¸ºå†…å­˜å·²ç»å‘ç”Ÿå˜åŒ–ï¼Œå¤§éƒ¨åˆ†è¿­ä»£å™¨æ˜¯åªè¯»çš„ã€‚</li>
</ul>
<h1 id="èŒè´£é“¾chainofresponsibility---æ•°æ®ç»“æ„">èŒè´£é“¾ChainOfResponsibility&mdash;æ•°æ®ç»“æ„<a hidden class="anchor" aria-hidden="true" href="#èŒè´£é“¾chainofresponsibility---æ•°æ®ç»“æ„">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯åŠ¨æœº-3">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯åŠ¨æœº-3">#</a></h2>
<ul>
<li>å¦‚æœä½ çš„é¡¹ç›®ä¸­ä¸€ä¸ªè¯·æ±‚å¯èƒ½ä¼šè¢«å¤šä¸ªå¯¹è±¡å¤„ç†ï¼Œä½†æ˜¯æ¯ä¸ªè¯·æ±‚åœ¨è¿è¡Œæ—¶åªèƒ½æœ‰ä¸€ä¸ªæ¥æ”¶è€…ï¼Œå¦‚æœæ˜¾ç¤ºæŒ‡å®šï¼Œå°†å¿…ä¸å¯å°‘çš„å¸¦æ¥æƒ…è¶£å‘é€è€…ä¸æ¥å—è€…çš„ç´§è€¦åˆ</li>
<li>å¦‚ä½•è®©è¯·æ±‚çš„å‘é€è€…ä¸éœ€è¦æŒ‡å®šå…·ä½“çš„æ¥å—è€…ï¼Ÿ</li>
</ul>
<h2 id="æ¨¡å¼å®šä¹‰-15">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-15">#</a></h2>
<ul>
<li>å®šä¹‰ä¸€ä¸ªè¯·æ±‚å¤„ç†åŸºç±»ï¼Œå®šä¹‰å…¬å…±å¤„ç†æ¥å£ï¼ŒåŒæ—¶æœ‰ä¸€ä¸ªåŸºç±»æŒ‡é’ˆnext è¿è¡Œæ—¶å¯ä»¥æŒ‡å‘å…·ä½“çš„è¯·æ±‚å¤„ç†å­ç±»ï¼Œè¿™æ ·å°±å¯ä»¥å½¢æˆä¸€ä¸ªé“¾æ¡ï¼Œç¬¬ä¸€ä¸ªä¸å¤„ç†æ‰”ç»™ä¸‹ä¸€ä¸ªï¼Œå¯¹æ¯ä¸ªå…·ä½“çš„å¤„ç†å­ç±»éƒ½æœ‰è¿™æ ·çš„å¤„ç†é€»è¾‘ï¼Œè¿™æ ·åšå°±è¾¾åˆ°äº†ä¸å¿…æŒ‡å®šå…·ä½“çš„å¤„ç†è€…ã€‚</li>
<li>æ²¿ç€å¯¹è±¡çš„ä¸€æ¡é“¾ ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ï¼Œå°±æƒ³æ•°æ®ç»“æ„çš„é“¾è¡¨ä¸€æ ·ã€‚</li>
</ul>
<h2 id="ç»“æ„å›¾è§£-14">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-14">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_ChainOfResponsibility%e8%81%8c%e8%b4%a3%e9%93%be%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="ä»£ç -7">ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ä»£ç -7">#</a></h2>
<p>ChainOfResponsibilityèŒè´£é“¾æ¨¡å¼ c++</summary></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#75715e">//è¯·æ±‚æšä¸¾ç±»å‹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">enum</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RequestType</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  REQ_HANDLER1,
</span></span><span style="display:flex;"><span>  REQ_HANDLER2,
</span></span><span style="display:flex;"><span>  REQ_HANDLER3
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//è¯·æ±‚å¯¹è±¡å®šä¹‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Reqest</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  string description;
</span></span><span style="display:flex;"><span>  RequestType reqType;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Reqest(<span style="color:#66d9ef">const</span> string <span style="color:#f92672">&amp;</span> desc, RequestType type) <span style="color:#f92672">:</span> description(desc), reqType(type) {}
</span></span><span style="display:flex;"><span>  RequestType <span style="color:#a6e22e">getReqType</span>() <span style="color:#66d9ef">const</span> { <span style="color:#66d9ef">return</span> reqType; }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> string<span style="color:#f92672">&amp;</span> getDescription() <span style="color:#66d9ef">const</span> { <span style="color:#66d9ef">return</span> description; }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//èŒè´£é“¾åŸºç±» å®šä¹‰æ¥å£ æœ‰ä¸ªæŒ‡å‘è‡ªå·±çš„æŒ‡é’ˆ(è¿è¡Œæ—¶çµæ´»æŒ‡æ´¾ä¸‹ä¸€ä¸ªå¤„ç†è´£ä»»ä¸»ä½“)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ChainHandler</span>{
</span></span><span style="display:flex;"><span>  ChainHandler <span style="color:#f92672">*</span>nextChain;
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//å°†è¯·æ±‚å‘é€ä¸ªé“¾æ¡ä¸Šä¸‹ä¸€ä¸ªå¤„ç†è´£ä»»ä¸»ä½“
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sendReqestToNextHandler</span>(<span style="color:#66d9ef">const</span> Reqest <span style="color:#f92672">&amp;</span> req)
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (nextChain <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>)
</span></span><span style="display:flex;"><span>          nextChain<span style="color:#f92672">-&gt;</span>handle(req);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">bool</span> canHandleRequest(<span style="color:#66d9ef">const</span> Reqest <span style="color:#f92672">&amp;</span> req) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">processRequest</span>(<span style="color:#66d9ef">const</span> Reqest <span style="color:#f92672">&amp;</span> req) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  ChainHandler() { nextChain <span style="color:#f92672">=</span> <span style="color:#66d9ef">nullptr</span>; }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setNextChain</span>(ChainHandler <span style="color:#f92672">*</span>next) { nextChain <span style="color:#f92672">=</span> next; }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//å…¬å…±å¤„ç†æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">handle</span>(<span style="color:#66d9ef">const</span> Reqest <span style="color:#f92672">&amp;</span> req)
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (canHandleRequest(req))<span style="color:#75715e">//å¦‚æœè‡ªå·±èƒ½å¤„ç† åˆ™ç›´æ¥å¤„ç†è¯·æ±‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          processRequest(req);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>          sendReqestToNextHandler(req);<span style="color:#75715e">//å¦åˆ™ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå¤„ç†è´£ä»»ä¸»ä½“
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å®é™…å¤„ç†ä¸»ä½“1 ç»§æ‰¿èŒè´£é“¾å¤„ç†åŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Handler1</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ChainHandler{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">bool</span> canHandleRequest(<span style="color:#66d9ef">const</span> Reqest <span style="color:#f92672">&amp;</span> req) <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> req.getReqType() <span style="color:#f92672">==</span> RequestType<span style="color:#f92672">::</span>REQ_HANDLER1;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">processRequest</span>(<span style="color:#66d9ef">const</span> Reqest <span style="color:#f92672">&amp;</span> req) <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Handler1 is handle reqest: &#34;</span> <span style="color:#f92672">&lt;&lt;</span> req.getDescription() <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å®é™…å¤„ç†ä¸»ä½“2 ç»§æ‰¿èŒè´£é“¾å¤„ç†åŸºç±»        
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Handler2</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ChainHandler{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">bool</span> canHandleRequest(<span style="color:#66d9ef">const</span> Reqest <span style="color:#f92672">&amp;</span> req) <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> req.getReqType() <span style="color:#f92672">==</span> RequestType<span style="color:#f92672">::</span>REQ_HANDLER2;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">processRequest</span>(<span style="color:#66d9ef">const</span> Reqest <span style="color:#f92672">&amp;</span> req) <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Handler2 is handle reqest: &#34;</span> <span style="color:#f92672">&lt;&lt;</span> req.getDescription() <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å®é™…å¤„ç†ä¸»ä½“3 ç»§æ‰¿èŒè´£é“¾å¤„ç†åŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Handler3</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ChainHandler{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">bool</span> canHandleRequest(<span style="color:#66d9ef">const</span> Reqest <span style="color:#f92672">&amp;</span> req) <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> req.getReqType() <span style="color:#f92672">==</span> RequestType<span style="color:#f92672">::</span>REQ_HANDLER3;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">processRequest</span>(<span style="color:#66d9ef">const</span> Reqest <span style="color:#f92672">&amp;</span> req) <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Handler3 is handle reqest: &#34;</span> <span style="color:#f92672">&lt;&lt;</span> req.getDescription() <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//è°ƒç”¨ç¤ºæ„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>  Handler1 h1;
</span></span><span style="display:flex;"><span>  Handler2 h2;
</span></span><span style="display:flex;"><span>  Handler3 h3;
</span></span><span style="display:flex;"><span>  h1.setNextChain(<span style="color:#f92672">&amp;</span>h2);
</span></span><span style="display:flex;"><span>  h2.setNextChain(<span style="color:#f92672">&amp;</span>h3);
</span></span><span style="display:flex;"><span>  Reqest req(<span style="color:#e6db74">&#34;process task ... &#34;</span>, RequestType<span style="color:#f92672">::</span>REQ_HANDLER3);<span style="color:#75715e">//è¿™é‡Œçœ‹ç€ç®€å• è¿è¡Œç€è¿™ä¸ªå¯¹è±¡å¯èƒ½è¡¨å¤æ‚ æˆ–è€…æ¯”è¾ƒå¤šï¼Œéƒ½ç›´æ¥æ˜¾ç¤ºæŒ‡å®šè€¦åˆå¤ªå¤š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  h1.handle(req);<span style="color:#75715e">//è°ƒç”¨çš„æ—¶å€™ä¸ç”¨æŒ‡å®šå…·ä½“çš„è´£ä»»ä¸»ä½“
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="è¦ç‚¹æ€»ç»“-18">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-18">#</a></h2>
<ul>
<li>èŒè´£é“¾æ¨¡å¼çš„åº”ç”¨ï¼Œè®©å¯¹è±¡èŒè´£åˆ†æ´¾æ›´å…·æœ‰çµæ´»æ€§</li>
<li>å¦‚æœæœ€åä¸€ä¸ªè¯·æ±‚å¤„ç†ä¸»ä½“ä¹Ÿä¸èƒ½å¤„ç†ï¼Œåº”è¯¥æœ‰ä¸€ä¸ªå‘Šè­¦æˆ–è€…ç¼ºçœçš„å¤„ç†æœºåˆ¶ã€‚è¿™ä¹Ÿæ˜¯æ¯ä¸€ä¸ªæ¥å—è¯·æ±‚å¯¹è±¡çš„è´£ä»»ï¼Œè€Œä¸æ˜¯å‘é€è¯·æ±‚å¯¹è±¡çš„è´£ä»»</li>
<li>å½“ç„¶è´£ä»»é“¾æ¨¡å¼å¾ˆå®¹æ˜“ç›´æ¥ç”¨æ•°æ®ç»“æ„å®ç°äº†ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯è¿™ä¸ªæ¨¡å¼ä¸æ€ä¹ˆæµè¡Œçš„åŸå›  æ¯”è¾ƒç®€ç­” ä½†æ€æƒ³å¯ä»¥å€Ÿé‰´</li>
</ul>
<h1 id="å‘½ä»¤æ¨¡å¼command---è¡Œä¸ºå˜åŒ–">å‘½ä»¤æ¨¡å¼Command&mdash;è¡Œä¸ºå˜åŒ–<a hidden class="anchor" aria-hidden="true" href="#å‘½ä»¤æ¨¡å¼command---è¡Œä¸ºå˜åŒ–">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯åŠ¨æœº-4">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯åŠ¨æœº-4">#</a></h2>
<ul>
<li>è½¯ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼Œâ€œè¡Œä¸ºè¯·æ±‚è€…â€å’Œâ€œè¡Œä¸ºå®ç°è€…â€é€šå¸¸å‘ˆç°ä¸€ç§ç´§è€¦åˆ(å¯¹è±¡å’Œæˆå‘˜å‡½æ•°)ï¼Œä½†åœ¨æŸäº›åœºåˆï¼Œæ¯”å¦‚è¦å¯¹è¡Œä¸ºè¿›è¡Œâ€œè®°å½•ã€æ’¤é”€ã€é‡åš(undo/redo)ã€äº‹åŠ¡â€ç­‰å¤„ç†ï¼Œè¿™ç§ç´§è€¦åˆæ— æ³•æŠµå¾¡å˜åŒ–ã€‚</li>
<li>æ€ä¹ˆæ ·æ‰èƒ½å°†â€œè¡Œä¸ºè¯·æ±‚è€…â€ä¸â€œè¡Œä¸ºå®ç°è€…â€è§£è€¦ï¼Ÿ</li>
</ul>
<h2 id="æ¨¡å¼å®šä¹‰-16">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-16">#</a></h2>
<ul>
<li>å°†ä¸€ä¸ªè¯·æ±‚(è¡Œä¸ºã€æˆ–è€…ç›´æ¥è¯´æˆå‘˜å‡½æ•°)å°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿ä½ å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼Œè¯·è¯·æ±‚æ’é˜Ÿæˆ–è€…è®°å½•æ—¥å¿—ã€æ’¤é”€ç­‰ç­‰ã€‚</li>
</ul>
<h2 id="ç»“æ„å›¾è§£-15">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-15">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Command%e5%91%bd%e4%bb%a4%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="ä»£ç -8">ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ä»£ç -8">#</a></h2>
<p>Commandå‘½ä»¤æ¨¡å¼c++</summary></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;vector&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å‘½ä»¤åŸºç±»å®šä¹‰æ¥å£æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Command</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> execute() <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å‘½ä»¤1å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ConcreteCommand1</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Command
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  string arg;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  ConcreteCommand1(<span style="color:#66d9ef">const</span> string <span style="color:#f92672">&amp;</span> a) <span style="color:#f92672">:</span> arg(a) {}
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">execute</span>() <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      cout<span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;#1 process...&#34;</span><span style="color:#f92672">&lt;&lt;</span>arg<span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å‘½ä»¤2å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ConcreteCommand2</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Command
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  string arg;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  ConcreteCommand2(<span style="color:#66d9ef">const</span> string <span style="color:#f92672">&amp;</span> a) <span style="color:#f92672">:</span> arg(a) {}
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">execute</span>() <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      cout<span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;#2 process...&#34;</span><span style="color:#f92672">&lt;&lt;</span>arg<span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç»„åˆå‘½ä»¤å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MacroCommand</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Command
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  vector<span style="color:#f92672">&lt;</span>Command<span style="color:#f92672">*&gt;</span> commands;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> addCommand(Command <span style="color:#f92672">*</span>c) { commands.push_back(c); }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">execute</span>() <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> <span style="color:#f92672">&amp;</span>c : commands)
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>          c<span style="color:#f92672">-&gt;</span>execute();
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//æ‰§è¡ŒæŸäº›å‘½ä»¤æ“ä½œå°±å˜æˆäº† æ„é€ æŸäº›å¯¹è±¡ ç„¶åæ‰§è¡Œå…¶ç›¸åº”æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  ConcreteCommand1 command1(receiver, <span style="color:#e6db74">&#34;Arg ###&#34;</span>);
</span></span><span style="display:flex;"><span>  ConcreteCommand2 command2(receiver, <span style="color:#e6db74">&#34;Arg $$$&#34;</span>);
</span></span><span style="display:flex;"><span>  MacroCommand macro;
</span></span><span style="display:flex;"><span>  macro.addCommand(<span style="color:#f92672">&amp;</span>command1);
</span></span><span style="display:flex;"><span>  macro.addCommand(<span style="color:#f92672">&amp;</span>command2);
</span></span><span style="display:flex;"><span>  macro.execute();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="è¦ç‚¹æ€»ç»“-19">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-19">#</a></h2>
<ul>
<li>Commandæ¨¡å¼ç›®çš„æ˜¯å°†â€œè¡Œä¸ºè¯·æ±‚è€…â€å’Œâ€è¡Œä¸ºå®ç°è€…â€œè§£è€¦ï¼Œåœ¨é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œå¸¸è§çš„æ‰‹æ®µæ˜¯&quot;&ldquo;å°†è¡Œä¸ºæŠ½è±¡ä¸ºå¯¹è±¡&rdquo;</li>
<li>è¿™ä¸ªæ¨¡å¼è·Ÿc++çš„å‡½æ•°å¯¹è±¡åˆäº›ç±»ä¼¼ï¼Œç›¸æ¯”Commandæ¨¡å¼æ¥å£æ›´è§„èŒƒï¼Œä½†å‡½æ•°å¯¹è±¡ä½¿ç”¨æ›´åŠ çµæ´»ï¼Œç°ä»£å·¥ç¨‹å‡½æ•°å¯¹è±¡ç”¨çš„æ›´å¤š</li>
<li>æ‰€è°“å‡½æ•°å¯¹è±¡å°±æ˜¯ä¸€ä¸ªclasså¯¹è±¡é‡è½½äº†()è¿ç®—ç¬¦ï¼Œæ‰€ä»¥å¯¹è±¡åç§°åŠ ä¸Š()å°±ç›¸å½“äºè°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°</li>
</ul>
<h1 id="è®¿é—®å™¨æ¨¡å¼visitor----è¡Œä¸ºå˜åŒ–">è®¿é—®å™¨æ¨¡å¼Visitor&mdash;-è¡Œä¸ºå˜åŒ–<a hidden class="anchor" aria-hidden="true" href="#è®¿é—®å™¨æ¨¡å¼visitor----è¡Œä¸ºå˜åŒ–">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯åŠ¨æœº-5">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯åŠ¨æœº-5">#</a></h2>
<ul>
<li>ç”±äºéœ€æ±‚çš„æ”¹å˜ã€æŸäº›ç±»å±‚æ¬¡ç»“æ„å¸¸å¸¸éœ€è¦å¢åŠ æ–°çš„è¡Œæ–‡(å¯¹è±¡æˆå‘˜æ–¹æ³•)ï¼Œå¦‚æœè€ƒè™‘åŸºç±»å­ç±»çš„å®ç°æ–¹å¼ï¼Œéœ€è¦åœ¨åŸºç±»ã€å­ç±»éƒ½æ·»åŠ å¯¹åº”çš„æ–¹æ³•ï¼Œå¦‚æœç›´æ¥åœ¨åŸºç±»ä¿®æ”¹ï¼Œå°†ä¼šç»™å­ç±»å¸¦æ¥ç¹é‡çš„è´Ÿæ‹…ï¼Œç”šè‡³ç ´ååŸè®¾è®¡</li>
<li>å¦‚ä½•åœ¨ä¸æ”¹å˜ç±»å±‚æ¬¡ç»“æ„çš„å‰æä¸‹ï¼Œåœ¨è¿è¡Œæ—¶é€æ˜åœ°ä¸ºç±»å±‚æ¬¡ç»“æ„çš„å„ä¸ªç±»åŠ¨æ€çš„æ·»åŠ æ–°çš„è¡Œä¸ºæ“ä½œï¼Ÿ</li>
</ul>
<h2 id="æ¨¡å¼å®šä¹‰-17">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-17">#</a></h2>
<ul>
<li>è¡¨ç¤ºä¸€ä¸ªä½œç”¨äºæŸä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œï¼Œä½¿å¾—å¯ä»¥åœ¨ä¸æ”¹å˜(ç¨³å®š)ä¸ªå…ƒç´ çš„ç±»çš„å‰æä¸‹å®šä¹‰(æ‰©å±•)ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œ(è¡Œä¸º)</li>
<li>é‡‡ç”¨äºŒæ¬¡åˆ†å‘çš„æ–¹å¼å®ç° ä½†å‰ææ˜¯åŸºç±»çš„å­ç±»éå¸¸ç¡®å®š ä¸ä¼šç»å¸¸å˜åŒ–ï¼Œæ˜¯å­ç±»çš„è¡Œä¸ºç»å¸¸å˜åŒ–ã€‚</li>
</ul>
<h2 id="ç»“æ„å›¾è§£-16">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-16">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Visitor%e8%ae%bf%e9%97%ae%e5%99%a8%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="ä»£ç -9">ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ä»£ç -9">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ä¸šåŠ¡åŸºç±» åˆšå¼€å§‹æœ‰2ä¸ªæ–¹æ³• 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Element</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> Func1() <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Func2</span>(<span style="color:#66d9ef">int</span> data)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Func3</span>(<span style="color:#66d9ef">int</span> data)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#75715e">//éšç€é¡¹ç›®å‘å±• è¦ä¸åœçš„å¢åŠ æ–¹æ³• é‚£ä¹ˆå°±éœ€è¦ä¿®æ”¹åŸºç±»ç„¶åä¿®æ”¹æ¯ä¸€ä¸ªå­ç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Element(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ElementA</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Element
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> Func1() <span style="color:#66d9ef">override</span>{
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Func2</span>(<span style="color:#66d9ef">int</span> data) <span style="color:#66d9ef">override</span>{
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//è¿™é‡Œæ·»åŠ Func3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ElementB</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Element
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> Func1() <span style="color:#66d9ef">override</span>{
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//***
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Func2</span>(<span style="color:#66d9ef">int</span> data) <span style="color:#66d9ef">override</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//***
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//è¿™é‡Œæ·»åŠ Func3 Func4....
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span></code></pre></div><p>Visitorè®¿é—®å™¨æ¨¡å¼</summary></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å…ˆå£°æ˜
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Visitor</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ä¸šåŠ¡åŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Element</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> accept(Visitor<span style="color:#f92672">&amp;</span> visitor) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#75715e">//ç¬¬ä¸€æ¬¡å¤šæ€è¾¨æ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Element(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ä¸šåŠ¡å­ç±»A
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ElementA</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Element
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> accept(Visitor <span style="color:#f92672">&amp;</span>visitor) <span style="color:#66d9ef">override</span> {
</span></span><span style="display:flex;"><span>      visitor.visitElementA(<span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ä¸šåŠ¡å­ç±»B
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ElementB</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Element
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> accept(Visitor <span style="color:#f92672">&amp;</span>visitor) <span style="color:#66d9ef">override</span> {
</span></span><span style="display:flex;"><span>      visitor.visitElementB(<span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>); <span style="color:#75715e">//ç¬¬äºŒæ¬¡å¤šæ€è¾¨æ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//è®¿é—®å™¨åŸºç±» å®šä¹‰å¥½è®¿é—®æ¯ä¸ªå­ä¸šåŠ¡ç±»çš„æ¥å£ åé¢æœ‰å„ä¸ªè®¿é—®å™¨å®ç°(ä¸ºæ¯ä¸ªå­ç±»å¢åŠ æˆå‘˜æ–¹æ³•)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Visitor</span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> visitElementA(ElementA<span style="color:#f92672">&amp;</span> element) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visitElementB</span>(ElementB<span style="color:#f92672">&amp;</span> element) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Visitor(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//==========================ä¸Šè¿°å¦‚æœåªæœ‰2ä¸ªå­ç±» éšä¾¿æ·»åŠ æ–¹æ³• ä»¥ä¸Šç¨³å®š==============================
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//æ‰©å±•1 ä¸ºå­ç±»å¢åŠ ä¸€ä¸ªæˆå‘˜æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Visitor1</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Visitor{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> visitElementA(ElementA<span style="color:#f92672">&amp;</span> element) <span style="color:#66d9ef">override</span>{
</span></span><span style="display:flex;"><span>      cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Visitor1 is processing ElementA&#34;</span> <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visitElementB</span>(ElementB<span style="color:#f92672">&amp;</span> element) <span style="color:#66d9ef">override</span>{
</span></span><span style="display:flex;"><span>      cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Visitor1 is processing ElementB&#34;</span> <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ‰©å±•2 ä¸ºå­ç±»å¢åŠ å†ä¸€ä¸ªæˆå‘˜æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Visitor2</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Visitor{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> visitElementA(ElementA<span style="color:#f92672">&amp;</span> element) <span style="color:#66d9ef">override</span>{
</span></span><span style="display:flex;"><span>      cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Visitor2 is processing ElementA&#34;</span> <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visitElementB</span>(ElementB<span style="color:#f92672">&amp;</span> element) <span style="color:#66d9ef">override</span>{
</span></span><span style="display:flex;"><span>      cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Visitor2 is processing ElementB&#34;</span> <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//æ‰©å±•3 ä¸ºå­ç±»å¢åŠ å†ä¸€ä¸ªæˆå‘˜æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Visitor3</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Visitor{};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  Visitor2 visitor;
</span></span><span style="display:flex;"><span>  ElementB elementB;
</span></span><span style="display:flex;"><span>  elementB.accept(visitor);<span style="color:#75715e">// double dispatch  ç›®çš„å®ç°è°ƒç”¨elementBå¯¹åº”Visitor2å®šä¹‰çš„æˆå‘˜æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  ElementA elementA;
</span></span><span style="display:flex;"><span>  elementA.accept(visitor);<span style="color:#75715e">// double dispatch  ç›®çš„å®ç°è°ƒç”¨elementAå¯¹åº”Visitor2å®šä¹‰çš„æˆå‘˜æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="è¦ç‚¹æ€»ç»“-20">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-20">#</a></h2>
<ul>
<li>é€šè¿‡åŒé‡åˆ†å‘æœºåˆ¶(double dispatch)æ¥å®ç°åœ¨ä¸æ›´æ–°ä¸šåŠ¡ç±»(Element)ç±»å±‚æ¬¡ç»“æ„çš„å‰æä¸‹ï¼Œè¿è¡Œæ—¶é€æ˜çš„ä¸ºå„ä¸ªä¸šåŠ¡ç±»å¢åŠ æ–¹æ³•</li>
<li>æœ€å¤§ç¼ºç‚¹ ä¸šåŠ¡ç±»çš„å­ç±»æ•°é‡è¦ç¡®å®š è¿™å°±å¯¼è‡´åœ¨ç°å®ä¸–ç•Œå¾ˆéš¾ç”¨åˆ°</li>
<li>åªèƒ½ç”¨äºå“ªäº›å­ç±»ä¸ªæ•°ä¸é¢‘ç¹å˜åŒ–ï¼Œä½†æ˜¯æ¯ä¸ªå­ç±»è¡Œä¸ºé¢‘ç¹å˜åŒ–çš„æƒ…å†µ</li>
</ul>
<h1 id="è§£æå™¨æ¨¡å¼interpreter---é¢†åŸŸè§„åˆ™">è§£æå™¨æ¨¡å¼Interpreter&mdash;é¢†åŸŸè§„åˆ™<a hidden class="anchor" aria-hidden="true" href="#è§£æå™¨æ¨¡å¼interpreter---é¢†åŸŸè§„åˆ™">#</a></h1>
<h2 id="éœ€æ±‚èƒŒæ™¯åŠ¨æœº-6">éœ€æ±‚èƒŒæ™¯ã€åŠ¨æœº<a hidden class="anchor" aria-hidden="true" href="#éœ€æ±‚èƒŒæ™¯åŠ¨æœº-6">#</a></h2>
<ul>
<li>å¦‚æœåœ¨æŸä¸€ç‰¹å®šé¢†åŸŸçš„é—®é¢˜æ¯”è¾ƒå¤æ‚ï¼Œç±»ä¼¼çš„ç»“æ„åˆä¸æ–­é‡å¤å‡ºç°ï¼Œå¦‚æœä½¿ç”¨æ™®éçš„å˜æˆæ–¹å¼å®ç°å°†é¢ä¸´éå¸¸é¢‘ç¹çš„å˜åŒ–</li>
<li>å¦‚æœèƒ½å¤Ÿå°†è¿™ä¸ªç‰¹å®šé¢†åŸŸçš„é—®é¢˜è¡¨è¾¾ä¸ºæŸç§è¯­æ³•è§„åˆ™ï¼Œç„¶åæ„å»ºä¸€ä¸ªè§£æå™¨è§£é‡Šè¿™æ ·çš„æƒ…å†µï¼Œä»è€Œè§£å†³é—®é¢˜</li>
<li>æ¯”å¦‚è¦å®ç°ä¸€ä¸ªåŠ å‡æ³•çš„è¡¨è¾¾å¼é—®é¢˜ a+b-c+d</li>
</ul>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Interpreter%e8%a7%a3%e6%9e%90%e5%99%a8%e6%a8%a1%e5%bc%8f%e4%be%8b%e5%ad%90.png" alt=""  />
</p>
<h2 id="æ¨¡å¼å®šä¹‰-18">æ¨¡å¼å®šä¹‰<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å¼å®šä¹‰-18">#</a></h2>
<ul>
<li>ç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œå®šä¹‰çš„æ–‡æ³•è¡¨ç¤ºï¼Œå¹¶å®ç°ä¸€ä¸ªè§£é‡Šå™¨æ¥è§£å†³</li>
</ul>
<h2 id="ç»“æ„å›¾è§£-17">ç»“æ„å›¾è§£<a hidden class="anchor" aria-hidden="true" href="#ç»“æ„å›¾è§£-17">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_Interpreter%e8%a7%a3%e6%9e%90%e5%99%a8%e6%a8%a1%e5%bc%8f%e7%b1%bb%e5%9b%be.png" alt=""  />
</p>
<h2 id="ä»£ç -10">ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ä»£ç -10">#</a></h2>
<p>Interpreterè§£æå™¨æ¨¡å¼c++</summary></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;map&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stack&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#75715e">//è¡¨è¾¾å¼åŸºç±» 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Expression</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//ä¸»è¦æ¥å£ è§£æè¡¨è¾¾å¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">int</span> interpreter(map<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>, <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> var)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Expression(){}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å˜é‡è¡¨è¾¾å¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">VarExpression</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Expression {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> key;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  VarExpression(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">&amp;</span> key)
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>key <span style="color:#f92672">=</span> key;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//å˜é‡è¡¨è¾¾å¼çš„è§£æå°±ç›´æ¥è¿”å›å…¶å†…å­˜å€¼å³å¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">interpreter</span>(map<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>, <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> var) <span style="color:#66d9ef">override</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> var[key];
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç¬¦å·è¡¨è¾¾å¼åŸºç±»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SymbolExpression</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Expression {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// è¿ç®—ç¬¦å·¦å³ä¸¤ä¸ªå‚æ•° æŠ½è±¡è¯­æ³•å°±æ˜¯æœ‰å·¦å³2ä¸ªè¡¨è¾¾å¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  Expression<span style="color:#f92672">*</span> left;
</span></span><span style="display:flex;"><span>  Expression<span style="color:#f92672">*</span> right;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  SymbolExpression( Expression<span style="color:#f92672">*</span> left,  Expression<span style="color:#f92672">*</span> right)<span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      left(left),right(right){
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//åŠ æ³•è¿ç®—è¡¨è¾¾å¼å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AddExpression</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> SymbolExpression {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  AddExpression(Expression<span style="color:#f92672">*</span> left, Expression<span style="color:#f92672">*</span> right)<span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      SymbolExpression(left,right){
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//è§£æè§„åˆ™å°±æ˜¯å·¦å³ä¸¤ä¸ªè¡¨è¾¾å¼çš„è§£æå€¼ç›¸åŠ  è¿™ä¸­é—´ä¼šæ¶‰åŠå¤šæ€é€’å½’è°ƒç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">interpreter</span>(map<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>, <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> var) <span style="color:#66d9ef">override</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> left<span style="color:#f92672">-&gt;</span>interpreter(var) <span style="color:#f92672">+</span> right<span style="color:#f92672">-&gt;</span>interpreter(var);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å‡æ³•è¿ç®—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SubExpression</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> SymbolExpression {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  SubExpression(Expression<span style="color:#f92672">*</span> left, Expression<span style="color:#f92672">*</span> right)<span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      SymbolExpression(left,right){ 
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//è§£æè§„åˆ™å°±æ˜¯å·¦å³ä¸¤ä¸ªè¡¨è¾¾å¼çš„è§£æå€¼ç›¸å‡ è¿™ä¸­é—´ä¼šæ¶‰åŠå¤šæ€é€’å½’è°ƒç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">interpreter</span>(map<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>, <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> var) <span style="color:#66d9ef">override</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> left<span style="color:#f92672">-&gt;</span>interpreter(var) <span style="color:#f92672">-</span> right<span style="color:#f92672">-&gt;</span>interpreter(var);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å®šä¹‰è§£æå™¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Expression<span style="color:#f92672">*</span>  <span style="color:#a6e22e">analyse</span>(string expStr) {
</span></span><span style="display:flex;"><span>  stack<span style="color:#f92672">&lt;</span>Expression<span style="color:#f92672">*&gt;</span> expStack;
</span></span><span style="display:flex;"><span>  Expression<span style="color:#f92672">*</span> left <span style="color:#f92672">=</span> <span style="color:#66d9ef">nullptr</span>;
</span></span><span style="display:flex;"><span>  Expression<span style="color:#f92672">*</span> right <span style="color:#f92672">=</span> <span style="color:#66d9ef">nullptr</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i<span style="color:#f92672">&lt;</span>expStr.size(); i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">switch</span>(expStr[i])
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;+&#39;</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>              <span style="color:#75715e">// åŠ æ³•è¿ç®—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>              left <span style="color:#f92672">=</span> expStack.top();
</span></span><span style="display:flex;"><span>              right <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> VarExpression(expStr[<span style="color:#f92672">++</span>i]);
</span></span><span style="display:flex;"><span>              expStack.push(<span style="color:#66d9ef">new</span> AddExpression(left, right));
</span></span><span style="display:flex;"><span>              <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;-&#39;</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>              <span style="color:#75715e">// å‡æ³•è¿ç®—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>              left <span style="color:#f92672">=</span> expStack.top();
</span></span><span style="display:flex;"><span>              right <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> VarExpression(expStr[<span style="color:#f92672">++</span>i]);
</span></span><span style="display:flex;"><span>              expStack.push(<span style="color:#66d9ef">new</span> SubExpression(left, right));
</span></span><span style="display:flex;"><span>              <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>              <span style="color:#75715e">// å˜é‡è¡¨è¾¾å¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>              expStack.push(<span style="color:#66d9ef">new</span> VarExpression(expStr[i]));
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  Expression<span style="color:#f92672">*</span> expression <span style="color:#f92672">=</span> expStack.top();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> expression;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">release</span>(Expression<span style="color:#f92672">*</span> expression){
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//é‡Šæ”¾è¡¨è¾¾å¼æ ‘çš„èŠ‚ç‚¹å†…å­˜...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> argv[]) {
</span></span><span style="display:flex;"><span>  string expStr <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;a+b-c+d-e&#34;</span>;
</span></span><span style="display:flex;"><span>  map<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>, <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> var;
</span></span><span style="display:flex;"><span>  var.insert(make_pair(<span style="color:#e6db74">&#39;a&#39;</span>,<span style="color:#ae81ff">5</span>));
</span></span><span style="display:flex;"><span>  var.insert(make_pair(<span style="color:#e6db74">&#39;b&#39;</span>,<span style="color:#ae81ff">2</span>));
</span></span><span style="display:flex;"><span>  var.insert(make_pair(<span style="color:#e6db74">&#39;c&#39;</span>,<span style="color:#ae81ff">1</span>));
</span></span><span style="display:flex;"><span>  var.insert(make_pair(<span style="color:#e6db74">&#39;d&#39;</span>,<span style="color:#ae81ff">6</span>));
</span></span><span style="display:flex;"><span>  var.insert(make_pair(<span style="color:#e6db74">&#39;e&#39;</span>,<span style="color:#ae81ff">10</span>));
</span></span><span style="display:flex;"><span>  Expression<span style="color:#f92672">*</span> expression<span style="color:#f92672">=</span> analyse(expStr);<span style="color:#75715e">//å°†å­—ç¬¦ä¸²è§£ææˆå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> result<span style="color:#f92672">=</span>expression<span style="color:#f92672">-&gt;</span>interpreter(var);<span style="color:#75715e">//å¤šæ€è°ƒç”¨è§£ææœ€ç»ˆå€¼ è§£å†³é—®é¢˜
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  cout<span style="color:#f92672">&lt;&lt;</span>result<span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>  release(expression);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="è¦ç‚¹æ€»ç»“-21">è¦ç‚¹æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#è¦ç‚¹æ€»ç»“-21">#</a></h2>
<ul>
<li>ç°å®é¡¹ç›®ä¸­ç”¨åˆ°çš„ä¸å¤š åªèƒ½è§£å†³è¯­æ³•ç›¸å¯¹ç®€å•çš„é—®é¢˜ å¦åˆ™å¤šæ€è™šå‡½æ•°è°ƒç”¨è¿‡å¤šä¼šäº§ç”Ÿå¾ˆå¤šæ€§èƒ½é—®é¢˜</li>
</ul>
<h1 id="23ç§è®¾è®¡æ¨¡å¼æ€»ç»“">23ç§è®¾è®¡æ¨¡å¼æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#23ç§è®¾è®¡æ¨¡å¼æ€»ç»“">#</a></h1>
<h2 id="ç›®æ ‡ä¸èƒ½å¿˜è®°-ç®¡ç†å˜åŒ–æé«˜å¤ç”¨">ç›®æ ‡ä¸èƒ½å¿˜è®° ç®¡ç†å˜åŒ–ï¼Œæé«˜å¤ç”¨<a hidden class="anchor" aria-hidden="true" href="#ç›®æ ‡ä¸èƒ½å¿˜è®°-ç®¡ç†å˜åŒ–æé«˜å¤ç”¨">#</a></h2>
<h2 id="ä¸¤è€…ä¸»è¦çš„æ‰‹æ®µ-åˆ†è§£å’ŒæŠ½è±¡">ä¸¤è€…ä¸»è¦çš„æ‰‹æ®µ åˆ†è§£å’ŒæŠ½è±¡<a hidden class="anchor" aria-hidden="true" href="#ä¸¤è€…ä¸»è¦çš„æ‰‹æ®µ-åˆ†è§£å’ŒæŠ½è±¡">#</a></h2>
<h2 id="æ·±åˆ»ç«‹åˆ»8å¤§åŸåˆ™å’Œé‡æ„çš„5ç§æŠ€å·§">æ·±åˆ»ç«‹åˆ»8å¤§åŸåˆ™å’Œé‡æ„çš„5ç§æŠ€å·§<a hidden class="anchor" aria-hidden="true" href="#æ·±åˆ»ç«‹åˆ»8å¤§åŸåˆ™å’Œé‡æ„çš„5ç§æŠ€å·§">#</a></h2>
<h2 id="è®¾è®¡æ¨¡å¼æœ€ç»ˆå¯èƒ½çš„å¯¹è±¡æ¨¡å‹">è®¾è®¡æ¨¡å¼æœ€ç»ˆå¯èƒ½çš„å¯¹è±¡æ¨¡å‹<a hidden class="anchor" aria-hidden="true" href="#è®¾è®¡æ¨¡å¼æœ€ç»ˆå¯èƒ½çš„å¯¹è±¡æ¨¡å‹">#</a></h2>
<p><img loading="lazy" src="http://becool.vip:666/img/DesignPatterns_%e5%85%b1%e7%94%a8%e5%af%b9%e8%b1%a1%e6%a8%a1%e5%9e%8b.png" alt=""  />
</p>
<h2 id="æ—¶åˆ»è¦æ³¨æ„å…³æ³¨å˜åŒ–ç‚¹å’Œç¨³å®šç‚¹">æ—¶åˆ»è¦æ³¨æ„å…³æ³¨å˜åŒ–ç‚¹å’Œç¨³å®šç‚¹<a hidden class="anchor" aria-hidden="true" href="#æ—¶åˆ»è¦æ³¨æ„å…³æ³¨å˜åŒ–ç‚¹å’Œç¨³å®šç‚¹">#</a></h2>
<h2 id="å“ªäº›åœºæ™¯ä¸å¤ªé€‚åˆç”¨æ¨¡å¼">å“ªäº›åœºæ™¯ä¸å¤ªé€‚åˆç”¨æ¨¡å¼<a hidden class="anchor" aria-hidden="true" href="#å“ªäº›åœºæ™¯ä¸å¤ªé€‚åˆç”¨æ¨¡å¼">#</a></h2>
<ul>
<li>ä»£ç å¯è¯»æ€§å¾ˆå·®çš„æ—¶å€™ ä¸å»ºè®®ç›´æ¥ä½¿ç”¨ è¦é¦–å…ˆä¿è¯ä»£ç æœ‰è‰¯å¥½çš„å¯è¯»æ€§ è¿™ä¸ªæ˜¯å‰ææ¡ä»¶</li>
<li>éœ€æ±‚ç†è§£çš„ä¸æ·±åˆ»æ—¶ æ­¤æ—¶ä¸èƒ½æ·±åˆ»ç†è§£å“ªäº›æ˜¯ç¨³å®šç‚¹å’Œå˜åŒ–ç‚¹</li>
<li>å˜åŒ–æ²¡æœ‰æ˜¾ç°çš„æ—¶å€™ ä¹Ÿæ˜¯æ— æ³•æ·±åˆ»ç†è§£å˜åŒ–ç‚¹çš„</li>
<li>æ ¹æœ¬å°±ä¸æ˜¯ç³»ç»Ÿçš„å…³é”®ä¾èµ–ç‚¹ å¯ä»¥ä¸ç”¨èŠ±å¤§çš„ç²¾åŠ›æ¥æŠ˜è…¾è®¾è®¡æ¨¡å¼</li>
<li>é¡¹ç›®æœ¬èº«æ²¡æœ‰ä»»ä½•å¤ç”¨ä»·å€¼ æ²¡æœ‰å¤ç”¨ä»·å€¼ä¹Ÿå°±ä¸ç”¨è€ƒè™‘è®¾è®¡æ¨¡å¼äº†</li>
<li>é¡¹ç›®å³å°†å‘å¸ƒçš„æ—¶å€™ å°±ä¸è¦åœ¨æŠ˜è…¾è®¾è®¡æ¨¡å¼äº† åˆ«å†æ•´å‡ºä¸€å¤§å †bug</li>
</ul>
<h2 id="ä¸€äº›ç»éªŒä¹‹è°ˆ">ä¸€äº›ç»éªŒä¹‹è°ˆ<a hidden class="anchor" aria-hidden="true" href="#ä¸€äº›ç»éªŒä¹‹è°ˆ">#</a></h2>
<ul>
<li>ä¸è¦ä¸ºäº†æ¨¡å¼è€Œæ¨¡å¼</li>
<li>è¦é‡è§†æŠ½è±¡ç±»å’Œæ¥å£</li>
<li>ç†æ¸…æ¥šå˜åŒ–ç‚¹å’Œç¨³å®šç‚¹éå¸¸é‡è¦</li>
<li>ç»å¸¸å®¡è§†ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»éå¸¸é‡è¦</li>
<li>Frameworkå’ŒApplicationçš„åŒºéš”æ€ç»´è¦æœ‰</li>
<li>è‰¯å¥½çš„è®¾è®¡éƒ½æ˜¯æ…¢æ…¢æ¼”åŒ–çš„ç»“æœ ä¸èƒ½ä¸€è¹´è€Œå°±</li>
</ul>
<h2 id="æˆé•¿ä¹‹è·¯">æˆé•¿ä¹‹è·¯<a hidden class="anchor" aria-hidden="true" href="#æˆé•¿ä¹‹è·¯">#</a></h2>
<ol>
<li>â€œæ‰‹ä¸­æ— å‰‘ï¼Œå¿ƒä¸­æ— å‰‘â€ï¼š è§åˆ°æ¨¡å¼ä¸è®¤è¯†</li>
<li>â€œæ‰‹ä¸­æœ‰å‰‘ï¼Œå¿ƒä¸­æ— å‰‘â€:    å¯ä»¥è¯†åˆ«ä¸åŒçš„æ¨¡å¼ ä½œä¸ºåº”ç”¨å¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨</li>
<li>&ldquo;æ‰‹ä¸­æœ‰å‰‘ï¼Œå¿ƒä¸­æœ‰å‰‘&rdquo;ï¼š å¯ä»¥ä½œä¸ºæ¡†æ¶å¼€å‘äººå‘˜åº”ç”¨è®¾è®¡æ¨¡å¼ è®©åˆ«äººç”¨ä½ å¼€å‘çš„äº§å“æ¡†æ¶</li>
<li>â€œæ‰‹ä¸­æ— å‰‘ï¼Œå¿ƒä¸­æœ‰å‰‘â€ï¼š å·²ç»å¿˜è®°äº†æ­»æ¿çš„è®¾è®¡æ¨¡å¼ï¼Œæ·±åˆ»ç†è§£åŸåˆ™ï¼Œç”šè‡³èƒ½å¤Ÿåˆ›é€ æ¨¡å¼</li>
</ol>


        </div>
        <div class="post-reward">
            <div style="padding: 0 0 0 0; margin: 0 0 0 0; width: 100%; font-size:16px; text-align: center;">
                <div id="QR" style="opacity: 0;">
                    <div id="wechat" style="display: inline-block">
                        <a class="fancybox" rel="group">
                            <img id="wechat_qr" src="http://heketong.github.io/img/wechatpayimg.JPG" alt="wechat_pay"></a>
                        <p>å¾®ä¿¡</p>
                    </div>
                    <div id="alipay" style="display: inline-block">
                        <a class="fancybox" rel="group">
                            <img id="alipay_qr" src="http://heketong.github.io/img/alipayimg.JPG" alt="alipay"></a>
                        <p>æ”¯ä»˜å®</p>
                    </div>
                </div>
                <button id="rewardButton"
                        onclick="
                    var qr = document.getElementById('QR');
                    if (qr.style.opacity === '0') {
                        qr.style.opacity='1';
                    } else {
                        qr.style.opacity='0'
                    }"
                >
                    <span>ğŸ§§ é¼“åŠ±</span>
                </button>
            </div>
        </div>

        <footer class="post-footer">
            
<nav class="paginav">
  <a class="prev" href="http://heketong.github.io/posts/tech/%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>å¸¸ç”¨æ•°æ®ç»“æ„</span>
  </a>
  <a class="next" href="http://heketong.github.io/posts/tech/%E9%AB%98%E5%B9%B6%E5%8F%91/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>ç½‘ç»œé«˜å¹¶å‘</span>
  </a>
</nav>

        </footer>
    </div>

<style>
    .comments_details summary::marker {
        font-size: 20px;
        content: 'ğŸ‘‰å±•å¼€è¯„è®º';
        color: var(--content);
    }
    .comments_details[open] summary::marker{
        font-size: 20px;
        content: 'ğŸ‘‡å…³é—­è¯„è®º';
        color: var(--content);
    }
</style>


<div>
    <details class="comments_details">
        <summary style="cursor: pointer; margin: 50px 0 20px 0;width: 130px;">
            <span style="font-size: 20px;color: var(--content);">...</span>
        </summary>
        <div id="tcomment"></div>
    </details>
    <script src="https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js">
    </script>
    <script>
        twikoo.init({
            envId:  null ,
        el: "#tcomment",
            lang: 'zh-CN',
            region:  null ,
        path: window.TWIKOO_MAGIC_PATH||window.location.pathname,
        })
    </script>
</div>
</article>
</main>

<footer class="footer">
    <span>
        Copyright
        &copy;
        2020-2024
        <a href="http://heketong.github.io/" style="color:#939393;">ç–¯å­çˆ±æ·¡å®š</a>
        All Rights Reserved
    </span>
    <a href="https://beian.miit.gov.cn/" target="_blank" style="color:#939393;">ç²¤ICPå¤‡2022127626å·-1</a>&nbsp;
    <span>
        <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=null"
           style="display:inline-block;text-decoration:none;height:20px;color:#939393;">
            <img src="" style="float:left;margin: 0px 5px 0px 0px;"/>
            
        </a>
    </span>
    <span id="busuanzi_container">
        <span class="fa fa-user"></span> <span id="busuanzi_value_site_uv"></span>
        <span class="fa fa-eye"></span> <span id="busuanzi_value_site_pv"></span>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <span class="topInner">
        <svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z"/>
        </svg>
        <span id="read_progress"></span>
    </span>
</a>

<script>
    document.addEventListener('scroll', function (e) {
        const readProgress = document.getElementById("read_progress");
        const scrollHeight = document.documentElement.scrollHeight;
        const clientHeight = document.documentElement.clientHeight;
        const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        readProgress.innerText = ((scrollTop / (scrollHeight - clientHeight)).toFixed(2) * 100).toFixed(0);
    })
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
</script>
<script>
    let mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        (function() {
            document.cookie = "change-themes" + "="+ escape ("false");
        })()

        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    });
</script>

<script>
    document.body.addEventListener('copy', function (e) {
        if (window.getSelection().toString() && window.getSelection().toString().length > 50) {
            let clipboardData = e.clipboardData || window.clipboardData;
            if (clipboardData) {
                e.preventDefault();
                let htmlData = window.getSelection().toString() +
                    '\r\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\n' +
                    'ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œ'+"ç–¯å­çˆ±æ·¡å®š"+'ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚' +
                '\r\nåŸæ–‡é“¾æ¥ï¼š' + location.href;
                let textData = window.getSelection().toString() +
                    '\r\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\n' +
                    'ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œ'+"ç–¯å­çˆ±æ·¡å®š"+'ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚' +
                '\r\nåŸæ–‡é“¾æ¥ï¼š' + location.href;
                clipboardData.setData('text/html', htmlData);
                clipboardData.setData('text/plain', textData);
            }
        }
    });
</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;
        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerText = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerText = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                let text = codeblock.textContent +
                    '\r\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\n' +
                    'ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œ'+"ç–¯å­çˆ±æ·¡å®š"+'ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚' +
                '\r\nåŸæ–‡é“¾æ¥ï¼š' + location.href;
                navigator.clipboard.writeText(text);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {}
            selection.removeRange(range);
        });

        let language = codeblock.className.replaceAll("language-", "")
        let macTool = document.createElement("div")
        let macTool1 = document.createElement("div")
        let macTool2 = document.createElement("div")
        let macTool3 = document.createElement("div")
        let languageType = document.createElement("div")
        languageType.innerText = language
        macTool.setAttribute('class', 'mac-tool')
        macTool1.setAttribute('class', 'mac bb1')
        macTool2.setAttribute('class', 'mac bb2')
        macTool3.setAttribute('class', 'mac bb3')
        languageType.setAttribute('class', 'language-type')
        macTool.appendChild(macTool1)
        macTool.appendChild(macTool2)
        macTool.appendChild(macTool3)
        macTool.appendChild(languageType)

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
            container.appendChild(macTool)
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        }
    });
</script>
</body>

</html>
